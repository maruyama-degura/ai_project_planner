(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function Xm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Db(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var Ih={exports:{}},oc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1;function Ib(){if(b1)return oc;b1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var c in a)c!=="key"&&(s[c]=a[c])}else s=a;return a=s.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:s}}return oc.Fragment=e,oc.jsx=n,oc.jsxs=n,oc}var A1;function Fb(){return A1||(A1=1,Ih.exports=Ib()),Ih.exports}var x=Fb(),Fh={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1;function Lb(){if(k1)return ot;k1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function _(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function C(M,Q,I){this.props=M,this.context=Q,this.refs=S,this.updater=I||T}C.prototype.isReactComponent={},C.prototype.setState=function(M,Q){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,Q,"setState")},C.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function k(){}k.prototype=C.prototype;function A(M,Q,I){this.props=M,this.context=Q,this.refs=S,this.updater=I||T}var b=A.prototype=new k;b.constructor=A,E(b,C.prototype),b.isPureReactComponent=!0;var D=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},G=Object.prototype.hasOwnProperty;function F(M,Q,I,X,K,P){return I=P.ref,{$$typeof:t,type:M,key:Q,ref:I!==void 0?I:null,props:P}}function W(M,Q){return F(M.type,Q,void 0,void 0,void 0,M.props)}function U(M){return typeof M=="object"&&M!==null&&M.$$typeof===t}function ae(M){var Q={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(I){return Q[I]})}var z=/\/+/g;function ee(M,Q){return typeof M=="object"&&M!==null&&M.key!=null?ae(""+M.key):Q.toString(36)}function Ee(){}function Ae(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(Ee,Ee):(M.status="pending",M.then(function(Q){M.status==="pending"&&(M.status="fulfilled",M.value=Q)},function(Q){M.status==="pending"&&(M.status="rejected",M.reason=Q)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function we(M,Q,I,X,K){var P=typeof M;(P==="undefined"||P==="boolean")&&(M=null);var te=!1;if(M===null)te=!0;else switch(P){case"bigint":case"string":case"number":te=!0;break;case"object":switch(M.$$typeof){case t:case e:te=!0;break;case g:return te=M._init,we(te(M._payload),Q,I,X,K)}}if(te)return K=K(M),te=X===""?"."+ee(M,0):X,D(K)?(I="",te!=null&&(I=te.replace(z,"$&/")+"/"),we(K,Q,I,"",function(ye){return ye})):K!=null&&(U(K)&&(K=W(K,I+(K.key==null||M&&M.key===K.key?"":(""+K.key).replace(z,"$&/")+"/")+te)),Q.push(K)),1;te=0;var me=X===""?".":X+":";if(D(M))for(var ve=0;ve<M.length;ve++)X=M[ve],P=me+ee(X,ve),te+=we(X,Q,I,P,K);else if(ve=_(M),typeof ve=="function")for(M=ve.call(M),ve=0;!(X=M.next()).done;)X=X.value,P=me+ee(X,ve++),te+=we(X,Q,I,P,K);else if(P==="object"){if(typeof M.then=="function")return we(Ae(M),Q,I,X,K);throw Q=String(M),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return te}function ie(M,Q,I){if(M==null)return M;var X=[],K=0;return we(M,X,"","",function(P){return Q.call(I,P,K++)}),X}function de(M){if(M._status===-1){var Q=M._result;Q=Q(),Q.then(function(I){(M._status===0||M._status===-1)&&(M._status=1,M._result=I)},function(I){(M._status===0||M._status===-1)&&(M._status=2,M._result=I)}),M._status===-1&&(M._status=0,M._result=Q)}if(M._status===1)return M._result.default;throw M._result}var re=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)};function J(){}return ot.Children={map:ie,forEach:function(M,Q,I){ie(M,function(){Q.apply(this,arguments)},I)},count:function(M){var Q=0;return ie(M,function(){Q++}),Q},toArray:function(M){return ie(M,function(Q){return Q})||[]},only:function(M){if(!U(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},ot.Component=C,ot.Fragment=n,ot.Profiler=a,ot.PureComponent=A,ot.StrictMode=r,ot.Suspense=d,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,ot.__COMPILER_RUNTIME={__proto__:null,c:function(M){return B.H.useMemoCache(M)}},ot.cache=function(M){return function(){return M.apply(null,arguments)}},ot.cloneElement=function(M,Q,I){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var X=E({},M.props),K=M.key,P=void 0;if(Q!=null)for(te in Q.ref!==void 0&&(P=void 0),Q.key!==void 0&&(K=""+Q.key),Q)!G.call(Q,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&Q.ref===void 0||(X[te]=Q[te]);var te=arguments.length-2;if(te===1)X.children=I;else if(1<te){for(var me=Array(te),ve=0;ve<te;ve++)me[ve]=arguments[ve+2];X.children=me}return F(M.type,K,void 0,void 0,P,X)},ot.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:s,_context:M},M},ot.createElement=function(M,Q,I){var X,K={},P=null;if(Q!=null)for(X in Q.key!==void 0&&(P=""+Q.key),Q)G.call(Q,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(K[X]=Q[X]);var te=arguments.length-2;if(te===1)K.children=I;else if(1<te){for(var me=Array(te),ve=0;ve<te;ve++)me[ve]=arguments[ve+2];K.children=me}if(M&&M.defaultProps)for(X in te=M.defaultProps,te)K[X]===void 0&&(K[X]=te[X]);return F(M,P,void 0,void 0,null,K)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(M){return{$$typeof:c,render:M}},ot.isValidElement=U,ot.lazy=function(M){return{$$typeof:g,_payload:{_status:-1,_result:M},_init:de}},ot.memo=function(M,Q){return{$$typeof:f,type:M,compare:Q===void 0?null:Q}},ot.startTransition=function(M){var Q=B.T,I={};B.T=I;try{var X=M(),K=B.S;K!==null&&K(I,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(J,re)}catch(P){re(P)}finally{B.T=Q}},ot.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},ot.use=function(M){return B.H.use(M)},ot.useActionState=function(M,Q,I){return B.H.useActionState(M,Q,I)},ot.useCallback=function(M,Q){return B.H.useCallback(M,Q)},ot.useContext=function(M){return B.H.useContext(M)},ot.useDebugValue=function(){},ot.useDeferredValue=function(M,Q){return B.H.useDeferredValue(M,Q)},ot.useEffect=function(M,Q,I){var X=B.H;if(typeof I=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(M,Q)},ot.useId=function(){return B.H.useId()},ot.useImperativeHandle=function(M,Q,I){return B.H.useImperativeHandle(M,Q,I)},ot.useInsertionEffect=function(M,Q){return B.H.useInsertionEffect(M,Q)},ot.useLayoutEffect=function(M,Q){return B.H.useLayoutEffect(M,Q)},ot.useMemo=function(M,Q){return B.H.useMemo(M,Q)},ot.useOptimistic=function(M,Q){return B.H.useOptimistic(M,Q)},ot.useReducer=function(M,Q,I){return B.H.useReducer(M,Q,I)},ot.useRef=function(M){return B.H.useRef(M)},ot.useState=function(M){return B.H.useState(M)},ot.useSyncExternalStore=function(M,Q,I){return B.H.useSyncExternalStore(M,Q,I)},ot.useTransition=function(){return B.H.useTransition()},ot.version="19.1.0",ot}var N1;function Zm(){return N1||(N1=1,Fh.exports=Lb()),Fh.exports}var H=Zm();const ys=Xm(H);var Lh={exports:{}},lc={},Ph={exports:{}},Oh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1;function Pb(){return R1||(R1=1,function(t){function e(ie,de){var re=ie.length;ie.push(de);e:for(;0<re;){var J=re-1>>>1,M=ie[J];if(0<a(M,de))ie[J]=de,ie[re]=M,re=J;else break e}}function n(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var de=ie[0],re=ie.pop();if(re!==de){ie[0]=re;e:for(var J=0,M=ie.length,Q=M>>>1;J<Q;){var I=2*(J+1)-1,X=ie[I],K=I+1,P=ie[K];if(0>a(X,re))K<M&&0>a(P,X)?(ie[J]=P,ie[K]=re,J=K):(ie[J]=X,ie[I]=re,J=I);else if(K<M&&0>a(P,re))ie[J]=P,ie[K]=re,J=K;else break e}}return de}function a(ie,de){var re=ie.sortIndex-de.sortIndex;return re!==0?re:ie.id-de.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],g=1,v=null,_=3,T=!1,E=!1,S=!1,C=!1,k=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function D(ie){for(var de=n(f);de!==null;){if(de.callback===null)r(f);else if(de.startTime<=ie)r(f),de.sortIndex=de.expirationTime,e(d,de);else break;de=n(f)}}function B(ie){if(S=!1,D(ie),!E)if(n(d)!==null)E=!0,G||(G=!0,ee());else{var de=n(f);de!==null&&we(B,de.startTime-ie)}}var G=!1,F=-1,W=5,U=-1;function ae(){return C?!0:!(t.unstable_now()-U<W)}function z(){if(C=!1,G){var ie=t.unstable_now();U=ie;var de=!0;try{e:{E=!1,S&&(S=!1,A(F),F=-1),T=!0;var re=_;try{t:{for(D(ie),v=n(d);v!==null&&!(v.expirationTime>ie&&ae());){var J=v.callback;if(typeof J=="function"){v.callback=null,_=v.priorityLevel;var M=J(v.expirationTime<=ie);if(ie=t.unstable_now(),typeof M=="function"){v.callback=M,D(ie),de=!0;break t}v===n(d)&&r(d),D(ie)}else r(d);v=n(d)}if(v!==null)de=!0;else{var Q=n(f);Q!==null&&we(B,Q.startTime-ie),de=!1}}break e}finally{v=null,_=re,T=!1}de=void 0}}finally{de?ee():G=!1}}}var ee;if(typeof b=="function")ee=function(){b(z)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Ae=Ee.port2;Ee.port1.onmessage=z,ee=function(){Ae.postMessage(null)}}else ee=function(){k(z,0)};function we(ie,de){F=k(function(){ie(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ie){switch(_){case 1:case 2:case 3:var de=3;break;default:de=_}var re=_;_=de;try{return ie()}finally{_=re}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(ie,de){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var re=_;_=ie;try{return de()}finally{_=re}},t.unstable_scheduleCallback=function(ie,de,re){var J=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?J+re:J):re=J,ie){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=re+M,ie={id:g++,callback:de,priorityLevel:ie,startTime:re,expirationTime:M,sortIndex:-1},re>J?(ie.sortIndex=re,e(f,ie),n(d)===null&&ie===n(f)&&(S?(A(F),F=-1):S=!0,we(B,re-J))):(ie.sortIndex=M,e(d,ie),E||T||(E=!0,G||(G=!0,ee()))),ie},t.unstable_shouldYield=ae,t.unstable_wrapCallback=function(ie){var de=_;return function(){var re=_;_=de;try{return ie.apply(this,arguments)}finally{_=re}}}}(Oh)),Oh}var M1;function Ob(){return M1||(M1=1,Ph.exports=Pb()),Ph.exports}var Uh={exports:{}},Un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function Ub(){if(D1)return Un;D1=1;var t=Zm();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(d,f,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:d,containerInfo:f,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Un.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return s(d,f,null,g)},Un.flushSync=function(d){var f=l.T,g=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=g,r.d.f()}},Un.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},Un.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Un.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,T=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:T}):g==="script"&&r.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:T,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Un.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},Un.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin);r.d.L(d,g,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Un.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=c(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},Un.requestFormReset=function(d){r.d.r(d)},Un.unstable_batchedUpdates=function(d,f){return d(f)},Un.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},Un.useFormStatus=function(){return l.H.useHostTransitionStatus()},Un.version="19.1.0",Un}var I1;function Bb(){if(I1)return Uh.exports;I1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Uh.exports=Ub(),Uh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function jb(){if(F1)return lc;F1=1;var t=Ob(),e=Zm(),n=Bb();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function c(i){if(s(i)!==i)throw Error(r(188))}function d(i){var o=i.alternate;if(!o){if(o=s(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,p=o;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(p=y.return,p!==null){u=p;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return c(y),i;if(w===p)return c(y),o;w=w.sibling}throw Error(r(188))}if(u.return!==p.return)u=y,p=w;else{for(var N=!1,L=y.child;L;){if(L===u){N=!0,u=y,p=w;break}if(L===p){N=!0,p=y,u=w;break}L=L.sibling}if(!N){for(L=w.child;L;){if(L===u){N=!0,u=w,p=y;break}if(L===p){N=!0,p=w,u=y;break}L=L.sibling}if(!N)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function f(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=f(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),A=Symbol.for("react.consumer"),b=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),ae=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function ee(i){return i===null||typeof i!="object"?null:(i=z&&i[z]||i["@@iterator"],typeof i=="function"?i:null)}var Ee=Symbol.for("react.client.reference");function Ae(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Ee?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case B:return"Suspense";case G:return"SuspenseList";case U:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case T:return"Portal";case b:return(i.displayName||"Context")+".Provider";case A:return(i._context.displayName||"Context")+".Consumer";case D:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case F:return o=i.displayName||null,o!==null?o:Ae(i.type)||"Memo";case W:o=i._payload,i=i._init;try{return Ae(i(o))}catch{}}return null}var we=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},J=[],M=-1;function Q(i){return{current:i}}function I(i){0>M||(i.current=J[M],J[M]=null,M--)}function X(i,o){M++,J[M]=i.current,i.current=o}var K=Q(null),P=Q(null),te=Q(null),me=Q(null);function ve(i,o){switch(X(te,o),X(P,i),X(K,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?e1(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=e1(o),i=t1(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}I(K),X(K,i)}function ye(){I(K),I(P),I(te)}function _e(i){i.memoizedState!==null&&X(me,i);var o=K.current,u=t1(o,i.type);o!==u&&(X(P,i),X(K,u))}function $e(i){P.current===i&&(I(K),I(P)),me.current===i&&(I(me),nc._currentValue=re)}var Z=Object.prototype.hasOwnProperty,ct=t.unstable_scheduleCallback,qe=t.unstable_cancelCallback,dt=t.unstable_shouldYield,tt=t.unstable_requestPaint,Me=t.unstable_now,Ft=t.unstable_getCurrentPriorityLevel,pn=t.unstable_ImmediatePriority,sn=t.unstable_UserBlockingPriority,en=t.unstable_NormalPriority,rr=t.unstable_LowPriority,Pn=t.unstable_IdlePriority,Jt=t.log,Jn=t.unstable_setDisableYieldValue,gn=null,qt=null;function At(i){if(typeof Jt=="function"&&Jn(i),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(gn,i)}catch{}}var Nt=Math.clz32?Math.clz32:tn,Qe=Math.log,wt=Math.LN2;function tn(i){return i>>>=0,i===0?32:31-(Qe(i)/wt|0)|0}var Ne=256,Ge=4194304;function Ve(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ze(i,o,u){var p=i.pendingLanes;if(p===0)return 0;var y=0,w=i.suspendedLanes,N=i.pingedLanes;i=i.warmLanes;var L=p&134217727;return L!==0?(p=L&~w,p!==0?y=Ve(p):(N&=L,N!==0?y=Ve(N):u||(u=L&~i,u!==0&&(y=Ve(u))))):(L=p&~w,L!==0?y=Ve(L):N!==0?y=Ve(N):u||(u=p&~i,u!==0&&(y=Ve(u)))),y===0?0:o!==0&&o!==y&&(o&w)===0&&(w=y&-y,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:y}function nt(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function dr(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sa(){var i=Ne;return Ne<<=1,(Ne&4194048)===0&&(Ne=256),i}function Hi(){var i=Ge;return Ge<<=1,(Ge&62914560)===0&&(Ge=4194304),i}function $i(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Aa(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ti(i,o,u,p,y,w){var N=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var L=i.entanglements,ne=i.expirationTimes,fe=i.hiddenUpdates;for(u=N&~u;0<u;){var Se=31-Nt(u),be=1<<Se;L[Se]=0,ne[Se]=-1;var ge=fe[Se];if(ge!==null)for(fe[Se]=null,Se=0;Se<ge.length;Se++){var xe=ge[Se];xe!==null&&(xe.lane&=-536870913)}u&=~be}p!==0&&Vs(i,p,0),w!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=w&~(N&~o))}function Vs(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-Nt(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|u&4194090}function Hs(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var p=31-Nt(u),y=1<<p;y&o|i[p]&o&&(i[p]|=o),u&=~y}}function Gi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function zi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function $s(){var i=de.p;return i!==0?i:(i=window.event,i===void 0?32:_1(i.type))}function hl(i,o){var u=de.p;try{return de.p=i,o()}finally{de.p=u}}var Cr=Math.random().toString(36).slice(2),on="__reactFiber$"+Cr,ln="__reactProps$"+Cr,oa="__reactContainer$"+Cr,hr="__reactEvents$"+Cr,ml="__reactListeners$"+Cr,R="__reactHandles$"+Cr,j="__reactResources$"+Cr,O="__reactMarker$"+Cr;function V(i){delete i[on],delete i[ln],delete i[hr],delete i[ml],delete i[R]}function q(i){var o=i[on];if(o)return o;for(var u=i.parentNode;u;){if(o=u[oa]||u[on]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=i1(i);i!==null;){if(u=i[on])return u;i=i1(i)}return o}i=u,u=i.parentNode}return null}function Y(i){if(i=i[on]||i[oa]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function ue(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function Te(i){var o=i[j];return o||(o=i[j]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(i){i[O]=!0}var he=new Set,pe={};function ke(i,o){De(i,o),De(i+"Capture",o)}function De(i,o){for(pe[i]=o,i=0;i<o.length;i++)he.add(o[i])}var Le=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Re={},Fe={};function Xe(i){return Z.call(Fe,i)?!0:Z.call(Re,i)?!1:Le.test(i)?Fe[i]=!0:(Re[i]=!0,!1)}function kt(i,o,u){if(Xe(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function Ct(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Rt(i,o,u,p){if(p===null)i.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+p)}}var $r,ni;function br(i){if($r===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);$r=o&&o[1]||"",ni=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$r+i+ni}var Gr=!1;function qi(i,o){if(!i||Gr)return"";Gr=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(xe){var ge=xe}Reflect.construct(i,[],be)}else{try{be.call()}catch(xe){ge=xe}i.call(be.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(be=i())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=p.DetermineComponentFrameRoot(),N=w[0],L=w[1];if(N&&L){var ne=N.split(`
`),fe=L.split(`
`);for(y=p=0;p<ne.length&&!ne[p].includes("DetermineComponentFrameRoot");)p++;for(;y<fe.length&&!fe[y].includes("DetermineComponentFrameRoot");)y++;if(p===ne.length||y===fe.length)for(p=ne.length-1,y=fe.length-1;1<=p&&0<=y&&ne[p]!==fe[y];)y--;for(;1<=p&&0<=y;p--,y--)if(ne[p]!==fe[y]){if(p!==1||y!==1)do if(p--,y--,0>y||ne[p]!==fe[y]){var Se=`
`+ne[p].replace(" at new "," at ");return i.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",i.displayName)),Se}while(1<=p&&0<=y);break}}}finally{Gr=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?br(u):""}function zr(i){switch(i.tag){case 26:case 27:case 5:return br(i.type);case 16:return br("Lazy");case 13:return br("Suspense");case 19:return br("SuspenseList");case 0:case 15:return qi(i.type,!1);case 11:return qi(i.type.render,!1);case 1:return qi(i.type,!0);case 31:return br("Activity");default:return""}}function Wp(i){try{var o="";do o+=zr(i),i=i.return;while(i);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Ar(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Jp(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function AS(i){var o=Jp(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return y.call(this)},set:function(N){p=""+N,w.call(this,N)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(N){p=""+N},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function uu(i){i._valueTracker||(i._valueTracker=AS(i))}function Kp(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return i&&(p=Jp(i)?i.checked?"true":"false":i.value),i=p,i!==u?(o.setValue(i),!0):!1}function fu(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var kS=/[\n"\\]/g;function kr(i){return i.replace(kS,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Rd(i,o,u,p,y,w,N,L){i.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?i.type=N:i.removeAttribute("type"),o!=null?N==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+Ar(o)):i.value!==""+Ar(o)&&(i.value=""+Ar(o)):N!=="submit"&&N!=="reset"||i.removeAttribute("value"),o!=null?Md(i,N,Ar(o)):u!=null?Md(i,N,Ar(u)):p!=null&&i.removeAttribute("value"),y==null&&w!=null&&(i.defaultChecked=!!w),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?i.name=""+Ar(L):i.removeAttribute("name")}function Xp(i,o,u,p,y,w,N,L){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null))return;u=u!=null?""+Ar(u):"",o=o!=null?""+Ar(o):u,L||o===i.value||(i.value=o),i.defaultValue=o}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=L?i.checked:!!p,i.defaultChecked=!!p,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(i.name=N)}function Md(i,o,u){o==="number"&&fu(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function Gs(i,o,u,p){if(i=i.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<i.length;u++)y=o.hasOwnProperty("$"+i[u].value),i[u].selected!==y&&(i[u].selected=y),y&&p&&(i[u].defaultSelected=!0)}else{for(u=""+Ar(u),o=null,y=0;y<i.length;y++){if(i[y].value===u){i[y].selected=!0,p&&(i[y].defaultSelected=!0);return}o!==null||i[y].disabled||(o=i[y])}o!==null&&(o.selected=!0)}}function Zp(i,o,u){if(o!=null&&(o=""+Ar(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+Ar(u):""}function Qp(i,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(we(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=Ar(o),i.defaultValue=u,p=i.textContent,p===u&&p!==""&&p!==null&&(i.value=p)}function zs(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var NS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function eg(i,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,u):typeof u!="number"||u===0||NS.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function tg(i,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var y in o)p=o[y],o.hasOwnProperty(y)&&u[y]!==p&&eg(i,y,p)}else for(var w in o)o.hasOwnProperty(w)&&eg(i,w,o[w])}function Dd(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function du(i){return MS.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Id=null;function Fd(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var qs=null,Ys=null;function ng(i){var o=Y(i);if(o&&(i=o.stateNode)){var u=i[ln]||null;e:switch(i=o.stateNode,o.type){case"input":if(Rd(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+kr(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==i&&p.form===i.form){var y=p[ln]||null;if(!y)throw Error(r(90));Rd(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===i.form&&Kp(p)}break e;case"textarea":Zp(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Gs(i,!!u.multiple,o,!1)}}}var Ld=!1;function rg(i,o,u){if(Ld)return i(o,u);Ld=!0;try{var p=i(o);return p}finally{if(Ld=!1,(qs!==null||Ys!==null)&&(Xu(),qs&&(o=qs,i=Ys,Ys=qs=null,ng(o),i)))for(o=0;o<i.length;o++)ng(i[o])}}function pl(i,o){var u=i.stateNode;if(u===null)return null;var p=u[ln]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pd=!1;if(ka)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){Pd=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{Pd=!1}var ri=null,Od=null,hu=null;function ag(){if(hu)return hu;var i,o=Od,u=o.length,p,y="value"in ri?ri.value:ri.textContent,w=y.length;for(i=0;i<u&&o[i]===y[i];i++);var N=u-i;for(p=1;p<=N&&o[u-p]===y[w-p];p++);return hu=y.slice(i,1<p?1-p:void 0)}function mu(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function pu(){return!0}function ig(){return!1}function ar(i){function o(u,p,y,w,N){this._reactName=u,this._targetInst=y,this.type=p,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var L in i)i.hasOwnProperty(L)&&(u=i[L],this[L]=u?u(w):w[L]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?pu:ig,this.isPropagationStopped=ig,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=pu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=pu)},persist:function(){},isPersistent:pu}),o}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gu=ar(Yi),xl=g({},Yi,{view:0,detail:0}),DS=ar(xl),Ud,Bd,vl,xu=g({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==vl&&(vl&&i.type==="mousemove"?(Ud=i.screenX-vl.screenX,Bd=i.screenY-vl.screenY):Bd=Ud=0,vl=i),Ud)},movementY:function(i){return"movementY"in i?i.movementY:Bd}}),sg=ar(xu),IS=g({},xu,{dataTransfer:0}),FS=ar(IS),LS=g({},xl,{relatedTarget:0}),jd=ar(LS),PS=g({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),OS=ar(PS),US=g({},Yi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),BS=ar(US),jS=g({},Yi,{data:0}),og=ar(jS),VS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$S={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GS(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=$S[i])?!!o[i]:!1}function Vd(){return GS}var zS=g({},xl,{key:function(i){if(i.key){var o=VS[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=mu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?HS[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vd,charCode:function(i){return i.type==="keypress"?mu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?mu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),qS=ar(zS),YS=g({},xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lg=ar(YS),WS=g({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vd}),JS=ar(WS),KS=g({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),XS=ar(KS),ZS=g({},xu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),QS=ar(ZS),eC=g({},Yi,{newState:0,oldState:0}),tC=ar(eC),nC=[9,13,27,32],Hd=ka&&"CompositionEvent"in window,yl=null;ka&&"documentMode"in document&&(yl=document.documentMode);var rC=ka&&"TextEvent"in window&&!yl,cg=ka&&(!Hd||yl&&8<yl&&11>=yl),ug=" ",fg=!1;function dg(i,o){switch(i){case"keyup":return nC.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hg(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ws=!1;function aC(i,o){switch(i){case"compositionend":return hg(o);case"keypress":return o.which!==32?null:(fg=!0,ug);case"textInput":return i=o.data,i===ug&&fg?null:i;default:return null}}function iC(i,o){if(Ws)return i==="compositionend"||!Hd&&dg(i,o)?(i=ag(),hu=Od=ri=null,Ws=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return cg&&o.locale!=="ko"?null:o.data;default:return null}}var sC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mg(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!sC[i.type]:o==="textarea"}function pg(i,o,u,p){qs?Ys?Ys.push(p):Ys=[p]:qs=p,o=rf(o,"onChange"),0<o.length&&(u=new gu("onChange","change",null,u,p),i.push({event:u,listeners:o}))}var _l=null,wl=null;function oC(i){Jv(i,0)}function vu(i){var o=ue(i);if(Kp(o))return i}function gg(i,o){if(i==="change")return o}var xg=!1;if(ka){var $d;if(ka){var Gd="oninput"in document;if(!Gd){var vg=document.createElement("div");vg.setAttribute("oninput","return;"),Gd=typeof vg.oninput=="function"}$d=Gd}else $d=!1;xg=$d&&(!document.documentMode||9<document.documentMode)}function yg(){_l&&(_l.detachEvent("onpropertychange",_g),wl=_l=null)}function _g(i){if(i.propertyName==="value"&&vu(wl)){var o=[];pg(o,wl,i,Fd(i)),rg(oC,o)}}function lC(i,o,u){i==="focusin"?(yg(),_l=o,wl=u,_l.attachEvent("onpropertychange",_g)):i==="focusout"&&yg()}function cC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return vu(wl)}function uC(i,o){if(i==="click")return vu(o)}function fC(i,o){if(i==="input"||i==="change")return vu(o)}function dC(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var mr=typeof Object.is=="function"?Object.is:dC;function Tl(i,o){if(mr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var y=u[p];if(!Z.call(o,y)||!mr(i[y],o[y]))return!1}return!0}function wg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Tg(i,o){var u=wg(i);i=0;for(var p;u;){if(u.nodeType===3){if(p=i+u.textContent.length,i<=o&&p>=o)return{node:u,offset:o-i};i=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=wg(u)}}function Eg(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Eg(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Sg(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=fu(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=fu(i.document)}return o}function zd(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var hC=ka&&"documentMode"in document&&11>=document.documentMode,Js=null,qd=null,El=null,Yd=!1;function Cg(i,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Yd||Js==null||Js!==fu(p)||(p=Js,"selectionStart"in p&&zd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),El&&Tl(El,p)||(El=p,p=rf(qd,"onSelect"),0<p.length&&(o=new gu("onSelect","select",null,o,u),i.push({event:o,listeners:p}),o.target=Js)))}function Wi(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Ks={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionrun:Wi("Transition","TransitionRun"),transitionstart:Wi("Transition","TransitionStart"),transitioncancel:Wi("Transition","TransitionCancel"),transitionend:Wi("Transition","TransitionEnd")},Wd={},bg={};ka&&(bg=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Ji(i){if(Wd[i])return Wd[i];if(!Ks[i])return i;var o=Ks[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in bg)return Wd[i]=o[u];return i}var Ag=Ji("animationend"),kg=Ji("animationiteration"),Ng=Ji("animationstart"),mC=Ji("transitionrun"),pC=Ji("transitionstart"),gC=Ji("transitioncancel"),Rg=Ji("transitionend"),Mg=new Map,Jd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jd.push("scrollEnd");function qr(i,o){Mg.set(i,o),ke(o,[i])}var Dg=new WeakMap;function Nr(i,o){if(typeof i=="object"&&i!==null){var u=Dg.get(i);return u!==void 0?u:(o={value:i,source:o,stack:Wp(o)},Dg.set(i,o),o)}return{value:i,source:o,stack:Wp(o)}}var Rr=[],Xs=0,Kd=0;function yu(){for(var i=Xs,o=Kd=Xs=0;o<i;){var u=Rr[o];Rr[o++]=null;var p=Rr[o];Rr[o++]=null;var y=Rr[o];Rr[o++]=null;var w=Rr[o];if(Rr[o++]=null,p!==null&&y!==null){var N=p.pending;N===null?y.next=y:(y.next=N.next,N.next=y),p.pending=y}w!==0&&Ig(u,y,w)}}function _u(i,o,u,p){Rr[Xs++]=i,Rr[Xs++]=o,Rr[Xs++]=u,Rr[Xs++]=p,Kd|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Xd(i,o,u,p){return _u(i,o,u,p),wu(i)}function Zs(i,o){return _u(i,null,null,o),wu(i)}function Ig(i,o,u){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u);for(var y=!1,w=i.return;w!==null;)w.childLanes|=u,p=w.alternate,p!==null&&(p.childLanes|=u),w.tag===22&&(i=w.stateNode,i===null||i._visibility&1||(y=!0)),i=w,w=w.return;return i.tag===3?(w=i.stateNode,y&&o!==null&&(y=31-Nt(u),i=w.hiddenUpdates,p=i[y],p===null?i[y]=[o]:p.push(o),o.lane=u|536870912),w):null}function wu(i){if(50<Wl)throw Wl=0,rh=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Qs={};function xC(i,o,u,p){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(i,o,u,p){return new xC(i,o,u,p)}function Zd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Na(i,o){var u=i.alternate;return u===null?(u=pr(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Fg(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Tu(i,o,u,p,y,w){var N=0;if(p=i,typeof i=="function")Zd(i)&&(N=1);else if(typeof i=="string")N=yb(i,u,K.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case U:return i=pr(31,u,o,y),i.elementType=U,i.lanes=w,i;case E:return Ki(u.children,y,w,o);case S:N=8,y|=24;break;case C:return i=pr(12,u,o,y|2),i.elementType=C,i.lanes=w,i;case B:return i=pr(13,u,o,y),i.elementType=B,i.lanes=w,i;case G:return i=pr(19,u,o,y),i.elementType=G,i.lanes=w,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case k:case b:N=10;break e;case A:N=9;break e;case D:N=11;break e;case F:N=14;break e;case W:N=16,p=null;break e}N=29,u=Error(r(130,i===null?"null":typeof i,"")),p=null}return o=pr(N,u,o,y),o.elementType=i,o.type=p,o.lanes=w,o}function Ki(i,o,u,p){return i=pr(7,i,p,o),i.lanes=u,i}function Qd(i,o,u){return i=pr(6,i,null,o),i.lanes=u,i}function e0(i,o,u){return o=pr(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var eo=[],to=0,Eu=null,Su=0,Mr=[],Dr=0,Xi=null,Ra=1,Ma="";function Zi(i,o){eo[to++]=Su,eo[to++]=Eu,Eu=i,Su=o}function Lg(i,o,u){Mr[Dr++]=Ra,Mr[Dr++]=Ma,Mr[Dr++]=Xi,Xi=i;var p=Ra;i=Ma;var y=32-Nt(p)-1;p&=~(1<<y),u+=1;var w=32-Nt(o)+y;if(30<w){var N=y-y%5;w=(p&(1<<N)-1).toString(32),p>>=N,y-=N,Ra=1<<32-Nt(o)+y|u<<y|p,Ma=w+i}else Ra=1<<w|u<<y|p,Ma=i}function t0(i){i.return!==null&&(Zi(i,1),Lg(i,1,0))}function n0(i){for(;i===Eu;)Eu=eo[--to],eo[to]=null,Su=eo[--to],eo[to]=null;for(;i===Xi;)Xi=Mr[--Dr],Mr[Dr]=null,Ma=Mr[--Dr],Mr[Dr]=null,Ra=Mr[--Dr],Mr[Dr]=null}var Kn=null,Kt=null,bt=!1,Qi=null,la=!1,r0=Error(r(519));function es(i){var o=Error(r(418,""));throw bl(Nr(o,i)),r0}function Pg(i){var o=i.stateNode,u=i.type,p=i.memoizedProps;switch(o[on]=i,o[ln]=p,u){case"dialog":mt("cancel",o),mt("close",o);break;case"iframe":case"object":case"embed":mt("load",o);break;case"video":case"audio":for(u=0;u<Kl.length;u++)mt(Kl[u],o);break;case"source":mt("error",o);break;case"img":case"image":case"link":mt("error",o),mt("load",o);break;case"details":mt("toggle",o);break;case"input":mt("invalid",o),Xp(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),uu(o);break;case"select":mt("invalid",o);break;case"textarea":mt("invalid",o),Qp(o,p.value,p.defaultValue,p.children),uu(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||Qv(o.textContent,u)?(p.popover!=null&&(mt("beforetoggle",o),mt("toggle",o)),p.onScroll!=null&&mt("scroll",o),p.onScrollEnd!=null&&mt("scrollend",o),p.onClick!=null&&(o.onclick=af),o=!0):o=!1,o||es(i)}function Og(i){for(Kn=i.return;Kn;)switch(Kn.tag){case 5:case 13:la=!1;return;case 27:case 3:la=!0;return;default:Kn=Kn.return}}function Sl(i){if(i!==Kn)return!1;if(!bt)return Og(i),bt=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||yh(i.type,i.memoizedProps)),u=!u),u&&Kt&&es(i),Og(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(u=i.data,u==="/$"){if(o===0){Kt=Wr(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;i=i.nextSibling}Kt=null}}else o===27?(o=Kt,yi(i.type)?(i=Eh,Eh=null,Kt=i):Kt=o):Kt=Kn?Wr(i.stateNode.nextSibling):null;return!0}function Cl(){Kt=Kn=null,bt=!1}function Ug(){var i=Qi;return i!==null&&(or===null?or=i:or.push.apply(or,i),Qi=null),i}function bl(i){Qi===null?Qi=[i]:Qi.push(i)}var a0=Q(null),ts=null,Da=null;function ai(i,o,u){X(a0,o._currentValue),o._currentValue=u}function Ia(i){i._currentValue=a0.current,I(a0)}function i0(i,o,u){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===u)break;i=i.return}}function s0(i,o,u,p){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var w=y.dependencies;if(w!==null){var N=y.child;w=w.firstContext;e:for(;w!==null;){var L=w;w=y;for(var ne=0;ne<o.length;ne++)if(L.context===o[ne]){w.lanes|=u,L=w.alternate,L!==null&&(L.lanes|=u),i0(w.return,u,i),p||(N=null);break e}w=L.next}}else if(y.tag===18){if(N=y.return,N===null)throw Error(r(341));N.lanes|=u,w=N.alternate,w!==null&&(w.lanes|=u),i0(N,u,i),N=null}else N=y.child;if(N!==null)N.return=y;else for(N=y;N!==null;){if(N===i){N=null;break}if(y=N.sibling,y!==null){y.return=N.return,N=y;break}N=N.return}y=N}}function Al(i,o,u,p){i=null;for(var y=o,w=!1;y!==null;){if(!w){if((y.flags&524288)!==0)w=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var N=y.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var L=y.type;mr(y.pendingProps.value,N.value)||(i!==null?i.push(L):i=[L])}}else if(y===me.current){if(N=y.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(nc):i=[nc])}y=y.return}i!==null&&s0(o,i,u,p),o.flags|=262144}function Cu(i){for(i=i.firstContext;i!==null;){if(!mr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ns(i){ts=i,Da=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function On(i){return Bg(ts,i)}function bu(i,o){return ts===null&&ns(i),Bg(i,o)}function Bg(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Da===null){if(i===null)throw Error(r(308));Da=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Da=Da.next=o;return u}var vC=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},yC=t.unstable_scheduleCallback,_C=t.unstable_NormalPriority,xn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function o0(){return{controller:new vC,data:new Map,refCount:0}}function kl(i){i.refCount--,i.refCount===0&&yC(_C,function(){i.controller.abort()})}var Nl=null,l0=0,no=0,ro=null;function wC(i,o){if(Nl===null){var u=Nl=[];l0=0,no=uh(),ro={status:"pending",value:void 0,then:function(p){u.push(p)}}}return l0++,o.then(jg,jg),o}function jg(){if(--l0===0&&Nl!==null){ro!==null&&(ro.status="fulfilled");var i=Nl;Nl=null,no=0,ro=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function TC(i,o){var u=[],p={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(p.status="rejected",p.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),p}var Vg=ie.S;ie.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&wC(i,o),Vg!==null&&Vg(i,o)};var rs=Q(null);function c0(){var i=rs.current;return i!==null?i:Bt.pooledCache}function Au(i,o){o===null?X(rs,rs.current):X(rs,o.pool)}function Hg(){var i=c0();return i===null?null:{parent:xn._currentValue,pool:i}}var Rl=Error(r(460)),$g=Error(r(474)),ku=Error(r(542)),u0={then:function(){}};function Gg(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Nu(){}function zg(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(Nu,Nu),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Yg(i),i;default:if(typeof o.status=="string")o.then(Nu,Nu);else{if(i=Bt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=p}},function(p){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Yg(i),i}throw Ml=o,Rl}}var Ml=null;function qg(){if(Ml===null)throw Error(r(459));var i=Ml;return Ml=null,i}function Yg(i){if(i===Rl||i===ku)throw Error(r(483))}var ii=!1;function f0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function d0(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function si(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function oi(i,o,u){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Mt&2)!==0){var y=p.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),p.pending=o,o=wu(i),Ig(i,null,u),o}return _u(i,p,o,u),wu(i)}function Dl(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,Hs(i,u)}}function h0(i,o){var u=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?y=w=N:w=w.next=N,u=u.next}while(u!==null);w===null?y=w=o:w=w.next=o}else y=w=o;u={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:p.shared,callbacks:p.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var m0=!1;function Il(){if(m0){var i=ro;if(i!==null)throw i}}function Fl(i,o,u,p){m0=!1;var y=i.updateQueue;ii=!1;var w=y.firstBaseUpdate,N=y.lastBaseUpdate,L=y.shared.pending;if(L!==null){y.shared.pending=null;var ne=L,fe=ne.next;ne.next=null,N===null?w=fe:N.next=fe,N=ne;var Se=i.alternate;Se!==null&&(Se=Se.updateQueue,L=Se.lastBaseUpdate,L!==N&&(L===null?Se.firstBaseUpdate=fe:L.next=fe,Se.lastBaseUpdate=ne))}if(w!==null){var be=y.baseState;N=0,Se=fe=ne=null,L=w;do{var ge=L.lane&-536870913,xe=ge!==L.lane;if(xe?(vt&ge)===ge:(p&ge)===ge){ge!==0&&ge===no&&(m0=!0),Se!==null&&(Se=Se.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var Je=i,Ye=L;ge=o;var Ot=u;switch(Ye.tag){case 1:if(Je=Ye.payload,typeof Je=="function"){be=Je.call(Ot,be,ge);break e}be=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=Ye.payload,ge=typeof Je=="function"?Je.call(Ot,be,ge):Je,ge==null)break e;be=g({},be,ge);break e;case 2:ii=!0}}ge=L.callback,ge!==null&&(i.flags|=64,xe&&(i.flags|=8192),xe=y.callbacks,xe===null?y.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Se===null?(fe=Se=xe,ne=be):Se=Se.next=xe,N|=ge;if(L=L.next,L===null){if(L=y.shared.pending,L===null)break;xe=L,L=xe.next,xe.next=null,y.lastBaseUpdate=xe,y.shared.pending=null}}while(!0);Se===null&&(ne=be),y.baseState=ne,y.firstBaseUpdate=fe,y.lastBaseUpdate=Se,w===null&&(y.shared.lanes=0),pi|=N,i.lanes=N,i.memoizedState=be}}function Wg(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function Jg(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Wg(u[i],o)}var ao=Q(null),Ru=Q(0);function Kg(i,o){i=ja,X(Ru,i),X(ao,o),ja=i|o.baseLanes}function p0(){X(Ru,ja),X(ao,ao.current)}function g0(){ja=Ru.current,I(ao),I(Ru)}var li=0,ut=null,Lt=null,cn=null,Mu=!1,io=!1,as=!1,Du=0,Ll=0,so=null,EC=0;function nn(){throw Error(r(321))}function x0(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!mr(i[u],o[u]))return!1;return!0}function v0(i,o,u,p,y,w){return li=w,ut=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ie.H=i===null||i.memoizedState===null?Ix:Fx,as=!1,w=u(p,y),as=!1,io&&(w=Zg(o,u,p,y)),Xg(i),w}function Xg(i){ie.H=Uu;var o=Lt!==null&&Lt.next!==null;if(li=0,cn=Lt=ut=null,Mu=!1,Ll=0,so=null,o)throw Error(r(300));i===null||En||(i=i.dependencies,i!==null&&Cu(i)&&(En=!0))}function Zg(i,o,u,p){ut=i;var y=0;do{if(io&&(so=null),Ll=0,io=!1,25<=y)throw Error(r(301));if(y+=1,cn=Lt=null,i.updateQueue!=null){var w=i.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ie.H=RC,w=o(u,p)}while(io);return w}function SC(){var i=ie.H,o=i.useState()[0];return o=typeof o.then=="function"?Pl(o):o,i=i.useState()[0],(Lt!==null?Lt.memoizedState:null)!==i&&(ut.flags|=1024),o}function y0(){var i=Du!==0;return Du=0,i}function _0(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function w0(i){if(Mu){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Mu=!1}li=0,cn=Lt=ut=null,io=!1,Ll=Du=0,so=null}function ir(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?ut.memoizedState=cn=i:cn=cn.next=i,cn}function un(){if(Lt===null){var i=ut.alternate;i=i!==null?i.memoizedState:null}else i=Lt.next;var o=cn===null?ut.memoizedState:cn.next;if(o!==null)cn=o,Lt=i;else{if(i===null)throw ut.alternate===null?Error(r(467)):Error(r(310));Lt=i,i={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},cn===null?ut.memoizedState=cn=i:cn=cn.next=i}return cn}function T0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pl(i){var o=Ll;return Ll+=1,so===null&&(so=[]),i=zg(so,i,o),o=ut,(cn===null?o.memoizedState:cn.next)===null&&(o=o.alternate,ie.H=o===null||o.memoizedState===null?Ix:Fx),i}function Iu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Pl(i);if(i.$$typeof===b)return On(i)}throw Error(r(438,String(i)))}function E0(i){var o=null,u=ut.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=ut.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=T0(),ut.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),p=0;p<i;p++)u[p]=ae;return o.index++,u}function Fa(i,o){return typeof o=="function"?o(i):o}function Fu(i){var o=un();return S0(o,Lt,i)}function S0(i,o,u){var p=i.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var y=i.baseQueue,w=p.pending;if(w!==null){if(y!==null){var N=y.next;y.next=w.next,w.next=N}o.baseQueue=y=w,p.pending=null}if(w=i.baseState,y===null)i.memoizedState=w;else{o=y.next;var L=N=null,ne=null,fe=o,Se=!1;do{var be=fe.lane&-536870913;if(be!==fe.lane?(vt&be)===be:(li&be)===be){var ge=fe.revertLane;if(ge===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),be===no&&(Se=!0);else if((li&ge)===ge){fe=fe.next,ge===no&&(Se=!0);continue}else be={lane:0,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},ne===null?(L=ne=be,N=w):ne=ne.next=be,ut.lanes|=ge,pi|=ge;be=fe.action,as&&u(w,be),w=fe.hasEagerState?fe.eagerState:u(w,be)}else ge={lane:be,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},ne===null?(L=ne=ge,N=w):ne=ne.next=ge,ut.lanes|=be,pi|=be;fe=fe.next}while(fe!==null&&fe!==o);if(ne===null?N=w:ne.next=L,!mr(w,i.memoizedState)&&(En=!0,Se&&(u=ro,u!==null)))throw u;i.memoizedState=w,i.baseState=N,i.baseQueue=ne,p.lastRenderedState=w}return y===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function C0(i){var o=un(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var p=u.dispatch,y=u.pending,w=o.memoizedState;if(y!==null){u.pending=null;var N=y=y.next;do w=i(w,N.action),N=N.next;while(N!==y);mr(w,o.memoizedState)||(En=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,p]}function Qg(i,o,u){var p=ut,y=un(),w=bt;if(w){if(u===void 0)throw Error(r(407));u=u()}else u=o();var N=!mr((Lt||y).memoizedState,u);N&&(y.memoizedState=u,En=!0),y=y.queue;var L=nx.bind(null,p,y,i);if(Ol(2048,8,L,[i]),y.getSnapshot!==o||N||cn!==null&&cn.memoizedState.tag&1){if(p.flags|=2048,oo(9,Lu(),tx.bind(null,p,y,u,o),null),Bt===null)throw Error(r(349));w||(li&124)!==0||ex(p,o,u)}return u}function ex(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ut.updateQueue,o===null?(o=T0(),ut.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function tx(i,o,u,p){o.value=u,o.getSnapshot=p,rx(o)&&ax(i)}function nx(i,o,u){return u(function(){rx(o)&&ax(i)})}function rx(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!mr(i,u)}catch{return!0}}function ax(i){var o=Zs(i,2);o!==null&&_r(o,i,2)}function b0(i){var o=ir();if(typeof i=="function"){var u=i;if(i=u(),as){At(!0);try{u()}finally{At(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:i},o}function ix(i,o,u,p){return i.baseState=u,S0(i,Lt,typeof p=="function"?p:Fa)}function CC(i,o,u,p,y){if(Ou(i))throw Error(r(485));if(i=o.action,i!==null){var w={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};ie.T!==null?u(!0):w.isTransition=!1,p(w),u=o.pending,u===null?(w.next=o.pending=w,sx(o,w)):(w.next=u.next,o.pending=u.next=w)}}function sx(i,o){var u=o.action,p=o.payload,y=i.state;if(o.isTransition){var w=ie.T,N={};ie.T=N;try{var L=u(y,p),ne=ie.S;ne!==null&&ne(N,L),ox(i,o,L)}catch(fe){A0(i,o,fe)}finally{ie.T=w}}else try{w=u(y,p),ox(i,o,w)}catch(fe){A0(i,o,fe)}}function ox(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){lx(i,o,p)},function(p){return A0(i,o,p)}):lx(i,o,u)}function lx(i,o,u){o.status="fulfilled",o.value=u,cx(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,sx(i,u)))}function A0(i,o,u){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,cx(o),o=o.next;while(o!==p)}i.action=null}function cx(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function ux(i,o){return o}function fx(i,o){if(bt){var u=Bt.formState;if(u!==null){e:{var p=ut;if(bt){if(Kt){t:{for(var y=Kt,w=la;y.nodeType!==8;){if(!w){y=null;break t}if(y=Wr(y.nextSibling),y===null){y=null;break t}}w=y.data,y=w==="F!"||w==="F"?y:null}if(y){Kt=Wr(y.nextSibling),p=y.data==="F!";break e}}es(p)}p=!1}p&&(o=u[0])}}return u=ir(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ux,lastRenderedState:o},u.queue=p,u=Rx.bind(null,ut,p),p.dispatch=u,p=b0(!1),w=D0.bind(null,ut,!1,p.queue),p=ir(),y={state:o,dispatch:null,action:i,pending:null},p.queue=y,u=CC.bind(null,ut,y,w,u),y.dispatch=u,p.memoizedState=i,[o,u,!1]}function dx(i){var o=un();return hx(o,Lt,i)}function hx(i,o,u){if(o=S0(i,o,ux)[0],i=Fu(Fa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Pl(o)}catch(N){throw N===Rl?ku:N}else p=o;o=un();var y=o.queue,w=y.dispatch;return u!==o.memoizedState&&(ut.flags|=2048,oo(9,Lu(),bC.bind(null,y,u),null)),[p,w,i]}function bC(i,o){i.action=o}function mx(i){var o=un(),u=Lt;if(u!==null)return hx(o,u,i);un(),o=o.memoizedState,u=un();var p=u.queue.dispatch;return u.memoizedState=i,[o,p,!1]}function oo(i,o,u,p){return i={tag:i,create:u,deps:p,inst:o,next:null},o=ut.updateQueue,o===null&&(o=T0(),ut.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(p=u.next,u.next=i,i.next=p,o.lastEffect=i),i}function Lu(){return{destroy:void 0,resource:void 0}}function px(){return un().memoizedState}function Pu(i,o,u,p){var y=ir();p=p===void 0?null:p,ut.flags|=i,y.memoizedState=oo(1|o,Lu(),u,p)}function Ol(i,o,u,p){var y=un();p=p===void 0?null:p;var w=y.memoizedState.inst;Lt!==null&&p!==null&&x0(p,Lt.memoizedState.deps)?y.memoizedState=oo(o,w,u,p):(ut.flags|=i,y.memoizedState=oo(1|o,w,u,p))}function gx(i,o){Pu(8390656,8,i,o)}function xx(i,o){Ol(2048,8,i,o)}function vx(i,o){return Ol(4,2,i,o)}function yx(i,o){return Ol(4,4,i,o)}function _x(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function wx(i,o,u){u=u!=null?u.concat([i]):null,Ol(4,4,_x.bind(null,o,i),u)}function k0(){}function Tx(i,o){var u=un();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&x0(o,p[1])?p[0]:(u.memoizedState=[i,o],i)}function Ex(i,o){var u=un();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&x0(o,p[1]))return p[0];if(p=i(),as){At(!0);try{i()}finally{At(!1)}}return u.memoizedState=[p,o],p}function N0(i,o,u){return u===void 0||(li&1073741824)!==0?i.memoizedState=o:(i.memoizedState=u,i=bv(),ut.lanes|=i,pi|=i,u)}function Sx(i,o,u,p){return mr(u,o)?u:ao.current!==null?(i=N0(i,u,p),mr(i,o)||(En=!0),i):(li&42)===0?(En=!0,i.memoizedState=u):(i=bv(),ut.lanes|=i,pi|=i,o)}function Cx(i,o,u,p,y){var w=de.p;de.p=w!==0&&8>w?w:8;var N=ie.T,L={};ie.T=L,D0(i,!1,o,u);try{var ne=y(),fe=ie.S;if(fe!==null&&fe(L,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var Se=TC(ne,p);Ul(i,o,Se,yr(i))}else Ul(i,o,p,yr(i))}catch(be){Ul(i,o,{then:function(){},status:"rejected",reason:be},yr())}finally{de.p=w,ie.T=N}}function AC(){}function R0(i,o,u,p){if(i.tag!==5)throw Error(r(476));var y=bx(i).queue;Cx(i,y,o,re,u===null?AC:function(){return Ax(i),u(p)})}function bx(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:re},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Ax(i){var o=bx(i).next.queue;Ul(i,o,{},yr())}function M0(){return On(nc)}function kx(){return un().memoizedState}function Nx(){return un().memoizedState}function kC(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=yr();i=si(u);var p=oi(o,i,u);p!==null&&(_r(p,o,u),Dl(p,o,u)),o={cache:o0()},i.payload=o;return}o=o.return}}function NC(i,o,u){var p=yr();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Ou(i)?Mx(o,u):(u=Xd(i,o,u,p),u!==null&&(_r(u,i,p),Dx(u,o,p)))}function Rx(i,o,u){var p=yr();Ul(i,o,u,p)}function Ul(i,o,u,p){var y={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ou(i))Mx(o,y);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,L=w(N,u);if(y.hasEagerState=!0,y.eagerState=L,mr(L,N))return _u(i,o,y,0),Bt===null&&yu(),!1}catch{}finally{}if(u=Xd(i,o,y,p),u!==null)return _r(u,i,p),Dx(u,o,p),!0}return!1}function D0(i,o,u,p){if(p={lane:2,revertLane:uh(),action:p,hasEagerState:!1,eagerState:null,next:null},Ou(i)){if(o)throw Error(r(479))}else o=Xd(i,u,p,2),o!==null&&_r(o,i,2)}function Ou(i){var o=i.alternate;return i===ut||o!==null&&o===ut}function Mx(i,o){io=Mu=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function Dx(i,o,u){if((u&4194048)!==0){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,Hs(i,u)}}var Uu={readContext:On,use:Iu,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useLayoutEffect:nn,useInsertionEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useSyncExternalStore:nn,useId:nn,useHostTransitionStatus:nn,useFormState:nn,useActionState:nn,useOptimistic:nn,useMemoCache:nn,useCacheRefresh:nn},Ix={readContext:On,use:Iu,useCallback:function(i,o){return ir().memoizedState=[i,o===void 0?null:o],i},useContext:On,useEffect:gx,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,Pu(4194308,4,_x.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Pu(4194308,4,i,o)},useInsertionEffect:function(i,o){Pu(4,2,i,o)},useMemo:function(i,o){var u=ir();o=o===void 0?null:o;var p=i();if(as){At(!0);try{i()}finally{At(!1)}}return u.memoizedState=[p,o],p},useReducer:function(i,o,u){var p=ir();if(u!==void 0){var y=u(o);if(as){At(!0);try{u(o)}finally{At(!1)}}}else y=o;return p.memoizedState=p.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},p.queue=i,i=i.dispatch=NC.bind(null,ut,i),[p.memoizedState,i]},useRef:function(i){var o=ir();return i={current:i},o.memoizedState=i},useState:function(i){i=b0(i);var o=i.queue,u=Rx.bind(null,ut,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:k0,useDeferredValue:function(i,o){var u=ir();return N0(u,i,o)},useTransition:function(){var i=b0(!1);return i=Cx.bind(null,ut,i.queue,!0,!1),ir().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var p=ut,y=ir();if(bt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Bt===null)throw Error(r(349));(vt&124)!==0||ex(p,o,u)}y.memoizedState=u;var w={value:u,getSnapshot:o};return y.queue=w,gx(nx.bind(null,p,w,i),[i]),p.flags|=2048,oo(9,Lu(),tx.bind(null,p,w,u,o),null),u},useId:function(){var i=ir(),o=Bt.identifierPrefix;if(bt){var u=Ma,p=Ra;u=(p&~(1<<32-Nt(p)-1)).toString(32)+u,o=""+o+"R"+u,u=Du++,0<u&&(o+="H"+u.toString(32)),o+=""}else u=EC++,o=""+o+"r"+u.toString(32)+"";return i.memoizedState=o},useHostTransitionStatus:M0,useFormState:fx,useActionState:fx,useOptimistic:function(i){var o=ir();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=D0.bind(null,ut,!0,u),u.dispatch=o,[i,o]},useMemoCache:E0,useCacheRefresh:function(){return ir().memoizedState=kC.bind(null,ut)}},Fx={readContext:On,use:Iu,useCallback:Tx,useContext:On,useEffect:xx,useImperativeHandle:wx,useInsertionEffect:vx,useLayoutEffect:yx,useMemo:Ex,useReducer:Fu,useRef:px,useState:function(){return Fu(Fa)},useDebugValue:k0,useDeferredValue:function(i,o){var u=un();return Sx(u,Lt.memoizedState,i,o)},useTransition:function(){var i=Fu(Fa)[0],o=un().memoizedState;return[typeof i=="boolean"?i:Pl(i),o]},useSyncExternalStore:Qg,useId:kx,useHostTransitionStatus:M0,useFormState:dx,useActionState:dx,useOptimistic:function(i,o){var u=un();return ix(u,Lt,i,o)},useMemoCache:E0,useCacheRefresh:Nx},RC={readContext:On,use:Iu,useCallback:Tx,useContext:On,useEffect:xx,useImperativeHandle:wx,useInsertionEffect:vx,useLayoutEffect:yx,useMemo:Ex,useReducer:C0,useRef:px,useState:function(){return C0(Fa)},useDebugValue:k0,useDeferredValue:function(i,o){var u=un();return Lt===null?N0(u,i,o):Sx(u,Lt.memoizedState,i,o)},useTransition:function(){var i=C0(Fa)[0],o=un().memoizedState;return[typeof i=="boolean"?i:Pl(i),o]},useSyncExternalStore:Qg,useId:kx,useHostTransitionStatus:M0,useFormState:mx,useActionState:mx,useOptimistic:function(i,o){var u=un();return Lt!==null?ix(u,Lt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:E0,useCacheRefresh:Nx},lo=null,Bl=0;function Bu(i){var o=Bl;return Bl+=1,lo===null&&(lo=[]),zg(lo,i,o)}function jl(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function ju(i,o){throw o.$$typeof===v?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function Lx(i){var o=i._init;return o(i._payload)}function Px(i){function o(oe,se){if(i){var ce=oe.deletions;ce===null?(oe.deletions=[se],oe.flags|=16):ce.push(se)}}function u(oe,se){if(!i)return null;for(;se!==null;)o(oe,se),se=se.sibling;return null}function p(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function y(oe,se){return oe=Na(oe,se),oe.index=0,oe.sibling=null,oe}function w(oe,se,ce){return oe.index=ce,i?(ce=oe.alternate,ce!==null?(ce=ce.index,ce<se?(oe.flags|=67108866,se):ce):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function N(oe){return i&&oe.alternate===null&&(oe.flags|=67108866),oe}function L(oe,se,ce,Ce){return se===null||se.tag!==6?(se=Qd(ce,oe.mode,Ce),se.return=oe,se):(se=y(se,ce),se.return=oe,se)}function ne(oe,se,ce,Ce){var Oe=ce.type;return Oe===E?Se(oe,se,ce.props.children,Ce,ce.key):se!==null&&(se.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===W&&Lx(Oe)===se.type)?(se=y(se,ce.props),jl(se,ce),se.return=oe,se):(se=Tu(ce.type,ce.key,ce.props,null,oe.mode,Ce),jl(se,ce),se.return=oe,se)}function fe(oe,se,ce,Ce){return se===null||se.tag!==4||se.stateNode.containerInfo!==ce.containerInfo||se.stateNode.implementation!==ce.implementation?(se=e0(ce,oe.mode,Ce),se.return=oe,se):(se=y(se,ce.children||[]),se.return=oe,se)}function Se(oe,se,ce,Ce,Oe){return se===null||se.tag!==7?(se=Ki(ce,oe.mode,Ce,Oe),se.return=oe,se):(se=y(se,ce),se.return=oe,se)}function be(oe,se,ce){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Qd(""+se,oe.mode,ce),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _:return ce=Tu(se.type,se.key,se.props,null,oe.mode,ce),jl(ce,se),ce.return=oe,ce;case T:return se=e0(se,oe.mode,ce),se.return=oe,se;case W:var Ce=se._init;return se=Ce(se._payload),be(oe,se,ce)}if(we(se)||ee(se))return se=Ki(se,oe.mode,ce,null),se.return=oe,se;if(typeof se.then=="function")return be(oe,Bu(se),ce);if(se.$$typeof===b)return be(oe,bu(oe,se),ce);ju(oe,se)}return null}function ge(oe,se,ce,Ce){var Oe=se!==null?se.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Oe!==null?null:L(oe,se,""+ce,Ce);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return ce.key===Oe?ne(oe,se,ce,Ce):null;case T:return ce.key===Oe?fe(oe,se,ce,Ce):null;case W:return Oe=ce._init,ce=Oe(ce._payload),ge(oe,se,ce,Ce)}if(we(ce)||ee(ce))return Oe!==null?null:Se(oe,se,ce,Ce,null);if(typeof ce.then=="function")return ge(oe,se,Bu(ce),Ce);if(ce.$$typeof===b)return ge(oe,se,bu(oe,ce),Ce);ju(oe,ce)}return null}function xe(oe,se,ce,Ce,Oe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return oe=oe.get(ce)||null,L(se,oe,""+Ce,Oe);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case _:return oe=oe.get(Ce.key===null?ce:Ce.key)||null,ne(se,oe,Ce,Oe);case T:return oe=oe.get(Ce.key===null?ce:Ce.key)||null,fe(se,oe,Ce,Oe);case W:var ft=Ce._init;return Ce=ft(Ce._payload),xe(oe,se,ce,Ce,Oe)}if(we(Ce)||ee(Ce))return oe=oe.get(ce)||null,Se(se,oe,Ce,Oe,null);if(typeof Ce.then=="function")return xe(oe,se,ce,Bu(Ce),Oe);if(Ce.$$typeof===b)return xe(oe,se,ce,bu(se,Ce),Oe);ju(se,Ce)}return null}function Je(oe,se,ce,Ce){for(var Oe=null,ft=null,He=se,We=se=0,Cn=null;He!==null&&We<ce.length;We++){He.index>We?(Cn=He,He=null):Cn=He.sibling;var Et=ge(oe,He,ce[We],Ce);if(Et===null){He===null&&(He=Cn);break}i&&He&&Et.alternate===null&&o(oe,He),se=w(Et,se,We),ft===null?Oe=Et:ft.sibling=Et,ft=Et,He=Cn}if(We===ce.length)return u(oe,He),bt&&Zi(oe,We),Oe;if(He===null){for(;We<ce.length;We++)He=be(oe,ce[We],Ce),He!==null&&(se=w(He,se,We),ft===null?Oe=He:ft.sibling=He,ft=He);return bt&&Zi(oe,We),Oe}for(He=p(He);We<ce.length;We++)Cn=xe(He,oe,We,ce[We],Ce),Cn!==null&&(i&&Cn.alternate!==null&&He.delete(Cn.key===null?We:Cn.key),se=w(Cn,se,We),ft===null?Oe=Cn:ft.sibling=Cn,ft=Cn);return i&&He.forEach(function(Si){return o(oe,Si)}),bt&&Zi(oe,We),Oe}function Ye(oe,se,ce,Ce){if(ce==null)throw Error(r(151));for(var Oe=null,ft=null,He=se,We=se=0,Cn=null,Et=ce.next();He!==null&&!Et.done;We++,Et=ce.next()){He.index>We?(Cn=He,He=null):Cn=He.sibling;var Si=ge(oe,He,Et.value,Ce);if(Si===null){He===null&&(He=Cn);break}i&&He&&Si.alternate===null&&o(oe,He),se=w(Si,se,We),ft===null?Oe=Si:ft.sibling=Si,ft=Si,He=Cn}if(Et.done)return u(oe,He),bt&&Zi(oe,We),Oe;if(He===null){for(;!Et.done;We++,Et=ce.next())Et=be(oe,Et.value,Ce),Et!==null&&(se=w(Et,se,We),ft===null?Oe=Et:ft.sibling=Et,ft=Et);return bt&&Zi(oe,We),Oe}for(He=p(He);!Et.done;We++,Et=ce.next())Et=xe(He,oe,We,Et.value,Ce),Et!==null&&(i&&Et.alternate!==null&&He.delete(Et.key===null?We:Et.key),se=w(Et,se,We),ft===null?Oe=Et:ft.sibling=Et,ft=Et);return i&&He.forEach(function(Mb){return o(oe,Mb)}),bt&&Zi(oe,We),Oe}function Ot(oe,se,ce,Ce){if(typeof ce=="object"&&ce!==null&&ce.type===E&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:e:{for(var Oe=ce.key;se!==null;){if(se.key===Oe){if(Oe=ce.type,Oe===E){if(se.tag===7){u(oe,se.sibling),Ce=y(se,ce.props.children),Ce.return=oe,oe=Ce;break e}}else if(se.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===W&&Lx(Oe)===se.type){u(oe,se.sibling),Ce=y(se,ce.props),jl(Ce,ce),Ce.return=oe,oe=Ce;break e}u(oe,se);break}else o(oe,se);se=se.sibling}ce.type===E?(Ce=Ki(ce.props.children,oe.mode,Ce,ce.key),Ce.return=oe,oe=Ce):(Ce=Tu(ce.type,ce.key,ce.props,null,oe.mode,Ce),jl(Ce,ce),Ce.return=oe,oe=Ce)}return N(oe);case T:e:{for(Oe=ce.key;se!==null;){if(se.key===Oe)if(se.tag===4&&se.stateNode.containerInfo===ce.containerInfo&&se.stateNode.implementation===ce.implementation){u(oe,se.sibling),Ce=y(se,ce.children||[]),Ce.return=oe,oe=Ce;break e}else{u(oe,se);break}else o(oe,se);se=se.sibling}Ce=e0(ce,oe.mode,Ce),Ce.return=oe,oe=Ce}return N(oe);case W:return Oe=ce._init,ce=Oe(ce._payload),Ot(oe,se,ce,Ce)}if(we(ce))return Je(oe,se,ce,Ce);if(ee(ce)){if(Oe=ee(ce),typeof Oe!="function")throw Error(r(150));return ce=Oe.call(ce),Ye(oe,se,ce,Ce)}if(typeof ce.then=="function")return Ot(oe,se,Bu(ce),Ce);if(ce.$$typeof===b)return Ot(oe,se,bu(oe,ce),Ce);ju(oe,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,se!==null&&se.tag===6?(u(oe,se.sibling),Ce=y(se,ce),Ce.return=oe,oe=Ce):(u(oe,se),Ce=Qd(ce,oe.mode,Ce),Ce.return=oe,oe=Ce),N(oe)):u(oe,se)}return function(oe,se,ce,Ce){try{Bl=0;var Oe=Ot(oe,se,ce,Ce);return lo=null,Oe}catch(He){if(He===Rl||He===ku)throw He;var ft=pr(29,He,null,oe.mode);return ft.lanes=Ce,ft.return=oe,ft}finally{}}}var co=Px(!0),Ox=Px(!1),Ir=Q(null),ca=null;function ci(i){var o=i.alternate;X(vn,vn.current&1),X(Ir,i),ca===null&&(o===null||ao.current!==null||o.memoizedState!==null)&&(ca=i)}function Ux(i){if(i.tag===22){if(X(vn,vn.current),X(Ir,i),ca===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(ca=i)}}else ui()}function ui(){X(vn,vn.current),X(Ir,Ir.current)}function La(i){I(Ir),ca===i&&(ca=null),I(vn)}var vn=Q(0);function Vu(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Th(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function I0(i,o,u,p){o=i.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var F0={enqueueSetState:function(i,o,u){i=i._reactInternals;var p=yr(),y=si(p);y.payload=o,u!=null&&(y.callback=u),o=oi(i,y,p),o!==null&&(_r(o,i,p),Dl(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var p=yr(),y=si(p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=oi(i,y,p),o!==null&&(_r(o,i,p),Dl(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=yr(),p=si(u);p.tag=2,o!=null&&(p.callback=o),o=oi(i,p,u),o!==null&&(_r(o,i,u),Dl(o,i,u))}};function Bx(i,o,u,p,y,w,N){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,N):o.prototype&&o.prototype.isPureReactComponent?!Tl(u,p)||!Tl(y,w):!0}function jx(i,o,u,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==i&&F0.enqueueReplaceState(o,o.state,null)}function is(i,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(i=i.defaultProps){u===o&&(u=g({},u));for(var y in i)u[y]===void 0&&(u[y]=i[y])}return u}var Hu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Vx(i){Hu(i)}function Hx(i){console.error(i)}function $x(i){Hu(i)}function $u(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function Gx(i,o,u){try{var p=i.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function L0(i,o,u){return u=si(u),u.tag=3,u.payload={element:null},u.callback=function(){$u(i,o)},u}function zx(i){return i=si(i),i.tag=3,i}function qx(i,o,u,p){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var w=p.value;i.payload=function(){return y(w)},i.callback=function(){Gx(o,u,p)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(i.callback=function(){Gx(o,u,p),typeof y!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var L=p.stack;this.componentDidCatch(p.value,{componentStack:L!==null?L:""})})}function MC(i,o,u,p,y){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Al(o,u,y,!0),u=Ir.current,u!==null){switch(u.tag){case 13:return ca===null?ih():u.alternate===null&&Xt===0&&(Xt=3),u.flags&=-257,u.flags|=65536,u.lanes=y,p===u0?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),oh(i,p,y)),!1;case 22:return u.flags|=65536,p===u0?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),oh(i,p,y)),!1}throw Error(r(435,u.tag))}return oh(i,p,y),ih(),!1}if(bt)return o=Ir.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,p!==r0&&(i=Error(r(422),{cause:p}),bl(Nr(i,u)))):(p!==r0&&(o=Error(r(423),{cause:p}),bl(Nr(o,u))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,p=Nr(p,u),y=L0(i.stateNode,p,y),h0(i,y),Xt!==4&&(Xt=2)),!1;var w=Error(r(520),{cause:p});if(w=Nr(w,u),Yl===null?Yl=[w]:Yl.push(w),Xt!==4&&(Xt=2),o===null)return!0;p=Nr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=y&-y,u.lanes|=i,i=L0(u.stateNode,p,i),h0(u,i),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(gi===null||!gi.has(w))))return u.flags|=65536,y&=-y,u.lanes|=y,y=zx(y),qx(y,i,u,p),h0(u,y),!1}u=u.return}while(u!==null);return!1}var Yx=Error(r(461)),En=!1;function Rn(i,o,u,p){o.child=i===null?Ox(o,null,u,p):co(o,i.child,u,p)}function Wx(i,o,u,p,y){u=u.render;var w=o.ref;if("ref"in p){var N={};for(var L in p)L!=="ref"&&(N[L]=p[L])}else N=p;return ns(o),p=v0(i,o,u,N,w,y),L=y0(),i!==null&&!En?(_0(i,o,y),Pa(i,o,y)):(bt&&L&&t0(o),o.flags|=1,Rn(i,o,p,y),o.child)}function Jx(i,o,u,p,y){if(i===null){var w=u.type;return typeof w=="function"&&!Zd(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,Kx(i,o,w,p,y)):(i=Tu(u.type,null,p,o,o.mode,y),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,!$0(i,y)){var N=w.memoizedProps;if(u=u.compare,u=u!==null?u:Tl,u(N,p)&&i.ref===o.ref)return Pa(i,o,y)}return o.flags|=1,i=Na(w,p),i.ref=o.ref,i.return=o,o.child=i}function Kx(i,o,u,p,y){if(i!==null){var w=i.memoizedProps;if(Tl(w,p)&&i.ref===o.ref)if(En=!1,o.pendingProps=p=w,$0(i,y))(i.flags&131072)!==0&&(En=!0);else return o.lanes=i.lanes,Pa(i,o,y)}return P0(i,o,u,p,y)}function Xx(i,o,u){var p=o.pendingProps,y=p.children,w=i!==null?i.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=w!==null?w.baseLanes|u:u,i!==null){for(y=o.child=i.child,w=0;y!==null;)w=w|y.lanes|y.childLanes,y=y.sibling;o.childLanes=w&~p}else o.childLanes=0,o.child=null;return Zx(i,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Au(o,w!==null?w.cachePool:null),w!==null?Kg(o,w):p0(),Ux(o);else return o.lanes=o.childLanes=536870912,Zx(i,o,w!==null?w.baseLanes|u:u,u)}else w!==null?(Au(o,w.cachePool),Kg(o,w),ui(),o.memoizedState=null):(i!==null&&Au(o,null),p0(),ui());return Rn(i,o,y,u),o.child}function Zx(i,o,u,p){var y=c0();return y=y===null?null:{parent:xn._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},i!==null&&Au(o,null),p0(),Ux(o),i!==null&&Al(i,o,p,!0),null}function Gu(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function P0(i,o,u,p,y){return ns(o),u=v0(i,o,u,p,void 0,y),p=y0(),i!==null&&!En?(_0(i,o,y),Pa(i,o,y)):(bt&&p&&t0(o),o.flags|=1,Rn(i,o,u,y),o.child)}function Qx(i,o,u,p,y,w){return ns(o),o.updateQueue=null,u=Zg(o,p,u,y),Xg(i),p=y0(),i!==null&&!En?(_0(i,o,w),Pa(i,o,w)):(bt&&p&&t0(o),o.flags|=1,Rn(i,o,u,w),o.child)}function ev(i,o,u,p,y){if(ns(o),o.stateNode===null){var w=Qs,N=u.contextType;typeof N=="object"&&N!==null&&(w=On(N)),w=new u(p,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=F0,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=p,w.state=o.memoizedState,w.refs={},f0(o),N=u.contextType,w.context=typeof N=="object"&&N!==null?On(N):Qs,w.state=o.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(I0(o,u,N,p),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&F0.enqueueReplaceState(w,w.state,null),Fl(o,p,w,y),Il(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){w=o.stateNode;var L=o.memoizedProps,ne=is(u,L);w.props=ne;var fe=w.context,Se=u.contextType;N=Qs,typeof Se=="object"&&Se!==null&&(N=On(Se));var be=u.getDerivedStateFromProps;Se=typeof be=="function"||typeof w.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,Se||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(L||fe!==N)&&jx(o,w,p,N),ii=!1;var ge=o.memoizedState;w.state=ge,Fl(o,p,w,y),Il(),fe=o.memoizedState,L||ge!==fe||ii?(typeof be=="function"&&(I0(o,u,be,p),fe=o.memoizedState),(ne=ii||Bx(o,u,ne,p,ge,fe,N))?(Se||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=fe),w.props=p,w.state=fe,w.context=N,p=ne):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{w=o.stateNode,d0(i,o),N=o.memoizedProps,Se=is(u,N),w.props=Se,be=o.pendingProps,ge=w.context,fe=u.contextType,ne=Qs,typeof fe=="object"&&fe!==null&&(ne=On(fe)),L=u.getDerivedStateFromProps,(fe=typeof L=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==be||ge!==ne)&&jx(o,w,p,ne),ii=!1,ge=o.memoizedState,w.state=ge,Fl(o,p,w,y),Il();var xe=o.memoizedState;N!==be||ge!==xe||ii||i!==null&&i.dependencies!==null&&Cu(i.dependencies)?(typeof L=="function"&&(I0(o,u,L,p),xe=o.memoizedState),(Se=ii||Bx(o,u,Se,p,ge,xe,ne)||i!==null&&i.dependencies!==null&&Cu(i.dependencies))?(fe||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(p,xe,ne),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(p,xe,ne)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===i.memoizedProps&&ge===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===i.memoizedProps&&ge===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=xe),w.props=p,w.state=xe,w.context=ne,p=Se):(typeof w.componentDidUpdate!="function"||N===i.memoizedProps&&ge===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===i.memoizedProps&&ge===i.memoizedState||(o.flags|=1024),p=!1)}return w=p,Gu(i,o),p=(o.flags&128)!==0,w||p?(w=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,i!==null&&p?(o.child=co(o,i.child,null,y),o.child=co(o,null,u,y)):Rn(i,o,u,y),o.memoizedState=w.state,i=o.child):i=Pa(i,o,y),i}function tv(i,o,u,p){return Cl(),o.flags|=256,Rn(i,o,u,p),o.child}var O0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function U0(i){return{baseLanes:i,cachePool:Hg()}}function B0(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=Fr),i}function nv(i,o,u){var p=o.pendingProps,y=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=i!==null&&i.memoizedState===null?!1:(vn.current&2)!==0),N&&(y=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,i===null){if(bt){if(y?ci(o):ui(),bt){var L=Kt,ne;if(ne=L){e:{for(ne=L,L=la;ne.nodeType!==8;){if(!L){L=null;break e}if(ne=Wr(ne.nextSibling),ne===null){L=null;break e}}L=ne}L!==null?(o.memoizedState={dehydrated:L,treeContext:Xi!==null?{id:Ra,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},ne=pr(18,null,null,0),ne.stateNode=L,ne.return=o,o.child=ne,Kn=o,Kt=null,ne=!0):ne=!1}ne||es(o)}if(L=o.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return Th(L)?o.lanes=32:o.lanes=536870912,null;La(o)}return L=p.children,p=p.fallback,y?(ui(),y=o.mode,L=zu({mode:"hidden",children:L},y),p=Ki(p,y,u,null),L.return=o,p.return=o,L.sibling=p,o.child=L,y=o.child,y.memoizedState=U0(u),y.childLanes=B0(i,N,u),o.memoizedState=O0,p):(ci(o),j0(o,L))}if(ne=i.memoizedState,ne!==null&&(L=ne.dehydrated,L!==null)){if(w)o.flags&256?(ci(o),o.flags&=-257,o=V0(i,o,u)):o.memoizedState!==null?(ui(),o.child=i.child,o.flags|=128,o=null):(ui(),y=p.fallback,L=o.mode,p=zu({mode:"visible",children:p.children},L),y=Ki(y,L,u,null),y.flags|=2,p.return=o,y.return=o,p.sibling=y,o.child=p,co(o,i.child,null,u),p=o.child,p.memoizedState=U0(u),p.childLanes=B0(i,N,u),o.memoizedState=O0,o=y);else if(ci(o),Th(L)){if(N=L.nextSibling&&L.nextSibling.dataset,N)var fe=N.dgst;N=fe,p=Error(r(419)),p.stack="",p.digest=N,bl({value:p,source:null,stack:null}),o=V0(i,o,u)}else if(En||Al(i,o,u,!1),N=(u&i.childLanes)!==0,En||N){if(N=Bt,N!==null&&(p=u&-u,p=(p&42)!==0?1:Gi(p),p=(p&(N.suspendedLanes|u))!==0?0:p,p!==0&&p!==ne.retryLane))throw ne.retryLane=p,Zs(i,p),_r(N,i,p),Yx;L.data==="$?"||ih(),o=V0(i,o,u)}else L.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=ne.treeContext,Kt=Wr(L.nextSibling),Kn=o,bt=!0,Qi=null,la=!1,i!==null&&(Mr[Dr++]=Ra,Mr[Dr++]=Ma,Mr[Dr++]=Xi,Ra=i.id,Ma=i.overflow,Xi=o),o=j0(o,p.children),o.flags|=4096);return o}return y?(ui(),y=p.fallback,L=o.mode,ne=i.child,fe=ne.sibling,p=Na(ne,{mode:"hidden",children:p.children}),p.subtreeFlags=ne.subtreeFlags&65011712,fe!==null?y=Na(fe,y):(y=Ki(y,L,u,null),y.flags|=2),y.return=o,p.return=o,p.sibling=y,o.child=p,p=y,y=o.child,L=i.child.memoizedState,L===null?L=U0(u):(ne=L.cachePool,ne!==null?(fe=xn._currentValue,ne=ne.parent!==fe?{parent:fe,pool:fe}:ne):ne=Hg(),L={baseLanes:L.baseLanes|u,cachePool:ne}),y.memoizedState=L,y.childLanes=B0(i,N,u),o.memoizedState=O0,p):(ci(o),u=i.child,i=u.sibling,u=Na(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,i!==null&&(N=o.deletions,N===null?(o.deletions=[i],o.flags|=16):N.push(i)),o.child=u,o.memoizedState=null,u)}function j0(i,o){return o=zu({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function zu(i,o){return i=pr(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function V0(i,o,u){return co(o,i.child,null,u),i=j0(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function rv(i,o,u){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),i0(i.return,o,u)}function H0(i,o,u,p,y){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:y}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=u,w.tailMode=y)}function av(i,o,u){var p=o.pendingProps,y=p.revealOrder,w=p.tail;if(Rn(i,o,p.children,u),p=vn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&rv(i,u,o);else if(i.tag===19)rv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(X(vn,p),y){case"forwards":for(u=o.child,y=null;u!==null;)i=u.alternate,i!==null&&Vu(i)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),H0(o,!1,y,u,w);break;case"backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(i=y.alternate,i!==null&&Vu(i)===null){o.child=y;break}i=y.sibling,y.sibling=u,u=y,y=i}H0(o,!0,u,null,w);break;case"together":H0(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Pa(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),pi|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(Al(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=Na(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Na(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function $0(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&Cu(i)))}function DC(i,o,u){switch(o.tag){case 3:ve(o,o.stateNode.containerInfo),ai(o,xn,i.memoizedState.cache),Cl();break;case 27:case 5:_e(o);break;case 4:ve(o,o.stateNode.containerInfo);break;case 10:ai(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(ci(o),o.flags|=128,null):(u&o.child.childLanes)!==0?nv(i,o,u):(ci(o),i=Pa(i,o,u),i!==null?i.sibling:null);ci(o);break;case 19:var y=(i.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Al(i,o,u,!1),p=(u&o.childLanes)!==0),y){if(p)return av(i,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),X(vn,vn.current),p)break;return null;case 22:case 23:return o.lanes=0,Xx(i,o,u);case 24:ai(o,xn,i.memoizedState.cache)}return Pa(i,o,u)}function iv(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)En=!0;else{if(!$0(i,u)&&(o.flags&128)===0)return En=!1,DC(i,o,u);En=(i.flags&131072)!==0}else En=!1,bt&&(o.flags&1048576)!==0&&Lg(o,Su,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var p=o.elementType,y=p._init;if(p=y(p._payload),o.type=p,typeof p=="function")Zd(p)?(i=is(p,i),o.tag=1,o=ev(null,o,p,i,u)):(o.tag=0,o=P0(null,o,p,i,u));else{if(p!=null){if(y=p.$$typeof,y===D){o.tag=11,o=Wx(null,o,p,i,u);break e}else if(y===F){o.tag=14,o=Jx(null,o,p,i,u);break e}}throw o=Ae(p)||p,Error(r(306,o,""))}}return o;case 0:return P0(i,o,o.type,o.pendingProps,u);case 1:return p=o.type,y=is(p,o.pendingProps),ev(i,o,p,y,u);case 3:e:{if(ve(o,o.stateNode.containerInfo),i===null)throw Error(r(387));p=o.pendingProps;var w=o.memoizedState;y=w.element,d0(i,o),Fl(o,p,null,u);var N=o.memoizedState;if(p=N.cache,ai(o,xn,p),p!==w.cache&&s0(o,[xn],u,!0),Il(),p=N.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=tv(i,o,p,u);break e}else if(p!==y){y=Nr(Error(r(424)),o),bl(y),o=tv(i,o,p,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Kt=Wr(i.firstChild),Kn=o,bt=!0,Qi=null,la=!0,u=Ox(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Cl(),p===y){o=Pa(i,o,u);break e}Rn(i,o,p,u)}o=o.child}return o;case 26:return Gu(i,o),i===null?(u=c1(o.type,null,o.pendingProps,null))?o.memoizedState=u:bt||(u=o.type,i=o.pendingProps,p=sf(te.current).createElement(u),p[on]=o,p[ln]=i,Dn(p,u,i),le(p),o.stateNode=p):o.memoizedState=c1(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return _e(o),i===null&&bt&&(p=o.stateNode=s1(o.type,o.pendingProps,te.current),Kn=o,la=!0,y=Kt,yi(o.type)?(Eh=y,Kt=Wr(p.firstChild)):Kt=y),Rn(i,o,o.pendingProps.children,u),Gu(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&bt&&((y=p=Kt)&&(p=sb(p,o.type,o.pendingProps,la),p!==null?(o.stateNode=p,Kn=o,Kt=Wr(p.firstChild),la=!1,y=!0):y=!1),y||es(o)),_e(o),y=o.type,w=o.pendingProps,N=i!==null?i.memoizedProps:null,p=w.children,yh(y,w)?p=null:N!==null&&yh(y,N)&&(o.flags|=32),o.memoizedState!==null&&(y=v0(i,o,SC,null,null,u),nc._currentValue=y),Gu(i,o),Rn(i,o,p,u),o.child;case 6:return i===null&&bt&&((i=u=Kt)&&(u=ob(u,o.pendingProps,la),u!==null?(o.stateNode=u,Kn=o,Kt=null,i=!0):i=!1),i||es(o)),null;case 13:return nv(i,o,u);case 4:return ve(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=co(o,null,p,u):Rn(i,o,p,u),o.child;case 11:return Wx(i,o,o.type,o.pendingProps,u);case 7:return Rn(i,o,o.pendingProps,u),o.child;case 8:return Rn(i,o,o.pendingProps.children,u),o.child;case 12:return Rn(i,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,ai(o,o.type,p.value),Rn(i,o,p.children,u),o.child;case 9:return y=o.type._context,p=o.pendingProps.children,ns(o),y=On(y),p=p(y),o.flags|=1,Rn(i,o,p,u),o.child;case 14:return Jx(i,o,o.type,o.pendingProps,u);case 15:return Kx(i,o,o.type,o.pendingProps,u);case 19:return av(i,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},i===null?(u=zu(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Na(i.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return Xx(i,o,u);case 24:return ns(o),p=On(xn),i===null?(y=c0(),y===null&&(y=Bt,w=o0(),y.pooledCache=w,w.refCount++,w!==null&&(y.pooledCacheLanes|=u),y=w),o.memoizedState={parent:p,cache:y},f0(o),ai(o,xn,y)):((i.lanes&u)!==0&&(d0(i,o),Fl(o,null,null,u),Il()),y=i.memoizedState,w=o.memoizedState,y.parent!==p?(y={parent:p,cache:p},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),ai(o,xn,p)):(p=w.cache,ai(o,xn,p),p!==y.cache&&s0(o,[xn],u,!0))),Rn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Oa(i){i.flags|=4}function sv(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!m1(o)){if(o=Ir.current,o!==null&&((vt&4194048)===vt?ca!==null:(vt&62914560)!==vt&&(vt&536870912)===0||o!==ca))throw Ml=u0,$g;i.flags|=8192}}function qu(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Hi():536870912,i.lanes|=o,mo|=o)}function Vl(i,o){if(!bt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Yt(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,p=0;if(o)for(var y=i.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=p,i.childLanes=u,o}function IC(i,o,u){var p=o.pendingProps;switch(n0(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(o),null;case 1:return Yt(o),null;case 3:return u=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Ia(xn),ye(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(Sl(o)?Oa(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ug())),Yt(o),null;case 26:return u=o.memoizedState,i===null?(Oa(o),u!==null?(Yt(o),sv(o,u)):(Yt(o),o.flags&=-16777217)):u?u!==i.memoizedState?(Oa(o),Yt(o),sv(o,u)):(Yt(o),o.flags&=-16777217):(i.memoizedProps!==p&&Oa(o),Yt(o),o.flags&=-16777217),null;case 27:$e(o),u=te.current;var y=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Oa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return Yt(o),null}i=K.current,Sl(o)?Pg(o):(i=s1(y,p,u),o.stateNode=i,Oa(o))}return Yt(o),null;case 5:if($e(o),u=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Oa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return Yt(o),null}if(i=K.current,Sl(o))Pg(o);else{switch(y=sf(te.current),i){case 1:i=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:i=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":i=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":i=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":i=y.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?y.createElement(u,{is:p.is}):y.createElement(u)}}i[on]=o,i[ln]=p;e:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)i.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break e;for(;y.sibling===null;){if(y.return===null||y.return===o)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=i;e:switch(Dn(i,u,p),u){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Oa(o)}}return Yt(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&Oa(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(i=te.current,Sl(o)){if(i=o.stateNode,u=o.memoizedProps,p=null,y=Kn,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}i[on]=o,i=!!(i.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||Qv(i.nodeValue,u)),i||es(o)}else i=sf(i).createTextNode(p),i[on]=o,o.stateNode=i}return Yt(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Sl(o),p!==null&&p.dehydrated!==null){if(i===null){if(!y)throw Error(r(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[on]=o}else Cl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Yt(o),y=!1}else y=Ug(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(La(o),o):(La(o),null)}if(La(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,i=i!==null&&i.memoizedState!==null,u){p=o.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var w=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==y&&(p.flags|=2048)}return u!==i&&u&&(o.child.flags|=8192),qu(o,o.updateQueue),Yt(o),null;case 4:return ye(),i===null&&mh(o.stateNode.containerInfo),Yt(o),null;case 10:return Ia(o.type),Yt(o),null;case 19:if(I(vn),y=o.memoizedState,y===null)return Yt(o),null;if(p=(o.flags&128)!==0,w=y.rendering,w===null)if(p)Vl(y,!1);else{if(Xt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(w=Vu(i),w!==null){for(o.flags|=128,Vl(y,!1),i=w.updateQueue,o.updateQueue=i,qu(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)Fg(u,i),u=u.sibling;return X(vn,vn.current&1|2),o.child}i=i.sibling}y.tail!==null&&Me()>Ju&&(o.flags|=128,p=!0,Vl(y,!1),o.lanes=4194304)}else{if(!p)if(i=Vu(w),i!==null){if(o.flags|=128,p=!0,i=i.updateQueue,o.updateQueue=i,qu(o,i),Vl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!w.alternate&&!bt)return Yt(o),null}else 2*Me()-y.renderingStartTime>Ju&&u!==536870912&&(o.flags|=128,p=!0,Vl(y,!1),o.lanes=4194304);y.isBackwards?(w.sibling=o.child,o.child=w):(i=y.last,i!==null?i.sibling=w:o.child=w,y.last=w)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Me(),o.sibling=null,i=vn.current,X(vn,p?i&1|2:i&1),o):(Yt(o),null);case 22:case 23:return La(o),g0(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(Yt(o),o.subtreeFlags&6&&(o.flags|=8192)):Yt(o),u=o.updateQueue,u!==null&&qu(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),i!==null&&I(rs),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ia(xn),Yt(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function FC(i,o){switch(n0(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Ia(xn),ye(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return $e(o),null;case 13:if(La(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Cl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return I(vn),null;case 4:return ye(),null;case 10:return Ia(o.type),null;case 22:case 23:return La(o),g0(),i!==null&&I(rs),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return Ia(xn),null;case 25:return null;default:return null}}function ov(i,o){switch(n0(o),o.tag){case 3:Ia(xn),ye();break;case 26:case 27:case 5:$e(o);break;case 4:ye();break;case 13:La(o);break;case 19:I(vn);break;case 10:Ia(o.type);break;case 22:case 23:La(o),g0(),i!==null&&I(rs);break;case 24:Ia(xn)}}function Hl(i,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&i)===i){p=void 0;var w=u.create,N=u.inst;p=w(),N.destroy=p}u=u.next}while(u!==y)}}catch(L){Ut(o,o.return,L)}}function fi(i,o,u){try{var p=o.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var w=y.next;p=w;do{if((p.tag&i)===i){var N=p.inst,L=N.destroy;if(L!==void 0){N.destroy=void 0,y=o;var ne=u,fe=L;try{fe()}catch(Se){Ut(y,ne,Se)}}}p=p.next}while(p!==w)}}catch(Se){Ut(o,o.return,Se)}}function lv(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{Jg(o,u)}catch(p){Ut(i,i.return,p)}}}function cv(i,o,u){u.props=is(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(p){Ut(i,o,p)}}function $l(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof u=="function"?i.refCleanup=u(p):u.current=p}}catch(y){Ut(i,o,y)}}function ua(i,o){var u=i.ref,p=i.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(y){Ut(i,o,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Ut(i,o,y)}else u.current=null}function uv(i){var o=i.type,u=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(y){Ut(i,i.return,y)}}function G0(i,o,u){try{var p=i.stateNode;tb(p,i.type,u,o),p[ln]=o}catch(y){Ut(i,i.return,y)}}function fv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&yi(i.type)||i.tag===4}function z0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||fv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&yi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function q0(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=af));else if(p!==4&&(p===27&&yi(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(q0(i,o,u),i=i.sibling;i!==null;)q0(i,o,u),i=i.sibling}function Yu(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(p!==4&&(p===27&&yi(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Yu(i,o,u),i=i.sibling;i!==null;)Yu(i,o,u),i=i.sibling}function dv(i){var o=i.stateNode,u=i.memoizedProps;try{for(var p=i.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);Dn(o,p,u),o[on]=i,o[ln]=u}catch(w){Ut(i,i.return,w)}}var Ua=!1,rn=!1,Y0=!1,hv=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function LC(i,o){if(i=i.containerInfo,xh=df,i=Sg(i),zd(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var y=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var N=0,L=-1,ne=-1,fe=0,Se=0,be=i,ge=null;t:for(;;){for(var xe;be!==u||y!==0&&be.nodeType!==3||(L=N+y),be!==w||p!==0&&be.nodeType!==3||(ne=N+p),be.nodeType===3&&(N+=be.nodeValue.length),(xe=be.firstChild)!==null;)ge=be,be=xe;for(;;){if(be===i)break t;if(ge===u&&++fe===y&&(L=N),ge===w&&++Se===p&&(ne=N),(xe=be.nextSibling)!==null)break;be=ge,ge=be.parentNode}be=xe}u=L===-1||ne===-1?null:{start:L,end:ne}}else u=null}u=u||{start:0,end:0}}else u=null;for(vh={focusedElem:i,selectionRange:u},df=!1,Sn=o;Sn!==null;)if(o=Sn,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,Sn=i;else for(;Sn!==null;){switch(o=Sn,w=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&w!==null){i=void 0,u=o,y=w.memoizedProps,w=w.memoizedState,p=u.stateNode;try{var Je=is(u.type,y,u.elementType===u.type);i=p.getSnapshotBeforeUpdate(Je,w),p.__reactInternalSnapshotBeforeUpdate=i}catch(Ye){Ut(u,u.return,Ye)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)wh(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":wh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,Sn=i;break}Sn=o.return}}function mv(i,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:di(i,u),p&4&&Hl(5,u);break;case 1:if(di(i,u),p&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(N){Ut(u,u.return,N)}else{var y=is(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(y,o,i.__reactInternalSnapshotBeforeUpdate)}catch(N){Ut(u,u.return,N)}}p&64&&lv(u),p&512&&$l(u,u.return);break;case 3:if(di(i,u),p&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Jg(i,o)}catch(N){Ut(u,u.return,N)}}break;case 27:o===null&&p&4&&dv(u);case 26:case 5:di(i,u),o===null&&p&4&&uv(u),p&512&&$l(u,u.return);break;case 12:di(i,u);break;case 13:di(i,u),p&4&&xv(i,u),p&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=GC.bind(null,u),lb(i,u))));break;case 22:if(p=u.memoizedState!==null||Ua,!p){o=o!==null&&o.memoizedState!==null||rn,y=Ua;var w=rn;Ua=p,(rn=o)&&!w?hi(i,u,(u.subtreeFlags&8772)!==0):di(i,u),Ua=y,rn=w}break;case 30:break;default:di(i,u)}}function pv(i){var o=i.alternate;o!==null&&(i.alternate=null,pv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&V(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Gt=null,sr=!1;function Ba(i,o,u){for(u=u.child;u!==null;)gv(i,o,u),u=u.sibling}function gv(i,o,u){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(gn,u)}catch{}switch(u.tag){case 26:rn||ua(u,o),Ba(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:rn||ua(u,o);var p=Gt,y=sr;yi(u.type)&&(Gt=u.stateNode,sr=!1),Ba(i,o,u),Zl(u.stateNode),Gt=p,sr=y;break;case 5:rn||ua(u,o);case 6:if(p=Gt,y=sr,Gt=null,Ba(i,o,u),Gt=p,sr=y,Gt!==null)if(sr)try{(Gt.nodeType===9?Gt.body:Gt.nodeName==="HTML"?Gt.ownerDocument.body:Gt).removeChild(u.stateNode)}catch(w){Ut(u,o,w)}else try{Gt.removeChild(u.stateNode)}catch(w){Ut(u,o,w)}break;case 18:Gt!==null&&(sr?(i=Gt,a1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),sc(i)):a1(Gt,u.stateNode));break;case 4:p=Gt,y=sr,Gt=u.stateNode.containerInfo,sr=!0,Ba(i,o,u),Gt=p,sr=y;break;case 0:case 11:case 14:case 15:rn||fi(2,u,o),rn||fi(4,u,o),Ba(i,o,u);break;case 1:rn||(ua(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&cv(u,o,p)),Ba(i,o,u);break;case 21:Ba(i,o,u);break;case 22:rn=(p=rn)||u.memoizedState!==null,Ba(i,o,u),rn=p;break;default:Ba(i,o,u)}}function xv(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{sc(i)}catch(u){Ut(o,o.return,u)}}function PC(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new hv),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new hv),o;default:throw Error(r(435,i.tag))}}function W0(i,o){var u=PC(i);o.forEach(function(p){var y=zC.bind(null,i,p);u.has(p)||(u.add(p),p.then(y,y))})}function gr(i,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var y=u[p],w=i,N=o,L=N;e:for(;L!==null;){switch(L.tag){case 27:if(yi(L.type)){Gt=L.stateNode,sr=!1;break e}break;case 5:Gt=L.stateNode,sr=!1;break e;case 3:case 4:Gt=L.stateNode.containerInfo,sr=!0;break e}L=L.return}if(Gt===null)throw Error(r(160));gv(w,N,y),Gt=null,sr=!1,w=y.alternate,w!==null&&(w.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)vv(o,i),o=o.sibling}var Yr=null;function vv(i,o){var u=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:gr(o,i),xr(i),p&4&&(fi(3,i,i.return),Hl(3,i),fi(5,i,i.return));break;case 1:gr(o,i),xr(i),p&512&&(rn||u===null||ua(u,u.return)),p&64&&Ua&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var y=Yr;if(gr(o,i),xr(i),p&512&&(rn||u===null||ua(u,u.return)),p&4){var w=u!==null?u.memoizedState:null;if(p=i.memoizedState,u===null)if(p===null)if(i.stateNode===null){e:{p=i.type,u=i.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":w=y.getElementsByTagName("title")[0],(!w||w[O]||w[on]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=y.createElement(p),y.head.insertBefore(w,y.querySelector("head > title"))),Dn(w,p,u),w[on]=i,le(w),p=w;break e;case"link":var N=d1("link","href",y).get(p+(u.href||""));if(N){for(var L=0;L<N.length;L++)if(w=N[L],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(L,1);break t}}w=y.createElement(p),Dn(w,p,u),y.head.appendChild(w);break;case"meta":if(N=d1("meta","content",y).get(p+(u.content||""))){for(L=0;L<N.length;L++)if(w=N[L],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(L,1);break t}}w=y.createElement(p),Dn(w,p,u),y.head.appendChild(w);break;default:throw Error(r(468,p))}w[on]=i,le(w),p=w}i.stateNode=p}else h1(y,i.type,i.stateNode);else i.stateNode=f1(y,p,i.memoizedProps);else w!==p?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,p===null?h1(y,i.type,i.stateNode):f1(y,p,i.memoizedProps)):p===null&&i.stateNode!==null&&G0(i,i.memoizedProps,u.memoizedProps)}break;case 27:gr(o,i),xr(i),p&512&&(rn||u===null||ua(u,u.return)),u!==null&&p&4&&G0(i,i.memoizedProps,u.memoizedProps);break;case 5:if(gr(o,i),xr(i),p&512&&(rn||u===null||ua(u,u.return)),i.flags&32){y=i.stateNode;try{zs(y,"")}catch(xe){Ut(i,i.return,xe)}}p&4&&i.stateNode!=null&&(y=i.memoizedProps,G0(i,y,u!==null?u.memoizedProps:y)),p&1024&&(Y0=!0);break;case 6:if(gr(o,i),xr(i),p&4){if(i.stateNode===null)throw Error(r(162));p=i.memoizedProps,u=i.stateNode;try{u.nodeValue=p}catch(xe){Ut(i,i.return,xe)}}break;case 3:if(cf=null,y=Yr,Yr=of(o.containerInfo),gr(o,i),Yr=y,xr(i),p&4&&u!==null&&u.memoizedState.isDehydrated)try{sc(o.containerInfo)}catch(xe){Ut(i,i.return,xe)}Y0&&(Y0=!1,yv(i));break;case 4:p=Yr,Yr=of(i.stateNode.containerInfo),gr(o,i),xr(i),Yr=p;break;case 12:gr(o,i),xr(i);break;case 13:gr(o,i),xr(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(eh=Me()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,W0(i,p)));break;case 22:y=i.memoizedState!==null;var ne=u!==null&&u.memoizedState!==null,fe=Ua,Se=rn;if(Ua=fe||y,rn=Se||ne,gr(o,i),rn=Se,Ua=fe,xr(i),p&8192)e:for(o=i.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||ne||Ua||rn||ss(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){ne=u=o;try{if(w=ne.stateNode,y)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{L=ne.stateNode;var be=ne.memoizedProps.style,ge=be!=null&&be.hasOwnProperty("display")?be.display:null;L.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(xe){Ut(ne,ne.return,xe)}}}else if(o.tag===6){if(u===null){ne=o;try{ne.stateNode.nodeValue=y?"":ne.memoizedProps}catch(xe){Ut(ne,ne.return,xe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,W0(i,u))));break;case 19:gr(o,i),xr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,W0(i,p)));break;case 30:break;case 21:break;default:gr(o,i),xr(i)}}function xr(i){var o=i.flags;if(o&2){try{for(var u,p=i.return;p!==null;){if(fv(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var y=u.stateNode,w=z0(i);Yu(i,w,y);break;case 5:var N=u.stateNode;u.flags&32&&(zs(N,""),u.flags&=-33);var L=z0(i);Yu(i,L,N);break;case 3:case 4:var ne=u.stateNode.containerInfo,fe=z0(i);q0(i,fe,ne);break;default:throw Error(r(161))}}catch(Se){Ut(i,i.return,Se)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function yv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;yv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function di(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)mv(i,o.alternate,o),o=o.sibling}function ss(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:fi(4,o,o.return),ss(o);break;case 1:ua(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&cv(o,o.return,u),ss(o);break;case 27:Zl(o.stateNode);case 26:case 5:ua(o,o.return),ss(o);break;case 22:o.memoizedState===null&&ss(o);break;case 30:ss(o);break;default:ss(o)}i=i.sibling}}function hi(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,y=i,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:hi(y,w,u),Hl(4,w);break;case 1:if(hi(y,w,u),p=w,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(fe){Ut(p,p.return,fe)}if(p=w,y=p.updateQueue,y!==null){var L=p.stateNode;try{var ne=y.shared.hiddenCallbacks;if(ne!==null)for(y.shared.hiddenCallbacks=null,y=0;y<ne.length;y++)Wg(ne[y],L)}catch(fe){Ut(p,p.return,fe)}}u&&N&64&&lv(w),$l(w,w.return);break;case 27:dv(w);case 26:case 5:hi(y,w,u),u&&p===null&&N&4&&uv(w),$l(w,w.return);break;case 12:hi(y,w,u);break;case 13:hi(y,w,u),u&&N&4&&xv(y,w);break;case 22:w.memoizedState===null&&hi(y,w,u),$l(w,w.return);break;case 30:break;default:hi(y,w,u)}o=o.sibling}}function J0(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&kl(u))}function K0(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&kl(i))}function fa(i,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)_v(i,o,u,p),o=o.sibling}function _v(i,o,u,p){var y=o.flags;switch(o.tag){case 0:case 11:case 15:fa(i,o,u,p),y&2048&&Hl(9,o);break;case 1:fa(i,o,u,p);break;case 3:fa(i,o,u,p),y&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&kl(i)));break;case 12:if(y&2048){fa(i,o,u,p),i=o.stateNode;try{var w=o.memoizedProps,N=w.id,L=w.onPostCommit;typeof L=="function"&&L(N,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ne){Ut(o,o.return,ne)}}else fa(i,o,u,p);break;case 13:fa(i,o,u,p);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?fa(i,o,u,p):Gl(i,o):w._visibility&2?fa(i,o,u,p):(w._visibility|=2,uo(i,o,u,p,(o.subtreeFlags&10256)!==0)),y&2048&&J0(N,o);break;case 24:fa(i,o,u,p),y&2048&&K0(o.alternate,o);break;default:fa(i,o,u,p)}}function uo(i,o,u,p,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var w=i,N=o,L=u,ne=p,fe=N.flags;switch(N.tag){case 0:case 11:case 15:uo(w,N,L,ne,y),Hl(8,N);break;case 23:break;case 22:var Se=N.stateNode;N.memoizedState!==null?Se._visibility&2?uo(w,N,L,ne,y):Gl(w,N):(Se._visibility|=2,uo(w,N,L,ne,y)),y&&fe&2048&&J0(N.alternate,N);break;case 24:uo(w,N,L,ne,y),y&&fe&2048&&K0(N.alternate,N);break;default:uo(w,N,L,ne,y)}o=o.sibling}}function Gl(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,p=o,y=p.flags;switch(p.tag){case 22:Gl(u,p),y&2048&&J0(p.alternate,p);break;case 24:Gl(u,p),y&2048&&K0(p.alternate,p);break;default:Gl(u,p)}o=o.sibling}}var zl=8192;function fo(i){if(i.subtreeFlags&zl)for(i=i.child;i!==null;)wv(i),i=i.sibling}function wv(i){switch(i.tag){case 26:fo(i),i.flags&zl&&i.memoizedState!==null&&wb(Yr,i.memoizedState,i.memoizedProps);break;case 5:fo(i);break;case 3:case 4:var o=Yr;Yr=of(i.stateNode.containerInfo),fo(i),Yr=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=zl,zl=16777216,fo(i),zl=o):fo(i));break;default:fo(i)}}function Tv(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function ql(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Sn=p,Sv(p,i)}Tv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ev(i),i=i.sibling}function Ev(i){switch(i.tag){case 0:case 11:case 15:ql(i),i.flags&2048&&fi(9,i,i.return);break;case 3:ql(i);break;case 12:ql(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Wu(i)):ql(i);break;default:ql(i)}}function Wu(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Sn=p,Sv(p,i)}Tv(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:fi(8,o,o.return),Wu(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Wu(o));break;default:Wu(o)}i=i.sibling}}function Sv(i,o){for(;Sn!==null;){var u=Sn;switch(u.tag){case 0:case 11:case 15:fi(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:kl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Sn=p;else e:for(u=i;Sn!==null;){p=Sn;var y=p.sibling,w=p.return;if(pv(p),p===u){Sn=null;break e}if(y!==null){y.return=w,Sn=y;break e}Sn=w}}}var OC={getCacheForType:function(i){var o=On(xn),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u}},UC=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Bt=null,ht=null,vt=0,Dt=0,vr=null,mi=!1,ho=!1,X0=!1,ja=0,Xt=0,pi=0,os=0,Z0=0,Fr=0,mo=0,Yl=null,or=null,Q0=!1,eh=0,Ju=1/0,Ku=null,gi=null,Mn=0,xi=null,po=null,go=0,th=0,nh=null,Cv=null,Wl=0,rh=null;function yr(){if((Mt&2)!==0&&vt!==0)return vt&-vt;if(ie.T!==null){var i=no;return i!==0?i:uh()}return $s()}function bv(){Fr===0&&(Fr=(vt&536870912)===0||bt?sa():536870912);var i=Ir.current;return i!==null&&(i.flags|=32),Fr}function _r(i,o,u){(i===Bt&&(Dt===2||Dt===9)||i.cancelPendingCommit!==null)&&(xo(i,0),vi(i,vt,Fr,!1)),Aa(i,u),((Mt&2)===0||i!==Bt)&&(i===Bt&&((Mt&2)===0&&(os|=u),Xt===4&&vi(i,vt,Fr,!1)),da(i))}function Av(i,o,u){if((Mt&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&i.expiredLanes)===0||nt(i,o),y=p?VC(i,o):sh(i,o,!0),w=p;do{if(y===0){ho&&!p&&vi(i,o,0,!1);break}else{if(u=i.current.alternate,w&&!BC(u)){y=sh(i,o,!1),w=!1;continue}if(y===2){if(w=o,i.errorRecoveryDisabledLanes&w)var N=0;else N=i.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var L=i;y=Yl;var ne=L.current.memoizedState.isDehydrated;if(ne&&(xo(L,N).flags|=256),N=sh(L,N,!1),N!==2){if(X0&&!ne){L.errorRecoveryDisabledLanes|=w,os|=w,y=4;break e}w=or,or=y,w!==null&&(or===null?or=w:or.push.apply(or,w))}y=N}if(w=!1,y!==2)continue}}if(y===1){xo(i,0),vi(i,o,0,!0);break}e:{switch(p=i,w=y,w){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:vi(p,o,Fr,!mi);break e;case 2:or=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(y=eh+300-Me(),10<y)){if(vi(p,o,Fr,!mi),ze(p,0,!0)!==0)break e;p.timeoutHandle=n1(kv.bind(null,p,u,or,Ku,Q0,o,Fr,os,mo,mi,w,2,-0,0),y);break e}kv(p,u,or,Ku,Q0,o,Fr,os,mo,mi,w,0,-0,0)}}break}while(!0);da(i)}function kv(i,o,u,p,y,w,N,L,ne,fe,Se,be,ge,xe){if(i.timeoutHandle=-1,be=o.subtreeFlags,(be&8192||(be&16785408)===16785408)&&(tc={stylesheets:null,count:0,unsuspend:_b},wv(o),be=Tb(),be!==null)){i.cancelPendingCommit=be(Lv.bind(null,i,o,w,u,p,y,N,L,ne,Se,1,ge,xe)),vi(i,w,N,!fe);return}Lv(i,o,w,u,p,y,N,L,ne)}function BC(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var y=u[p],w=y.getSnapshot;y=y.value;try{if(!mr(w(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function vi(i,o,u,p){o&=~Z0,o&=~os,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var y=o;0<y;){var w=31-Nt(y),N=1<<w;p[w]=-1,y&=~N}u!==0&&Vs(i,u,o)}function Xu(){return(Mt&6)===0?(Jl(0),!1):!0}function ah(){if(ht!==null){if(Dt===0)var i=ht.return;else i=ht,Da=ts=null,w0(i),lo=null,Bl=0,i=ht;for(;i!==null;)ov(i.alternate,i),i=i.return;ht=null}}function xo(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,rb(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),ah(),Bt=i,ht=u=Na(i.current,null),vt=o,Dt=0,vr=null,mi=!1,ho=nt(i,o),X0=!1,mo=Fr=Z0=os=pi=Xt=0,or=Yl=null,Q0=!1,(o&8)!==0&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var y=31-Nt(p),w=1<<y;o|=i[y],p&=~w}return ja=o,yu(),u}function Nv(i,o){ut=null,ie.H=Uu,o===Rl||o===ku?(o=qg(),Dt=3):o===$g?(o=qg(),Dt=4):Dt=o===Yx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,vr=o,ht===null&&(Xt=1,$u(i,Nr(o,i.current)))}function Rv(){var i=ie.H;return ie.H=Uu,i===null?Uu:i}function Mv(){var i=ie.A;return ie.A=OC,i}function ih(){Xt=4,mi||(vt&4194048)!==vt&&Ir.current!==null||(ho=!0),(pi&134217727)===0&&(os&134217727)===0||Bt===null||vi(Bt,vt,Fr,!1)}function sh(i,o,u){var p=Mt;Mt|=2;var y=Rv(),w=Mv();(Bt!==i||vt!==o)&&(Ku=null,xo(i,o)),o=!1;var N=Xt;e:do try{if(Dt!==0&&ht!==null){var L=ht,ne=vr;switch(Dt){case 8:ah(),N=6;break e;case 3:case 2:case 9:case 6:Ir.current===null&&(o=!0);var fe=Dt;if(Dt=0,vr=null,vo(i,L,ne,fe),u&&ho){N=0;break e}break;default:fe=Dt,Dt=0,vr=null,vo(i,L,ne,fe)}}jC(),N=Xt;break}catch(Se){Nv(i,Se)}while(!0);return o&&i.shellSuspendCounter++,Da=ts=null,Mt=p,ie.H=y,ie.A=w,ht===null&&(Bt=null,vt=0,yu()),N}function jC(){for(;ht!==null;)Dv(ht)}function VC(i,o){var u=Mt;Mt|=2;var p=Rv(),y=Mv();Bt!==i||vt!==o?(Ku=null,Ju=Me()+500,xo(i,o)):ho=nt(i,o);e:do try{if(Dt!==0&&ht!==null){o=ht;var w=vr;t:switch(Dt){case 1:Dt=0,vr=null,vo(i,o,w,1);break;case 2:case 9:if(Gg(w)){Dt=0,vr=null,Iv(o);break}o=function(){Dt!==2&&Dt!==9||Bt!==i||(Dt=7),da(i)},w.then(o,o);break e;case 3:Dt=7;break e;case 4:Dt=5;break e;case 7:Gg(w)?(Dt=0,vr=null,Iv(o)):(Dt=0,vr=null,vo(i,o,w,7));break;case 5:var N=null;switch(ht.tag){case 26:N=ht.memoizedState;case 5:case 27:var L=ht;if(!N||m1(N)){Dt=0,vr=null;var ne=L.sibling;if(ne!==null)ht=ne;else{var fe=L.return;fe!==null?(ht=fe,Zu(fe)):ht=null}break t}}Dt=0,vr=null,vo(i,o,w,5);break;case 6:Dt=0,vr=null,vo(i,o,w,6);break;case 8:ah(),Xt=6;break e;default:throw Error(r(462))}}HC();break}catch(Se){Nv(i,Se)}while(!0);return Da=ts=null,ie.H=p,ie.A=y,Mt=u,ht!==null?0:(Bt=null,vt=0,yu(),Xt)}function HC(){for(;ht!==null&&!dt();)Dv(ht)}function Dv(i){var o=iv(i.alternate,i,ja);i.memoizedProps=i.pendingProps,o===null?Zu(i):ht=o}function Iv(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=Qx(u,o,o.pendingProps,o.type,void 0,vt);break;case 11:o=Qx(u,o,o.pendingProps,o.type.render,o.ref,vt);break;case 5:w0(o);default:ov(u,o),o=ht=Fg(o,ja),o=iv(u,o,ja)}i.memoizedProps=i.pendingProps,o===null?Zu(i):ht=o}function vo(i,o,u,p){Da=ts=null,w0(o),lo=null,Bl=0;var y=o.return;try{if(MC(i,y,o,u,vt)){Xt=1,$u(i,Nr(u,i.current)),ht=null;return}}catch(w){if(y!==null)throw ht=y,w;Xt=1,$u(i,Nr(u,i.current)),ht=null;return}o.flags&32768?(bt||p===1?i=!0:ho||(vt&536870912)!==0?i=!1:(mi=i=!0,(p===2||p===9||p===3||p===6)&&(p=Ir.current,p!==null&&p.tag===13&&(p.flags|=16384))),Fv(o,i)):Zu(o)}function Zu(i){var o=i;do{if((o.flags&32768)!==0){Fv(o,mi);return}i=o.return;var u=IC(o.alternate,o,ja);if(u!==null){ht=u;return}if(o=o.sibling,o!==null){ht=o;return}ht=o=i}while(o!==null);Xt===0&&(Xt=5)}function Fv(i,o){do{var u=FC(i.alternate,i);if(u!==null){u.flags&=32767,ht=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){ht=i;return}ht=i=u}while(i!==null);Xt=6,ht=null}function Lv(i,o,u,p,y,w,N,L,ne){i.cancelPendingCommit=null;do Qu();while(Mn!==0);if((Mt&6)!==0)throw Error(r(327));if(o!==null){if(o===i.current)throw Error(r(177));if(w=o.lanes|o.childLanes,w|=Kd,ti(i,u,w,N,L,ne),i===Bt&&(ht=Bt=null,vt=0),po=o,xi=i,go=u,th=w,nh=y,Cv=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,qC(en,function(){return jv(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=ie.T,ie.T=null,y=de.p,de.p=2,N=Mt,Mt|=4;try{LC(i,o,u)}finally{Mt=N,de.p=y,ie.T=p}}Mn=1,Pv(),Ov(),Uv()}}function Pv(){if(Mn===1){Mn=0;var i=xi,o=po,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=ie.T,ie.T=null;var p=de.p;de.p=2;var y=Mt;Mt|=4;try{vv(o,i);var w=vh,N=Sg(i.containerInfo),L=w.focusedElem,ne=w.selectionRange;if(N!==L&&L&&L.ownerDocument&&Eg(L.ownerDocument.documentElement,L)){if(ne!==null&&zd(L)){var fe=ne.start,Se=ne.end;if(Se===void 0&&(Se=fe),"selectionStart"in L)L.selectionStart=fe,L.selectionEnd=Math.min(Se,L.value.length);else{var be=L.ownerDocument||document,ge=be&&be.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),Je=L.textContent.length,Ye=Math.min(ne.start,Je),Ot=ne.end===void 0?Ye:Math.min(ne.end,Je);!xe.extend&&Ye>Ot&&(N=Ot,Ot=Ye,Ye=N);var oe=Tg(L,Ye),se=Tg(L,Ot);if(oe&&se&&(xe.rangeCount!==1||xe.anchorNode!==oe.node||xe.anchorOffset!==oe.offset||xe.focusNode!==se.node||xe.focusOffset!==se.offset)){var ce=be.createRange();ce.setStart(oe.node,oe.offset),xe.removeAllRanges(),Ye>Ot?(xe.addRange(ce),xe.extend(se.node,se.offset)):(ce.setEnd(se.node,se.offset),xe.addRange(ce))}}}}for(be=[],xe=L;xe=xe.parentNode;)xe.nodeType===1&&be.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<be.length;L++){var Ce=be[L];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}df=!!xh,vh=xh=null}finally{Mt=y,de.p=p,ie.T=u}}i.current=o,Mn=2}}function Ov(){if(Mn===2){Mn=0;var i=xi,o=po,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=ie.T,ie.T=null;var p=de.p;de.p=2;var y=Mt;Mt|=4;try{mv(i,o.alternate,o)}finally{Mt=y,de.p=p,ie.T=u}}Mn=3}}function Uv(){if(Mn===4||Mn===3){Mn=0,tt();var i=xi,o=po,u=go,p=Cv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Mn=5:(Mn=0,po=xi=null,Bv(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(gi=null),zi(u),o=o.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(gn,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=ie.T,y=de.p,de.p=2,ie.T=null;try{for(var w=i.onRecoverableError,N=0;N<p.length;N++){var L=p[N];w(L.value,{componentStack:L.stack})}}finally{ie.T=o,de.p=y}}(go&3)!==0&&Qu(),da(i),y=i.pendingLanes,(u&4194090)!==0&&(y&42)!==0?i===rh?Wl++:(Wl=0,rh=i):Wl=0,Jl(0)}}function Bv(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,kl(o)))}function Qu(i){return Pv(),Ov(),Uv(),jv()}function jv(){if(Mn!==5)return!1;var i=xi,o=th;th=0;var u=zi(go),p=ie.T,y=de.p;try{de.p=32>u?32:u,ie.T=null,u=nh,nh=null;var w=xi,N=go;if(Mn=0,po=xi=null,go=0,(Mt&6)!==0)throw Error(r(331));var L=Mt;if(Mt|=4,Ev(w.current),_v(w,w.current,N,u),Mt=L,Jl(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(gn,w)}catch{}return!0}finally{de.p=y,ie.T=p,Bv(i,o)}}function Vv(i,o,u){o=Nr(u,o),o=L0(i.stateNode,o,2),i=oi(i,o,2),i!==null&&(Aa(i,2),da(i))}function Ut(i,o,u){if(i.tag===3)Vv(i,i,u);else for(;o!==null;){if(o.tag===3){Vv(o,i,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(gi===null||!gi.has(p))){i=Nr(u,i),u=zx(2),p=oi(o,u,2),p!==null&&(qx(u,p,o,i),Aa(p,2),da(p));break}}o=o.return}}function oh(i,o,u){var p=i.pingCache;if(p===null){p=i.pingCache=new UC;var y=new Set;p.set(o,y)}else y=p.get(o),y===void 0&&(y=new Set,p.set(o,y));y.has(u)||(X0=!0,y.add(u),i=$C.bind(null,i,o,u),o.then(i,i))}function $C(i,o,u){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Bt===i&&(vt&u)===u&&(Xt===4||Xt===3&&(vt&62914560)===vt&&300>Me()-eh?(Mt&2)===0&&xo(i,0):Z0|=u,mo===vt&&(mo=0)),da(i)}function Hv(i,o){o===0&&(o=Hi()),i=Zs(i,o),i!==null&&(Aa(i,o),da(i))}function GC(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),Hv(i,u)}function zC(i,o){var u=0;switch(i.tag){case 13:var p=i.stateNode,y=i.memoizedState;y!==null&&(u=y.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),Hv(i,u)}function qC(i,o){return ct(i,o)}var ef=null,yo=null,lh=!1,tf=!1,ch=!1,ls=0;function da(i){i!==yo&&i.next===null&&(yo===null?ef=yo=i:yo=yo.next=i),tf=!0,lh||(lh=!0,WC())}function Jl(i,o){if(!ch&&tf){ch=!0;do for(var u=!1,p=ef;p!==null;){if(i!==0){var y=p.pendingLanes;if(y===0)var w=0;else{var N=p.suspendedLanes,L=p.pingedLanes;w=(1<<31-Nt(42|i)+1)-1,w&=y&~(N&~L),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,qv(p,w))}else w=vt,w=ze(p,p===Bt?w:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(w&3)===0||nt(p,w)||(u=!0,qv(p,w));p=p.next}while(u);ch=!1}}function YC(){$v()}function $v(){tf=lh=!1;var i=0;ls!==0&&(nb()&&(i=ls),ls=0);for(var o=Me(),u=null,p=ef;p!==null;){var y=p.next,w=Gv(p,o);w===0?(p.next=null,u===null?ef=y:u.next=y,y===null&&(yo=u)):(u=p,(i!==0||(w&3)!==0)&&(tf=!0)),p=y}Jl(i)}function Gv(i,o){for(var u=i.suspendedLanes,p=i.pingedLanes,y=i.expirationTimes,w=i.pendingLanes&-62914561;0<w;){var N=31-Nt(w),L=1<<N,ne=y[N];ne===-1?((L&u)===0||(L&p)!==0)&&(y[N]=dr(L,o)):ne<=o&&(i.expiredLanes|=L),w&=~L}if(o=Bt,u=vt,u=ze(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,u===0||i===o&&(Dt===2||Dt===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&qe(p),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||nt(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(p!==null&&qe(p),zi(u)){case 2:case 8:u=sn;break;case 32:u=en;break;case 268435456:u=Pn;break;default:u=en}return p=zv.bind(null,i),u=ct(u,p),i.callbackPriority=o,i.callbackNode=u,o}return p!==null&&p!==null&&qe(p),i.callbackPriority=2,i.callbackNode=null,2}function zv(i,o){if(Mn!==0&&Mn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Qu()&&i.callbackNode!==u)return null;var p=vt;return p=ze(i,i===Bt?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Av(i,p,o),Gv(i,Me()),i.callbackNode!=null&&i.callbackNode===u?zv.bind(null,i):null)}function qv(i,o){if(Qu())return null;Av(i,o,!0)}function WC(){ab(function(){(Mt&6)!==0?ct(pn,YC):$v()})}function uh(){return ls===0&&(ls=sa()),ls}function Yv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:du(""+i)}function Wv(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function JC(i,o,u,p,y){if(o==="submit"&&u&&u.stateNode===y){var w=Yv((y[ln]||null).action),N=p.submitter;N&&(o=(o=N[ln]||null)?Yv(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var L=new gu("action","action",null,p,y);i.push({event:L,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ls!==0){var ne=N?Wv(y,N):new FormData(y);R0(u,{pending:!0,data:ne,method:y.method,action:w},null,ne)}}else typeof w=="function"&&(L.preventDefault(),ne=N?Wv(y,N):new FormData(y),R0(u,{pending:!0,data:ne,method:y.method,action:w},w,ne))},currentTarget:y}]})}}for(var fh=0;fh<Jd.length;fh++){var dh=Jd[fh],KC=dh.toLowerCase(),XC=dh[0].toUpperCase()+dh.slice(1);qr(KC,"on"+XC)}qr(Ag,"onAnimationEnd"),qr(kg,"onAnimationIteration"),qr(Ng,"onAnimationStart"),qr("dblclick","onDoubleClick"),qr("focusin","onFocus"),qr("focusout","onBlur"),qr(mC,"onTransitionRun"),qr(pC,"onTransitionStart"),qr(gC,"onTransitionCancel"),qr(Rg,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kl));function Jv(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var p=i[u],y=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var N=p.length-1;0<=N;N--){var L=p[N],ne=L.instance,fe=L.currentTarget;if(L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=fe;try{w(y)}catch(Se){Hu(Se)}y.currentTarget=null,w=ne}else for(N=0;N<p.length;N++){if(L=p[N],ne=L.instance,fe=L.currentTarget,L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=fe;try{w(y)}catch(Se){Hu(Se)}y.currentTarget=null,w=ne}}}}function mt(i,o){var u=o[hr];u===void 0&&(u=o[hr]=new Set);var p=i+"__bubble";u.has(p)||(Kv(o,i,2,!1),u.add(p))}function hh(i,o,u){var p=0;o&&(p|=4),Kv(u,i,p,o)}var nf="_reactListening"+Math.random().toString(36).slice(2);function mh(i){if(!i[nf]){i[nf]=!0,he.forEach(function(u){u!=="selectionchange"&&(ZC.has(u)||hh(u,!1,i),hh(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[nf]||(o[nf]=!0,hh("selectionchange",!1,o))}}function Kv(i,o,u,p){switch(_1(o)){case 2:var y=Cb;break;case 8:y=bb;break;default:y=kh}u=y.bind(null,o,u,i),y=void 0,!Pd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),p?y!==void 0?i.addEventListener(o,u,{capture:!0,passive:y}):i.addEventListener(o,u,!0):y!==void 0?i.addEventListener(o,u,{passive:y}):i.addEventListener(o,u,!1)}function ph(i,o,u,p,y){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var N=p.tag;if(N===3||N===4){var L=p.stateNode.containerInfo;if(L===y)break;if(N===4)for(N=p.return;N!==null;){var ne=N.tag;if((ne===3||ne===4)&&N.stateNode.containerInfo===y)return;N=N.return}for(;L!==null;){if(N=q(L),N===null)return;if(ne=N.tag,ne===5||ne===6||ne===26||ne===27){p=w=N;continue e}L=L.parentNode}}p=p.return}rg(function(){var fe=w,Se=Fd(u),be=[];e:{var ge=Mg.get(i);if(ge!==void 0){var xe=gu,Je=i;switch(i){case"keypress":if(mu(u)===0)break e;case"keydown":case"keyup":xe=qS;break;case"focusin":Je="focus",xe=jd;break;case"focusout":Je="blur",xe=jd;break;case"beforeblur":case"afterblur":xe=jd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=FS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=JS;break;case Ag:case kg:case Ng:xe=OS;break;case Rg:xe=XS;break;case"scroll":case"scrollend":xe=DS;break;case"wheel":xe=QS;break;case"copy":case"cut":case"paste":xe=BS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=lg;break;case"toggle":case"beforetoggle":xe=tC}var Ye=(o&4)!==0,Ot=!Ye&&(i==="scroll"||i==="scrollend"),oe=Ye?ge!==null?ge+"Capture":null:ge;Ye=[];for(var se=fe,ce;se!==null;){var Ce=se;if(ce=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||ce===null||oe===null||(Ce=pl(se,oe),Ce!=null&&Ye.push(Xl(se,Ce,ce))),Ot)break;se=se.return}0<Ye.length&&(ge=new xe(ge,Je,null,u,Se),be.push({event:ge,listeners:Ye}))}}if((o&7)===0){e:{if(ge=i==="mouseover"||i==="pointerover",xe=i==="mouseout"||i==="pointerout",ge&&u!==Id&&(Je=u.relatedTarget||u.fromElement)&&(q(Je)||Je[oa]))break e;if((xe||ge)&&(ge=Se.window===Se?Se:(ge=Se.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(Je=u.relatedTarget||u.toElement,xe=fe,Je=Je?q(Je):null,Je!==null&&(Ot=s(Je),Ye=Je.tag,Je!==Ot||Ye!==5&&Ye!==27&&Ye!==6)&&(Je=null)):(xe=null,Je=fe),xe!==Je)){if(Ye=sg,Ce="onMouseLeave",oe="onMouseEnter",se="mouse",(i==="pointerout"||i==="pointerover")&&(Ye=lg,Ce="onPointerLeave",oe="onPointerEnter",se="pointer"),Ot=xe==null?ge:ue(xe),ce=Je==null?ge:ue(Je),ge=new Ye(Ce,se+"leave",xe,u,Se),ge.target=Ot,ge.relatedTarget=ce,Ce=null,q(Se)===fe&&(Ye=new Ye(oe,se+"enter",Je,u,Se),Ye.target=ce,Ye.relatedTarget=Ot,Ce=Ye),Ot=Ce,xe&&Je)t:{for(Ye=xe,oe=Je,se=0,ce=Ye;ce;ce=_o(ce))se++;for(ce=0,Ce=oe;Ce;Ce=_o(Ce))ce++;for(;0<se-ce;)Ye=_o(Ye),se--;for(;0<ce-se;)oe=_o(oe),ce--;for(;se--;){if(Ye===oe||oe!==null&&Ye===oe.alternate)break t;Ye=_o(Ye),oe=_o(oe)}Ye=null}else Ye=null;xe!==null&&Xv(be,ge,xe,Ye,!1),Je!==null&&Ot!==null&&Xv(be,Ot,Je,Ye,!0)}}e:{if(ge=fe?ue(fe):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var Oe=gg;else if(mg(ge))if(xg)Oe=fC;else{Oe=cC;var ft=lC}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?fe&&Dd(fe.elementType)&&(Oe=gg):Oe=uC;if(Oe&&(Oe=Oe(i,fe))){pg(be,Oe,u,Se);break e}ft&&ft(i,ge,fe),i==="focusout"&&fe&&ge.type==="number"&&fe.memoizedProps.value!=null&&Md(ge,"number",ge.value)}switch(ft=fe?ue(fe):window,i){case"focusin":(mg(ft)||ft.contentEditable==="true")&&(Js=ft,qd=fe,El=null);break;case"focusout":El=qd=Js=null;break;case"mousedown":Yd=!0;break;case"contextmenu":case"mouseup":case"dragend":Yd=!1,Cg(be,u,Se);break;case"selectionchange":if(hC)break;case"keydown":case"keyup":Cg(be,u,Se)}var He;if(Hd)e:{switch(i){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Ws?dg(i,u)&&(We="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(We="onCompositionStart");We&&(cg&&u.locale!=="ko"&&(Ws||We!=="onCompositionStart"?We==="onCompositionEnd"&&Ws&&(He=ag()):(ri=Se,Od="value"in ri?ri.value:ri.textContent,Ws=!0)),ft=rf(fe,We),0<ft.length&&(We=new og(We,i,null,u,Se),be.push({event:We,listeners:ft}),He?We.data=He:(He=hg(u),He!==null&&(We.data=He)))),(He=rC?aC(i,u):iC(i,u))&&(We=rf(fe,"onBeforeInput"),0<We.length&&(ft=new og("onBeforeInput","beforeinput",null,u,Se),be.push({event:ft,listeners:We}),ft.data=He)),JC(be,i,fe,u,Se)}Jv(be,o)})}function Xl(i,o,u){return{instance:i,listener:o,currentTarget:u}}function rf(i,o){for(var u=o+"Capture",p=[];i!==null;){var y=i,w=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||w===null||(y=pl(i,u),y!=null&&p.unshift(Xl(i,y,w)),y=pl(i,o),y!=null&&p.push(Xl(i,y,w))),i.tag===3)return p;i=i.return}return[]}function _o(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Xv(i,o,u,p,y){for(var w=o._reactName,N=[];u!==null&&u!==p;){var L=u,ne=L.alternate,fe=L.stateNode;if(L=L.tag,ne!==null&&ne===p)break;L!==5&&L!==26&&L!==27||fe===null||(ne=fe,y?(fe=pl(u,w),fe!=null&&N.unshift(Xl(u,fe,ne))):y||(fe=pl(u,w),fe!=null&&N.push(Xl(u,fe,ne)))),u=u.return}N.length!==0&&i.push({event:o,listeners:N})}var QC=/\r\n?/g,eb=/\u0000|\uFFFD/g;function Zv(i){return(typeof i=="string"?i:""+i).replace(QC,`
`).replace(eb,"")}function Qv(i,o){return o=Zv(o),Zv(i)===o}function af(){}function Pt(i,o,u,p,y,w){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||zs(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&zs(i,""+p);break;case"className":Ct(i,"class",p);break;case"tabIndex":Ct(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Ct(i,u,p);break;case"style":tg(i,p,w);break;case"data":if(o!=="object"){Ct(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=du(""+p),i.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&Pt(i,o,"name",y.name,y,null),Pt(i,o,"formEncType",y.formEncType,y,null),Pt(i,o,"formMethod",y.formMethod,y,null),Pt(i,o,"formTarget",y.formTarget,y,null)):(Pt(i,o,"encType",y.encType,y,null),Pt(i,o,"method",y.method,y,null),Pt(i,o,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=du(""+p),i.setAttribute(u,p);break;case"onClick":p!=null&&(i.onclick=af);break;case"onScroll":p!=null&&mt("scroll",i);break;case"onScrollEnd":p!=null&&mt("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}u=du(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""+p):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":p===!0?i.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,p):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(u,p):i.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(u):i.setAttribute(u,p);break;case"popover":mt("beforetoggle",i),mt("toggle",i),kt(i,"popover",p);break;case"xlinkActuate":Rt(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Rt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Rt(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Rt(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Rt(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Rt(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Rt(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Rt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Rt(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":kt(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=RS.get(u)||u,kt(i,u,p))}}function gh(i,o,u,p,y,w){switch(u){case"style":tg(i,p,w);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof p=="string"?zs(i,p):(typeof p=="number"||typeof p=="bigint")&&zs(i,""+p);break;case"onScroll":p!=null&&mt("scroll",i);break;case"onScrollEnd":p!=null&&mt("scrollend",i);break;case"onClick":p!=null&&(i.onclick=af);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pe.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),w=i[ln]||null,w=w!=null?w[u]:null,typeof w=="function"&&i.removeEventListener(o,w,y),typeof p=="function")){typeof w!="function"&&w!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,p,y);break e}u in i?i[u]=p:p===!0?i.setAttribute(u,""):kt(i,u,p)}}}function Dn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",i),mt("load",i);var p=!1,y=!1,w;for(w in u)if(u.hasOwnProperty(w)){var N=u[w];if(N!=null)switch(w){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Pt(i,o,w,N,u,null)}}y&&Pt(i,o,"srcSet",u.srcSet,u,null),p&&Pt(i,o,"src",u.src,u,null);return;case"input":mt("invalid",i);var L=w=N=y=null,ne=null,fe=null;for(p in u)if(u.hasOwnProperty(p)){var Se=u[p];if(Se!=null)switch(p){case"name":y=Se;break;case"type":N=Se;break;case"checked":ne=Se;break;case"defaultChecked":fe=Se;break;case"value":w=Se;break;case"defaultValue":L=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(137,o));break;default:Pt(i,o,p,Se,u,null)}}Xp(i,w,L,ne,fe,N,y,!1),uu(i);return;case"select":mt("invalid",i),p=N=w=null;for(y in u)if(u.hasOwnProperty(y)&&(L=u[y],L!=null))switch(y){case"value":w=L;break;case"defaultValue":N=L;break;case"multiple":p=L;default:Pt(i,o,y,L,u,null)}o=w,u=N,i.multiple=!!p,o!=null?Gs(i,!!p,o,!1):u!=null&&Gs(i,!!p,u,!0);return;case"textarea":mt("invalid",i),w=y=p=null;for(N in u)if(u.hasOwnProperty(N)&&(L=u[N],L!=null))switch(N){case"value":p=L;break;case"defaultValue":y=L;break;case"children":w=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:Pt(i,o,N,L,u,null)}Qp(i,p,y,w),uu(i);return;case"option":for(ne in u)if(u.hasOwnProperty(ne)&&(p=u[ne],p!=null))switch(ne){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Pt(i,o,ne,p,u,null)}return;case"dialog":mt("beforetoggle",i),mt("toggle",i),mt("cancel",i),mt("close",i);break;case"iframe":case"object":mt("load",i);break;case"video":case"audio":for(p=0;p<Kl.length;p++)mt(Kl[p],i);break;case"image":mt("error",i),mt("load",i);break;case"details":mt("toggle",i);break;case"embed":case"source":case"link":mt("error",i),mt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in u)if(u.hasOwnProperty(fe)&&(p=u[fe],p!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Pt(i,o,fe,p,u,null)}return;default:if(Dd(o)){for(Se in u)u.hasOwnProperty(Se)&&(p=u[Se],p!==void 0&&gh(i,o,Se,p,u,void 0));return}}for(L in u)u.hasOwnProperty(L)&&(p=u[L],p!=null&&Pt(i,o,L,p,u,null))}function tb(i,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,w=null,N=null,L=null,ne=null,fe=null,Se=null;for(xe in u){var be=u[xe];if(u.hasOwnProperty(xe)&&be!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":ne=be;default:p.hasOwnProperty(xe)||Pt(i,o,xe,null,p,be)}}for(var ge in p){var xe=p[ge];if(be=u[ge],p.hasOwnProperty(ge)&&(xe!=null||be!=null))switch(ge){case"type":w=xe;break;case"name":y=xe;break;case"checked":fe=xe;break;case"defaultChecked":Se=xe;break;case"value":N=xe;break;case"defaultValue":L=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,o));break;default:xe!==be&&Pt(i,o,ge,xe,p,be)}}Rd(i,N,L,ne,fe,Se,w,y);return;case"select":xe=N=L=ge=null;for(w in u)if(ne=u[w],u.hasOwnProperty(w)&&ne!=null)switch(w){case"value":break;case"multiple":xe=ne;default:p.hasOwnProperty(w)||Pt(i,o,w,null,p,ne)}for(y in p)if(w=p[y],ne=u[y],p.hasOwnProperty(y)&&(w!=null||ne!=null))switch(y){case"value":ge=w;break;case"defaultValue":L=w;break;case"multiple":N=w;default:w!==ne&&Pt(i,o,y,w,p,ne)}o=L,u=N,p=xe,ge!=null?Gs(i,!!u,ge,!1):!!p!=!!u&&(o!=null?Gs(i,!!u,o,!0):Gs(i,!!u,u?[]:"",!1));return;case"textarea":xe=ge=null;for(L in u)if(y=u[L],u.hasOwnProperty(L)&&y!=null&&!p.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Pt(i,o,L,null,p,y)}for(N in p)if(y=p[N],w=u[N],p.hasOwnProperty(N)&&(y!=null||w!=null))switch(N){case"value":ge=y;break;case"defaultValue":xe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==w&&Pt(i,o,N,y,p,w)}Zp(i,ge,xe);return;case"option":for(var Je in u)if(ge=u[Je],u.hasOwnProperty(Je)&&ge!=null&&!p.hasOwnProperty(Je))switch(Je){case"selected":i.selected=!1;break;default:Pt(i,o,Je,null,p,ge)}for(ne in p)if(ge=p[ne],xe=u[ne],p.hasOwnProperty(ne)&&ge!==xe&&(ge!=null||xe!=null))switch(ne){case"selected":i.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Pt(i,o,ne,ge,p,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in u)ge=u[Ye],u.hasOwnProperty(Ye)&&ge!=null&&!p.hasOwnProperty(Ye)&&Pt(i,o,Ye,null,p,ge);for(fe in p)if(ge=p[fe],xe=u[fe],p.hasOwnProperty(fe)&&ge!==xe&&(ge!=null||xe!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:Pt(i,o,fe,ge,p,xe)}return;default:if(Dd(o)){for(var Ot in u)ge=u[Ot],u.hasOwnProperty(Ot)&&ge!==void 0&&!p.hasOwnProperty(Ot)&&gh(i,o,Ot,void 0,p,ge);for(Se in p)ge=p[Se],xe=u[Se],!p.hasOwnProperty(Se)||ge===xe||ge===void 0&&xe===void 0||gh(i,o,Se,ge,p,xe);return}}for(var oe in u)ge=u[oe],u.hasOwnProperty(oe)&&ge!=null&&!p.hasOwnProperty(oe)&&Pt(i,o,oe,null,p,ge);for(be in p)ge=p[be],xe=u[be],!p.hasOwnProperty(be)||ge===xe||ge==null&&xe==null||Pt(i,o,be,ge,p,xe)}var xh=null,vh=null;function sf(i){return i.nodeType===9?i:i.ownerDocument}function e1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function t1(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function yh(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var _h=null;function nb(){var i=window.event;return i&&i.type==="popstate"?i===_h?!1:(_h=i,!0):(_h=null,!1)}var n1=typeof setTimeout=="function"?setTimeout:void 0,rb=typeof clearTimeout=="function"?clearTimeout:void 0,r1=typeof Promise=="function"?Promise:void 0,ab=typeof queueMicrotask=="function"?queueMicrotask:typeof r1<"u"?function(i){return r1.resolve(null).then(i).catch(ib)}:n1;function ib(i){setTimeout(function(){throw i})}function yi(i){return i==="head"}function a1(i,o){var u=o,p=0,y=0;do{var w=u.nextSibling;if(i.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"){if(0<p&&8>p){u=p;var N=i.ownerDocument;if(u&1&&Zl(N.documentElement),u&2&&Zl(N.body),u&4)for(u=N.head,Zl(u),N=u.firstChild;N;){var L=N.nextSibling,ne=N.nodeName;N[O]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&N.rel.toLowerCase()==="stylesheet"||u.removeChild(N),N=L}}if(y===0){i.removeChild(w),sc(o);return}y--}else u==="$"||u==="$?"||u==="$!"?y++:p=u.charCodeAt(0)-48;else p=0;u=w}while(u);sc(o)}function wh(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":wh(u),V(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function sb(i,o,u,p){for(;i.nodeType===1;){var y=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[O])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(w=i.getAttribute("rel"),w==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(w!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(w=i.getAttribute("src"),(w!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&w&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var w=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===w)return i}else return i;if(i=Wr(i.nextSibling),i===null)break}return null}function ob(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Wr(i.nextSibling),i===null))return null;return i}function Th(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function lb(i,o){var u=i.ownerDocument;if(i.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Wr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var Eh=null;function i1(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}function s1(i,o,u){switch(o=sf(u),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Zl(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);V(i)}var Lr=new Map,o1=new Set;function of(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Va=de.d;de.d={f:cb,r:ub,D:fb,C:db,L:hb,m:mb,X:gb,S:pb,M:xb};function cb(){var i=Va.f(),o=Xu();return i||o}function ub(i){var o=Y(i);o!==null&&o.tag===5&&o.type==="form"?Ax(o):Va.r(i)}var wo=typeof document>"u"?null:document;function l1(i,o,u){var p=wo;if(p&&typeof o=="string"&&o){var y=kr(o);y='link[rel="'+i+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),o1.has(y)||(o1.add(y),i={rel:i,crossOrigin:u,href:o},p.querySelector(y)===null&&(o=p.createElement("link"),Dn(o,"link",i),le(o),p.head.appendChild(o)))}}function fb(i){Va.D(i),l1("dns-prefetch",i,null)}function db(i,o){Va.C(i,o),l1("preconnect",i,o)}function hb(i,o,u){Va.L(i,o,u);var p=wo;if(p&&i&&o){var y='link[rel="preload"][as="'+kr(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+kr(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+kr(u.imageSizes)+'"]')):y+='[href="'+kr(i)+'"]';var w=y;switch(o){case"style":w=To(i);break;case"script":w=Eo(i)}Lr.has(w)||(i=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Lr.set(w,i),p.querySelector(y)!==null||o==="style"&&p.querySelector(Ql(w))||o==="script"&&p.querySelector(ec(w))||(o=p.createElement("link"),Dn(o,"link",i),le(o),p.head.appendChild(o)))}}function mb(i,o){Va.m(i,o);var u=wo;if(u&&i){var p=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+kr(p)+'"][href="'+kr(i)+'"]',w=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Eo(i)}if(!Lr.has(w)&&(i=g({rel:"modulepreload",href:i},o),Lr.set(w,i),u.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(ec(w)))return}p=u.createElement("link"),Dn(p,"link",i),le(p),u.head.appendChild(p)}}}function pb(i,o,u){Va.S(i,o,u);var p=wo;if(p&&i){var y=Te(p).hoistableStyles,w=To(i);o=o||"default";var N=y.get(w);if(!N){var L={loading:0,preload:null};if(N=p.querySelector(Ql(w)))L.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Lr.get(w))&&Sh(i,u);var ne=N=p.createElement("link");le(ne),Dn(ne,"link",i),ne._p=new Promise(function(fe,Se){ne.onload=fe,ne.onerror=Se}),ne.addEventListener("load",function(){L.loading|=1}),ne.addEventListener("error",function(){L.loading|=2}),L.loading|=4,lf(N,o,p)}N={type:"stylesheet",instance:N,count:1,state:L},y.set(w,N)}}}function gb(i,o){Va.X(i,o);var u=wo;if(u&&i){var p=Te(u).hoistableScripts,y=Eo(i),w=p.get(y);w||(w=u.querySelector(ec(y)),w||(i=g({src:i,async:!0},o),(o=Lr.get(y))&&Ch(i,o),w=u.createElement("script"),le(w),Dn(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function xb(i,o){Va.M(i,o);var u=wo;if(u&&i){var p=Te(u).hoistableScripts,y=Eo(i),w=p.get(y);w||(w=u.querySelector(ec(y)),w||(i=g({src:i,async:!0,type:"module"},o),(o=Lr.get(y))&&Ch(i,o),w=u.createElement("script"),le(w),Dn(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function c1(i,o,u,p){var y=(y=te.current)?of(y):null;if(!y)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=To(u.href),u=Te(y).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=To(u.href);var w=Te(y).hoistableStyles,N=w.get(i);if(N||(y=y.ownerDocument||y,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(i,N),(w=y.querySelector(Ql(i)))&&!w._p&&(N.instance=w,N.state.loading=5),Lr.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Lr.set(i,u),w||vb(y,i,u,N.state))),o&&p===null)throw Error(r(528,""));return N}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Eo(u),u=Te(y).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function To(i){return'href="'+kr(i)+'"'}function Ql(i){return'link[rel="stylesheet"]['+i+"]"}function u1(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function vb(i,o,u,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Dn(o,"link",u),le(o),i.head.appendChild(o))}function Eo(i){return'[src="'+kr(i)+'"]'}function ec(i){return"script[async]"+i}function f1(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+kr(u.href)+'"]');if(p)return o.instance=p,le(p),p;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),le(p),Dn(p,"style",y),lf(p,u.precedence,i),o.instance=p;case"stylesheet":y=To(u.href);var w=i.querySelector(Ql(y));if(w)return o.state.loading|=4,o.instance=w,le(w),w;p=u1(u),(y=Lr.get(y))&&Sh(p,y),w=(i.ownerDocument||i).createElement("link"),le(w);var N=w;return N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),Dn(w,"link",p),o.state.loading|=4,lf(w,u.precedence,i),o.instance=w;case"script":return w=Eo(u.src),(y=i.querySelector(ec(w)))?(o.instance=y,le(y),y):(p=u,(y=Lr.get(w))&&(p=g({},u),Ch(p,y)),i=i.ownerDocument||i,y=i.createElement("script"),le(y),Dn(y,"link",p),i.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,lf(p,u.precedence,i));return o.instance}function lf(i,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,w=y,N=0;N<p.length;N++){var L=p[N];if(L.dataset.precedence===o)w=L;else if(w!==y)break}w?w.parentNode.insertBefore(i,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function Sh(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function Ch(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var cf=null;function d1(i,o,u){if(cf===null){var p=new Map,y=cf=new Map;y.set(u,p)}else y=cf,p=y.get(u),p||(p=new Map,y.set(u,p));if(p.has(i))return p;for(p.set(i,null),u=u.getElementsByTagName(i),y=0;y<u.length;y++){var w=u[y];if(!(w[O]||w[on]||i==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=i+N;var L=p.get(N);L?L.push(w):p.set(N,[w])}}return p}function h1(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function yb(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function m1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var tc=null;function _b(){}function wb(i,o,u){if(tc===null)throw Error(r(475));var p=tc;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=To(u.href),w=i.querySelector(Ql(y));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=uf.bind(p),i.then(p,p)),o.state.loading|=4,o.instance=w,le(w);return}w=i.ownerDocument||i,u=u1(u),(y=Lr.get(y))&&Sh(u,y),w=w.createElement("link"),le(w);var N=w;N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),Dn(w,"link",u),o.instance=w}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=uf.bind(p),i.addEventListener("load",o),i.addEventListener("error",o))}}function Tb(){if(tc===null)throw Error(r(475));var i=tc;return i.stylesheets&&i.count===0&&bh(i,i.stylesheets),0<i.count?function(o){var u=setTimeout(function(){if(i.stylesheets&&bh(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(u)}}:null}function uf(){if(this.count--,this.count===0){if(this.stylesheets)bh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ff=null;function bh(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ff=new Map,o.forEach(Eb,i),ff=null,uf.call(i))}function Eb(i,o){if(!(o.state.loading&4)){var u=ff.get(i);if(u)var p=u.get(null);else{u=new Map,ff.set(i,u);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<y.length;w++){var N=y[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),p=N)}p&&u.set(null,p)}y=o.instance,N=y.getAttribute("data-precedence"),w=u.get(N)||p,w===p&&u.set(null,y),u.set(N,y),this.count++,p=uf.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),w?w.parentNode.insertBefore(y,w.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),o.state.loading|=4}}var nc={$$typeof:b,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function Sb(i,o,u,p,y,w,N,L){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$i(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$i(0),this.hiddenUpdates=$i(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function p1(i,o,u,p,y,w,N,L,ne,fe,Se,be){return i=new Sb(i,o,u,N,L,ne,fe,be),o=1,w===!0&&(o|=24),w=pr(3,null,null,o),i.current=w,w.stateNode=i,o=o0(),o.refCount++,i.pooledCache=o,o.refCount++,w.memoizedState={element:p,isDehydrated:u,cache:o},f0(w),i}function g1(i){return i?(i=Qs,i):Qs}function x1(i,o,u,p,y,w){y=g1(y),p.context===null?p.context=y:p.pendingContext=y,p=si(o),p.payload={element:u},w=w===void 0?null:w,w!==null&&(p.callback=w),u=oi(i,p,o),u!==null&&(_r(u,i,o),Dl(u,i,o))}function v1(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Ah(i,o){v1(i,o),(i=i.alternate)&&v1(i,o)}function y1(i){if(i.tag===13){var o=Zs(i,67108864);o!==null&&_r(o,i,67108864),Ah(i,67108864)}}var df=!0;function Cb(i,o,u,p){var y=ie.T;ie.T=null;var w=de.p;try{de.p=2,kh(i,o,u,p)}finally{de.p=w,ie.T=y}}function bb(i,o,u,p){var y=ie.T;ie.T=null;var w=de.p;try{de.p=8,kh(i,o,u,p)}finally{de.p=w,ie.T=y}}function kh(i,o,u,p){if(df){var y=Nh(p);if(y===null)ph(i,o,p,hf,u),w1(i,p);else if(kb(y,i,o,u,p))p.stopPropagation();else if(w1(i,p),o&4&&-1<Ab.indexOf(i)){for(;y!==null;){var w=Y(y);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=Ve(w.pendingLanes);if(N!==0){var L=w;for(L.pendingLanes|=2,L.entangledLanes|=2;N;){var ne=1<<31-Nt(N);L.entanglements[1]|=ne,N&=~ne}da(w),(Mt&6)===0&&(Ju=Me()+500,Jl(0))}}break;case 13:L=Zs(w,2),L!==null&&_r(L,w,2),Xu(),Ah(w,2)}if(w=Nh(p),w===null&&ph(i,o,p,hf,u),w===y)break;y=w}y!==null&&p.stopPropagation()}else ph(i,o,p,null,u)}}function Nh(i){return i=Fd(i),Rh(i)}var hf=null;function Rh(i){if(hf=null,i=q(i),i!==null){var o=s(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=l(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return hf=i,null}function _1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ft()){case pn:return 2;case sn:return 8;case en:case rr:return 32;case Pn:return 268435456;default:return 32}default:return 32}}var Mh=!1,_i=null,wi=null,Ti=null,rc=new Map,ac=new Map,Ei=[],Ab="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function w1(i,o){switch(i){case"focusin":case"focusout":_i=null;break;case"dragenter":case"dragleave":wi=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":rc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ac.delete(o.pointerId)}}function ic(i,o,u,p,y,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:w,targetContainers:[y]},o!==null&&(o=Y(o),o!==null&&y1(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),i)}function kb(i,o,u,p,y){switch(o){case"focusin":return _i=ic(_i,i,o,u,p,y),!0;case"dragenter":return wi=ic(wi,i,o,u,p,y),!0;case"mouseover":return Ti=ic(Ti,i,o,u,p,y),!0;case"pointerover":var w=y.pointerId;return rc.set(w,ic(rc.get(w)||null,i,o,u,p,y)),!0;case"gotpointercapture":return w=y.pointerId,ac.set(w,ic(ac.get(w)||null,i,o,u,p,y)),!0}return!1}function T1(i){var o=q(i.target);if(o!==null){var u=s(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){i.blockedOn=o,hl(i.priority,function(){if(u.tag===13){var p=yr();p=Gi(p);var y=Zs(u,p);y!==null&&_r(y,u,p),Ah(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function mf(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=Nh(i.nativeEvent);if(u===null){u=i.nativeEvent;var p=new u.constructor(u.type,u);Id=p,u.target.dispatchEvent(p),Id=null}else return o=Y(u),o!==null&&y1(o),i.blockedOn=u,!1;o.shift()}return!0}function E1(i,o,u){mf(i)&&u.delete(o)}function Nb(){Mh=!1,_i!==null&&mf(_i)&&(_i=null),wi!==null&&mf(wi)&&(wi=null),Ti!==null&&mf(Ti)&&(Ti=null),rc.forEach(E1),ac.forEach(E1)}function pf(i,o){i.blockedOn===o&&(i.blockedOn=null,Mh||(Mh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Nb)))}var gf=null;function S1(i){gf!==i&&(gf=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){gf===i&&(gf=null);for(var o=0;o<i.length;o+=3){var u=i[o],p=i[o+1],y=i[o+2];if(typeof p!="function"){if(Rh(p||u)===null)continue;break}var w=Y(u);w!==null&&(i.splice(o,3),o-=3,R0(w,{pending:!0,data:y,method:u.method,action:p},p,y))}}))}function sc(i){function o(ne){return pf(ne,i)}_i!==null&&pf(_i,i),wi!==null&&pf(wi,i),Ti!==null&&pf(Ti,i),rc.forEach(o),ac.forEach(o);for(var u=0;u<Ei.length;u++){var p=Ei[u];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Ei.length&&(u=Ei[0],u.blockedOn===null);)T1(u),u.blockedOn===null&&Ei.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var y=u[p],w=u[p+1],N=y[ln]||null;if(typeof w=="function")N||S1(u);else if(N){var L=null;if(w&&w.hasAttribute("formAction")){if(y=w,N=w[ln]||null)L=N.formAction;else if(Rh(y)!==null)continue}else L=N.action;typeof L=="function"?u[p+1]=L:(u.splice(p,3),p-=3),S1(u)}}}function Dh(i){this._internalRoot=i}xf.prototype.render=Dh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=yr();x1(u,p,i,o,null,null)},xf.prototype.unmount=Dh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;x1(i.current,2,null,i,null,null),Xu(),o[oa]=null}};function xf(i){this._internalRoot=i}xf.prototype.unstable_scheduleHydration=function(i){if(i){var o=$s();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ei.length&&o!==0&&o<Ei[u].priority;u++);Ei.splice(u,0,i),u===0&&T1(i)}};var C1=e.version;if(C1!=="19.1.0")throw Error(r(527,C1,"19.1.0"));de.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=d(o),i=i!==null?f(i):null,i=i===null?null:i.stateNode,i};var Rb={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vf.isDisabled&&vf.supportsFiber)try{gn=vf.inject(Rb),qt=vf}catch{}}return lc.createRoot=function(i,o){if(!a(i))throw Error(r(299));var u=!1,p="",y=Vx,w=Hx,N=$x,L=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(L=o.unstable_transitionCallbacks)),o=p1(i,1,!1,null,null,u,p,y,w,N,L,null),i[oa]=o.current,mh(i),new Dh(o)},lc.hydrateRoot=function(i,o,u){if(!a(i))throw Error(r(299));var p=!1,y="",w=Vx,N=Hx,L=$x,ne=null,fe=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(L=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ne=u.unstable_transitionCallbacks),u.formState!==void 0&&(fe=u.formState)),o=p1(i,1,!0,o,u??null,p,y,w,N,L,ne,fe),o.context=g1(null),u=o.current,p=yr(),p=Gi(p),y=si(p),y.callback=null,oi(u,y,p),u=p,o.current.lanes=u,Aa(o,u),da(o),i[oa]=o.current,mh(i),new xf(o)},lc.version="19.1.0",lc}var L1;function Vb(){if(L1)return Lh.exports;L1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Lh.exports=jb(),Lh.exports}var Hb=Vb();const $b=Xm(Hb);var cc={},P1;function Gb(){if(P1)return cc;P1=1,Object.defineProperty(cc,"__esModule",{value:!0}),cc.parse=l,cc.serialize=f;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function l(_,T){const E=new s,S=_.length;if(S<2)return E;const C=(T==null?void 0:T.decode)||g;let k=0;do{const A=_.indexOf("=",k);if(A===-1)break;const b=_.indexOf(";",k),D=b===-1?S:b;if(A>D){k=_.lastIndexOf(";",A-1)+1;continue}const B=c(_,k,A),G=d(_,A,B),F=_.slice(B,G);if(E[F]===void 0){let W=c(_,A+1,D),U=d(_,D,W);const ae=C(_.slice(W,U));E[F]=ae}k=D+1}while(k<S);return E}function c(_,T,E){do{const S=_.charCodeAt(T);if(S!==32&&S!==9)return T}while(++T<E);return E}function d(_,T,E){for(;T>E;){const S=_.charCodeAt(--T);if(S!==32&&S!==9)return T+1}return E}function f(_,T,E){const S=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const C=S(T);if(!e.test(C))throw new TypeError(`argument val is invalid: ${T}`);let k=_+"="+C;if(!E)return k;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);k+="; Max-Age="+E.maxAge}if(E.domain){if(!n.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);k+="; Domain="+E.domain}if(E.path){if(!r.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);k+="; Path="+E.path}if(E.expires){if(!v(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);k+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(k+="; HttpOnly"),E.secure&&(k+="; Secure"),E.partitioned&&(k+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return k}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function v(_){return a.call(_)==="[object Date]"}return cc}Gb();var O1="popstate";function zb(t={}){function e(r,a){let{pathname:s,search:l,hash:c}=r.location;return lm("",{pathname:s,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Pc(a)}return Yb(e,n,null,t)}function Wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ya(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qb(){return Math.random().toString(36).substring(2,10)}function U1(t,e){return{usr:t.state,key:t.key,idx:e}}function lm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?rl(e):e,state:n,key:e&&e.key||r||qb()}}function Pc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function rl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Yb(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:s=!1}=r,l=a.history,c="POP",d=null,f=g();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function g(){return(l.state||{idx:null}).idx}function v(){c="POP";let C=g(),k=C==null?null:C-f;f=C,d&&d({action:c,location:S.location,delta:k})}function _(C,k){c="PUSH";let A=lm(S.location,C,k);f=g()+1;let b=U1(A,f),D=S.createHref(A);try{l.pushState(b,"",D)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(D)}s&&d&&d({action:c,location:S.location,delta:1})}function T(C,k){c="REPLACE";let A=lm(S.location,C,k);f=g();let b=U1(A,f),D=S.createHref(A);l.replaceState(b,"",D),s&&d&&d({action:c,location:S.location,delta:0})}function E(C){return Wb(C)}let S={get action(){return c},get location(){return t(a,l)},listen(C){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(O1,v),d=C,()=>{a.removeEventListener(O1,v),d=null}},createHref(C){return e(a,C)},createURL:E,encodeLocation(C){let k=E(C);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:_,replace:T,go(C){return l.go(C)}};return S}function Wb(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Wt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Pc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function uT(t,e,n="/"){return Jb(t,e,n,!1)}function Jb(t,e,n,r){let a=typeof e=="string"?rl(e):e,s=Wa(a.pathname||"/",n);if(s==null)return null;let l=fT(t);Kb(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let f=oA(s);c=iA(l[d],f,r)}return c}function fT(t,e=[],n=[],r=""){let a=(s,l,c)=>{let d={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};d.relativePath.startsWith("/")&&(Wt(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let f=za([r,d.relativePath]),g=n.concat(d);s.children&&s.children.length>0&&(Wt(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),fT(s.children,e,g,f)),!(s.path==null&&!s.index)&&e.push({path:f,score:rA(f,s.index),routesMeta:g})};return t.forEach((s,l)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))a(s,l);else for(let d of dT(s.path))a(s,l,d)}),e}function dT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let l=dT(r.join("/")),c=[];return c.push(...l.map(d=>d===""?s:[s,d].join("/"))),a&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function Kb(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:aA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Xb=/^:[\w-]+$/,Zb=3,Qb=2,eA=1,tA=10,nA=-2,B1=t=>t==="*";function rA(t,e){let n=t.split("/"),r=n.length;return n.some(B1)&&(r+=nA),e&&(r+=Qb),n.filter(a=>!B1(a)).reduce((a,s)=>a+(Xb.test(s)?Zb:s===""?eA:tA),r)}function aA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function iA(t,e,n=!1){let{routesMeta:r}=t,a={},s="/",l=[];for(let c=0;c<r.length;++c){let d=r[c],f=c===r.length-1,g=s==="/"?e:e.slice(s.length)||"/",v=$f({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},g),_=d.route;if(!v&&f&&n&&!r[r.length-1].route.index&&(v=$f({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!v)return null;Object.assign(a,v.params),l.push({params:a,pathname:za([s,v.pathname]),pathnameBase:fA(za([s,v.pathnameBase])),route:_}),v.pathnameBase!=="/"&&(s=za([s,v.pathnameBase]))}return l}function $f(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=sA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((f,{paramName:g,isOptional:v},_)=>{if(g==="*"){let E=c[_]||"";l=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}const T=c[_];return v&&!T?f[g]=void 0:f[g]=(T||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:l,pattern:t}}function sA(t,e=!1,n=!0){ya(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function oA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ya(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Wa(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function lA(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?rl(t):t;return{pathname:n?n.startsWith("/")?n:cA(n,e):e,search:dA(r),hash:hA(a)}}function cA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Bh(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function uA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function hT(t){let e=uA(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function mT(t,e,n,r=!1){let a;typeof t=="string"?a=rl(t):(a={...t},Wt(!a.pathname||!a.pathname.includes("?"),Bh("?","pathname","search",a)),Wt(!a.pathname||!a.pathname.includes("#"),Bh("#","pathname","hash",a)),Wt(!a.search||!a.search.includes("#"),Bh("#","search","hash",a)));let s=t===""||a.pathname==="",l=s?"/":a.pathname,c;if(l==null)c=n;else{let v=e.length-1;if(!r&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),v-=1;a.pathname=_.join("/")}c=v>=0?e[v]:"/"}let d=lA(a,c),f=l&&l!=="/"&&l.endsWith("/"),g=(s||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||g)&&(d.pathname+="/"),d}var za=t=>t.join("/").replace(/\/\/+/g,"/"),fA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),dA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,hA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function mA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var pT=["POST","PUT","PATCH","DELETE"];new Set(pT);var pA=["GET",...pT];new Set(pA);var al=H.createContext(null);al.displayName="DataRouter";var md=H.createContext(null);md.displayName="DataRouterState";var gT=H.createContext({isTransitioning:!1});gT.displayName="ViewTransition";var gA=H.createContext(new Map);gA.displayName="Fetchers";var xA=H.createContext(null);xA.displayName="Await";var Ta=H.createContext(null);Ta.displayName="Navigation";var Zc=H.createContext(null);Zc.displayName="Location";var Ea=H.createContext({outlet:null,matches:[],isDataRoute:!1});Ea.displayName="Route";var Qm=H.createContext(null);Qm.displayName="RouteError";function vA(t,{relative:e}={}){Wt(Qc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=H.useContext(Ta),{hash:a,pathname:s,search:l}=eu(t,{relative:e}),c=s;return n!=="/"&&(c=s==="/"?n:za([n,s])),r.createHref({pathname:c,search:l,hash:a})}function Qc(){return H.useContext(Zc)!=null}function Rs(){return Wt(Qc(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Zc).location}var xT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vT(t){H.useContext(Ta).static||H.useLayoutEffect(t)}function yT(){let{isDataRoute:t}=H.useContext(Ea);return t?DA():yA()}function yA(){Wt(Qc(),"useNavigate() may be used only in the context of a <Router> component.");let t=H.useContext(al),{basename:e,navigator:n}=H.useContext(Ta),{matches:r}=H.useContext(Ea),{pathname:a}=Rs(),s=JSON.stringify(hT(r)),l=H.useRef(!1);return vT(()=>{l.current=!0}),H.useCallback((d,f={})=>{if(ya(l.current,xT),!l.current)return;if(typeof d=="number"){n.go(d);return}let g=mT(d,JSON.parse(s),a,f.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:za([e,g.pathname])),(f.replace?n.replace:n.push)(g,f.state,f)},[e,n,s,a,t])}H.createContext(null);function _A(){let{matches:t}=H.useContext(Ea),e=t[t.length-1];return e?e.params:{}}function eu(t,{relative:e}={}){let{matches:n}=H.useContext(Ea),{pathname:r}=Rs(),a=JSON.stringify(hT(n));return H.useMemo(()=>mT(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function wA(t,e){return _T(t,e)}function _T(t,e,n,r){var k;Wt(Qc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=H.useContext(Ta),{matches:s}=H.useContext(Ea),l=s[s.length-1],c=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",g=l&&l.route;{let A=g&&g.path||"";wT(d,!g||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let v=Rs(),_;if(e){let A=typeof e=="string"?rl(e):e;Wt(f==="/"||((k=A.pathname)==null?void 0:k.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${A.pathname}" was given in the \`location\` prop.`),_=A}else _=v;let T=_.pathname||"/",E=T;if(f!=="/"){let A=f.replace(/^\//,"").split("/");E="/"+T.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=uT(t,{pathname:E});ya(g||S!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),ya(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=bA(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},c,A.params),pathname:za([f,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?f:za([f,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),s,n,r);return e&&C?H.createElement(Zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},C):C}function TA(){let t=MA(),e=mA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=H.createElement(H.Fragment,null,H.createElement("p",null," Hey developer "),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:s},"ErrorBoundary")," or"," ",H.createElement("code",{style:s},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),n?H.createElement("pre",{style:a},n):null,l)}var EA=H.createElement(TA,null),SA=class extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?H.createElement(Ea.Provider,{value:this.props.routeContext},H.createElement(Qm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CA({routeContext:t,match:e,children:n}){let r=H.useContext(al);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(Ea.Provider,{value:t},n)}function bA(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,s=n==null?void 0:n.errors;if(s!=null){let d=a.findIndex(f=>f.route.id&&(s==null?void 0:s[f.route.id])!==void 0);Wt(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,c=-1;if(n)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=d),f.route.id){let{loaderData:g,errors:v}=n,_=f.route.loader&&!g.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||_){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,f,g)=>{let v,_=!1,T=null,E=null;n&&(v=s&&f.route.id?s[f.route.id]:void 0,T=f.route.errorElement||EA,l&&(c<0&&g===0?(wT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):c===g&&(_=!0,E=f.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,g+1)),C=()=>{let k;return v?k=T:_?k=E:f.route.Component?k=H.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,H.createElement(CA,{match:f,routeContext:{outlet:d,matches:S,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?H.createElement(SA,{location:n.location,revalidation:n.revalidation,component:T,error:v,children:C(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):C()},null)}function ep(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AA(t){let e=H.useContext(al);return Wt(e,ep(t)),e}function kA(t){let e=H.useContext(md);return Wt(e,ep(t)),e}function NA(t){let e=H.useContext(Ea);return Wt(e,ep(t)),e}function tp(t){let e=NA(t),n=e.matches[e.matches.length-1];return Wt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function RA(){return tp("useRouteId")}function MA(){var r;let t=H.useContext(Qm),e=kA("useRouteError"),n=tp("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function DA(){let{router:t}=AA("useNavigate"),e=tp("useNavigate"),n=H.useRef(!1);return vT(()=>{n.current=!0}),H.useCallback(async(a,s={})=>{ya(n.current,xT),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var j1={};function wT(t,e,n){!e&&!j1[t]&&(j1[t]=!0,ya(!1,n))}H.memo(IA);function IA({routes:t,future:e,state:n}){return _T(t,void 0,n,e)}function cm(t){Wt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function FA({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:s=!1}){Wt(!Qc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=H.useMemo(()=>({basename:l,navigator:a,static:s,future:{}}),[l,a,s]);typeof n=="string"&&(n=rl(n));let{pathname:d="/",search:f="",hash:g="",state:v=null,key:_="default"}=n,T=H.useMemo(()=>{let E=Wa(d,l);return E==null?null:{location:{pathname:E,search:f,hash:g,state:v,key:_},navigationType:r}},[l,d,f,g,v,_,r]);return ya(T!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:H.createElement(Ta.Provider,{value:c},H.createElement(Zc.Provider,{children:e,value:T}))}function LA({children:t,location:e}){return wA(um(t),e)}function um(t,e=[]){let n=[];return H.Children.forEach(t,(r,a)=>{if(!H.isValidElement(r))return;let s=[...e,a];if(r.type===H.Fragment){n.push.apply(n,um(r.props.children,s));return}Wt(r.type===cm,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Wt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=um(r.props.children,s)),n.push(l)}),n}var Uf="get",Bf="application/x-www-form-urlencoded";function pd(t){return t!=null&&typeof t.tagName=="string"}function PA(t){return pd(t)&&t.tagName.toLowerCase()==="button"}function OA(t){return pd(t)&&t.tagName.toLowerCase()==="form"}function UA(t){return pd(t)&&t.tagName.toLowerCase()==="input"}function BA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function jA(t,e){return t.button===0&&(!e||e==="_self")&&!BA(t)}var yf=null;function VA(){if(yf===null)try{new FormData(document.createElement("form"),0),yf=!1}catch{yf=!0}return yf}var HA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jh(t){return t!=null&&!HA.has(t)?(ya(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bf}"`),null):t}function $A(t,e){let n,r,a,s,l;if(OA(t)){let c=t.getAttribute("action");r=c?Wa(c,e):null,n=t.getAttribute("method")||Uf,a=jh(t.getAttribute("enctype"))||Bf,s=new FormData(t)}else if(PA(t)||UA(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||c.getAttribute("action");if(r=d?Wa(d,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||Uf,a=jh(t.getAttribute("formenctype"))||jh(c.getAttribute("enctype"))||Bf,s=new FormData(c,t),!VA()){let{name:f,type:g,value:v}=t;if(g==="image"){let _=f?`${f}.`:"";s.append(`${_}x`,"0"),s.append(`${_}y`,"0")}else f&&s.append(f,v)}}else{if(pd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Uf,r=null,a=Bf,l=t}return s&&a==="text/plain"&&(l=s,s=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:s,body:l}}function np(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function GA(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zA(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function qA(t,e,n){let r=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let l=await GA(s,n);return l.links?l.links():[]}return[]}));return KA(r.flat(1).filter(zA).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function V1(t,e,n,r,a,s){let l=(d,f)=>n[f]?d.route.id!==n[f].route.id:!0,c=(d,f)=>{var g;return n[f].pathname!==d.pathname||((g=n[f].route.path)==null?void 0:g.endsWith("*"))&&n[f].params["*"]!==d.params["*"]};return s==="assets"?e.filter((d,f)=>l(d,f)||c(d,f)):s==="data"?e.filter((d,f)=>{var v;let g=r.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(l(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let _=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function YA(t,e,{includeHydrateFallback:n}={}){return WA(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function WA(t){return[...new Set(t)]}function JA(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function KA(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let s=JSON.stringify(JA(a));return n.has(s)||(n.add(s),r.push({key:s,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var XA=new Set([100,101,204,205]);function ZA(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Wa(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function TT(){let t=H.useContext(al);return np(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function QA(){let t=H.useContext(md);return np(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rp=H.createContext(void 0);rp.displayName="FrameworkContext";function ET(){let t=H.useContext(rp);return np(t,"You must render this element inside a <HydratedRouter> element"),t}function ek(t,e){let n=H.useContext(rp),[r,a]=H.useState(!1),[s,l]=H.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:g,onTouchStart:v}=e,_=H.useRef(null);H.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let S=k=>{k.forEach(A=>{l(A.isIntersecting)})},C=new IntersectionObserver(S,{threshold:.5});return _.current&&C.observe(_.current),()=>{C.disconnect()}}},[t]),H.useEffect(()=>{if(r){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[r]);let T=()=>{a(!0)},E=()=>{a(!1),l(!1)};return n?t!=="intent"?[s,_,{}]:[s,_,{onFocus:uc(c,T),onBlur:uc(d,E),onMouseEnter:uc(f,T),onMouseLeave:uc(g,E),onTouchStart:uc(v,T)}]:[!1,_,{}]}function uc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function tk({page:t,...e}){let{router:n}=TT(),r=H.useMemo(()=>uT(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?H.createElement(rk,{page:t,matches:r,...e}):null}function nk(t){let{manifest:e,routeModules:n}=ET(),[r,a]=H.useState([]);return H.useEffect(()=>{let s=!1;return qA(t,e,n).then(l=>{s||a(l)}),()=>{s=!0}},[t,e,n]),r}function rk({page:t,matches:e,...n}){let r=Rs(),{manifest:a,routeModules:s}=ET(),{basename:l}=TT(),{loaderData:c,matches:d}=QA(),f=H.useMemo(()=>V1(t,e,d,a,r,"data"),[t,e,d,a,r]),g=H.useMemo(()=>V1(t,e,d,a,r,"assets"),[t,e,d,a,r]),v=H.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let E=new Set,S=!1;if(e.forEach(k=>{var b;let A=a.routes[k.route.id];!A||!A.hasLoader||(!f.some(D=>D.route.id===k.route.id)&&k.route.id in c&&((b=s[k.route.id])!=null&&b.shouldRevalidate)||A.hasClientLoader?S=!0:E.add(k.route.id))}),E.size===0)return[];let C=ZA(t,l);return S&&E.size>0&&C.searchParams.set("_routes",e.filter(k=>E.has(k.route.id)).map(k=>k.route.id).join(",")),[C.pathname+C.search]},[l,c,r,a,f,e,t,s]),_=H.useMemo(()=>YA(g,a),[g,a]),T=nk(g);return H.createElement(H.Fragment,null,v.map(E=>H.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...n})),_.map(E=>H.createElement("link",{key:E,rel:"modulepreload",href:E,...n})),T.map(({key:E,link:S})=>H.createElement("link",{key:E,...S})))}function ak(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var ST=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ST&&(window.__reactRouterVersion="7.6.3")}catch{}function ik({basename:t,children:e,window:n}){let r=H.useRef();r.current==null&&(r.current=zb({window:n,v5Compat:!0}));let a=r.current,[s,l]=H.useState({action:a.action,location:a.location}),c=H.useCallback(d=>{H.startTransition(()=>l(d))},[l]);return H.useLayoutEffect(()=>a.listen(c),[a,c]),H.createElement(FA,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var CT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bT=H.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:s,replace:l,state:c,target:d,to:f,preventScrollReset:g,viewTransition:v,..._},T){let{basename:E}=H.useContext(Ta),S=typeof f=="string"&&CT.test(f),C,k=!1;if(typeof f=="string"&&S&&(C=f,ST))try{let U=new URL(window.location.href),ae=f.startsWith("//")?new URL(U.protocol+f):new URL(f),z=Wa(ae.pathname,E);ae.origin===U.origin&&z!=null?f=z+ae.search+ae.hash:k=!0}catch{ya(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=vA(f,{relative:a}),[b,D,B]=ek(r,_),G=ck(f,{replace:l,state:c,target:d,preventScrollReset:g,relative:a,viewTransition:v});function F(U){e&&e(U),U.defaultPrevented||G(U)}let W=H.createElement("a",{..._,...B,href:C||A,onClick:k||s?e:F,ref:ak(T,D),target:d,"data-discover":!S&&n==="render"?"true":void 0});return b&&!S?H.createElement(H.Fragment,null,W,H.createElement(tk,{page:A})):W});bT.displayName="Link";var sk=H.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:s,to:l,viewTransition:c,children:d,...f},g){let v=eu(l,{relative:f.relative}),_=Rs(),T=H.useContext(md),{navigator:E,basename:S}=H.useContext(Ta),C=T!=null&&mk(v)&&c===!0,k=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,A=_.pathname,b=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(A=A.toLowerCase(),b=b?b.toLowerCase():null,k=k.toLowerCase()),b&&S&&(b=Wa(b,S)||b);const D=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let B=A===k||!a&&A.startsWith(k)&&A.charAt(D)==="/",G=b!=null&&(b===k||!a&&b.startsWith(k)&&b.charAt(k.length)==="/"),F={isActive:B,isPending:G,isTransitioning:C},W=B?e:void 0,U;typeof r=="function"?U=r(F):U=[r,B?"active":null,G?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let ae=typeof s=="function"?s(F):s;return H.createElement(bT,{...f,"aria-current":W,className:U,ref:g,style:ae,to:l,viewTransition:c},typeof d=="function"?d(F):d)});sk.displayName="NavLink";var ok=H.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:s,method:l=Uf,action:c,onSubmit:d,relative:f,preventScrollReset:g,viewTransition:v,..._},T)=>{let E=dk(),S=hk(c,{relative:f}),C=l.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&CT.test(c),A=b=>{if(d&&d(b),b.defaultPrevented)return;b.preventDefault();let D=b.nativeEvent.submitter,B=(D==null?void 0:D.getAttribute("formmethod"))||l;E(D||b.currentTarget,{fetcherKey:e,method:B,navigate:n,replace:a,state:s,relative:f,preventScrollReset:g,viewTransition:v})};return H.createElement("form",{ref:T,method:C,action:S,onSubmit:r?d:A,..._,"data-discover":!k&&t==="render"?"true":void 0})});ok.displayName="Form";function lk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AT(t){let e=H.useContext(al);return Wt(e,lk(t)),e}function ck(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:s,viewTransition:l}={}){let c=yT(),d=Rs(),f=eu(t,{relative:s});return H.useCallback(g=>{if(jA(g,e)){g.preventDefault();let v=n!==void 0?n:Pc(d)===Pc(f);c(t,{replace:v,state:r,preventScrollReset:a,relative:s,viewTransition:l})}},[d,c,f,n,r,e,t,a,s,l])}var uk=0,fk=()=>`__${String(++uk)}__`;function dk(){let{router:t}=AT("useSubmit"),{basename:e}=H.useContext(Ta),n=RA();return H.useCallback(async(r,a={})=>{let{action:s,method:l,encType:c,formData:d,body:f}=$A(r,e);if(a.navigate===!1){let g=a.fetcherKey||fk();await t.fetch(g,n,a.action||s,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function hk(t,{relative:e}={}){let{basename:n}=H.useContext(Ta),r=H.useContext(Ea);Wt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...eu(t||".",{relative:e})},l=Rs();if(t==null){s.search=l.search;let c=new URLSearchParams(s.search),d=c.getAll("index");if(d.some(g=>g==="")){c.delete("index"),d.filter(v=>v).forEach(v=>c.append("index",v));let g=c.toString();s.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:za([n,s.pathname])),Pc(s)}function mk(t,e={}){let n=H.useContext(gT);Wt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=AT("useViewTransitionState"),a=eu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=Wa(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Wa(n.nextLocation.pathname,r)||n.nextLocation.pathname;return $f(a.pathname,l)!=null||$f(a.pathname,s)!=null}[...XA];const pk="modulepreload",gk=function(t){return"/"+t},H1={},tu=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(f=>{if(f=gk(f),f in H1)return;H1[f]=!0;const g=f.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":pk,g||(_.as="script"),_.crossOrigin="",_.href=f,d&&_.setAttribute("nonce",d),document.head.appendChild(_),g)return new Promise((T,E)=>{_.addEventListener("load",T),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},xk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>il);return{default:r}},[]).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class ap extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class vk extends ap{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $1 extends ap{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class G1 extends ap{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var fm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(fm||(fm={}));var yk=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class _k{constructor(e,{headers:n={},customFetch:r,region:a=fm.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=xk(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return yk(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=n;let c={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const v=yield this.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new vk(S)}),_=v.headers.get("x-relay-error");if(_&&_==="true")throw new $1(v);if(!v.ok)throw new G1(v);let T=((r=v.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return T==="application/json"?E=yield v.json():T==="application/octet-stream"?E=yield v.blob():T==="text/event-stream"?E=v:T==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(a){return{data:null,error:a,response:a instanceof G1||a instanceof $1?a.context:void 0}}})}}var bn={},So={},Co={},bo={},Ao={},ko={},wk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yo=wk();const Tk=Yo.fetch,kT=Yo.fetch.bind(Yo),NT=Yo.Headers,Ek=Yo.Request,Sk=Yo.Response,il=Object.freeze(Object.defineProperty({__proto__:null,Headers:NT,Request:Ek,Response:Sk,default:kT,fetch:Tk},Symbol.toStringTag,{value:"Module"})),Ck=Db(il);var _f={},z1;function RT(){if(z1)return _f;z1=1,Object.defineProperty(_f,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return _f.default=t,_f}var q1;function MT(){if(q1)return ko;q1=1;var t=ko&&ko.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ko,"__esModule",{value:!0});const e=t(Ck),n=t(RT());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=Object.assign({},this.headers),this.headers[s]=l,this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,v,_;let T=null,E=null,S=null,C=f.status,k=f.statusText;if(f.ok){if(this.method!=="HEAD"){const B=await f.text();B===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=B:E=JSON.parse(B))}const b=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),D=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");b&&D&&D.length>1&&(S=parseInt(D[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(T={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,C=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const b=await f.text();try{T=JSON.parse(b),Array.isArray(T)&&f.status===404&&(E=[],T=null,C=200,k="OK")}catch{f.status===404&&b===""?(C=204,k="No Content"):T={message:b}}if(T&&this.isMaybeSingle&&(!((_=T==null?void 0:T.details)===null||_===void 0)&&_.includes("0 rows"))&&(T=null,C=200,k="OK"),T&&this.shouldThrowOnError)throw new n.default(T)}return{error:T,data:E,count:S,status:C,statusText:k}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,v,_;return{error:{message:`${(g=f==null?void 0:f.name)!==null&&g!==void 0?g:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(v=f==null?void 0:f.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=f==null?void 0:f.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),d.then(s,l)}returns(){return this}overrideTypes(){return this}}return ko.default=r,ko}var Y1;function DT(){if(Y1)return Ao;Y1=1;var t=Ao&&Ao.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ao,"__esModule",{value:!0});const e=t(MT());class n extends e.default{select(a){let s=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,s,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this.url.searchParams.set(f,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var g;const v=[a?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${_}"; options=${v};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ao.default=n,Ao}var W1;function ip(){if(W1)return bo;W1=1;var t=bo&&bo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(bo,"__esModule",{value:!0});const e=t(DT());class n extends e.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const l=Array.from(new Set(s)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${f}.${s}`),this}match(a){return Object.entries(a).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(a,s,l){return this.url.searchParams.append(a,`not.${s}.${l}`),this}or(a,{foreignTable:s,referencedTable:l=s}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,s,l){return this.url.searchParams.append(a,`${s}.${l}`),this}}return bo.default=n,bo}var J1;function IT(){if(J1)return Co;J1=1;var t=Co&&Co.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Co,"__esModule",{value:!0});const e=t(ip());class n{constructor(a,{headers:s={},schema:l,fetch:c}){this.url=a,this.headers=s,this.schema=l,this.fetch=c}select(a,{head:s=!1,count:l}={}){const c=s?"HEAD":"GET";let d=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:s,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),s&&d.push(`count=${s}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const f=a.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(f.length>0){const g=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const f="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),d||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const v=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(v.length>0){const _=[...new Set(v)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:s}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),s&&c.push(`count=${s}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const s="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Co.default=n,Co}var fc={},dc={},K1;function bk(){return K1||(K1=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.version=void 0,dc.version="0.0.0-automated"),dc}var X1;function Ak(){if(X1)return fc;X1=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.DEFAULT_HEADERS=void 0;const t=bk();return fc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},fc}var Z1;function kk(){if(Z1)return So;Z1=1;var t=So&&So.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(So,"__esModule",{value:!0});const e=t(IT()),n=t(ip()),r=Ak();class a{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:g}={}){let v;const _=new URL(`${this.url}/rpc/${l}`);let T;d||f?(v=d?"HEAD":"GET",Object.entries(c).filter(([S,C])=>C!==void 0).map(([S,C])=>[S,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([S,C])=>{_.searchParams.append(S,C)})):(v="POST",T=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:v,url:_,headers:E,schema:this.schemaName,body:T,fetch:this.fetch,allowEmpty:!1})}}return So.default=a,So}var Q1;function Nk(){if(Q1)return bn;Q1=1;var t=bn&&bn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(bn,"__esModule",{value:!0}),bn.PostgrestError=bn.PostgrestBuilder=bn.PostgrestTransformBuilder=bn.PostgrestFilterBuilder=bn.PostgrestQueryBuilder=bn.PostgrestClient=void 0;const e=t(kk());bn.PostgrestClient=e.default;const n=t(IT());bn.PostgrestQueryBuilder=n.default;const r=t(ip());bn.PostgrestFilterBuilder=r.default;const a=t(DT());bn.PostgrestTransformBuilder=a.default;const s=t(MT());bn.PostgrestBuilder=s.default;const l=t(RT());return bn.PostgrestError=l.default,bn.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:l.default},bn}var Rk=Nk();const Mk=Xm(Rk),{PostgrestClient:Dk,PostgrestQueryBuilder:hG,PostgrestFilterBuilder:mG,PostgrestTransformBuilder:pG,PostgrestBuilder:gG,PostgrestError:xG}=Mk;function Ik(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Fk=Ik(),Lk="2.11.15",Pk=`realtime-js/${Lk}`,Ok="1.0.0",FT=1e4,Uk=1e3;var Tc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Tc||(Tc={}));var jn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(jn||(jn={}));var Qr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Qr||(Qr={}));var dm;(function(t){t.websocket="websocket"})(dm||(dm={}));var ds;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ds||(ds={}));class Bk{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),s=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const d=r.decode(e.slice(l,l+s));l=l+s;const f=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class LT{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(jt||(jt={}));const ey=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,l)=>(s[l]=jk(l,t,e,a),s),{})},jk=(t,e,n,r)=>{const a=e.find(c=>c.name===t),s=a==null?void 0:a.type,l=n[t];return s&&!r.includes(s)?PT(s,l):hm(l)},PT=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Gk(e,n)}switch(t){case jt.bool:return Vk(e);case jt.float4:case jt.float8:case jt.int2:case jt.int4:case jt.int8:case jt.numeric:case jt.oid:return Hk(e);case jt.json:case jt.jsonb:return $k(e);case jt.timestamp:return zk(e);case jt.abstime:case jt.date:case jt.daterange:case jt.int4range:case jt.int8range:case jt.money:case jt.reltime:case jt.text:case jt.time:case jt.timestamptz:case jt.timetz:case jt.tsrange:case jt.tstzrange:return hm(e);default:return hm(e)}},hm=t=>t,Vk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Hk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},$k=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Gk=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const l=t.slice(1,n);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>PT(e,c))}return t},zk=t=>typeof t=="string"?t.replace(" ","T"):t,OT=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Vh{constructor(e,n,r={},a=FT){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ty;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ty||(ty={}));class Ec{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ec.syncState(this.state,a,s,l),this.pendingDiffs.forEach(d=>{this.state=Ec.syncDiff(this.state,d,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ec.syncDiff(this.state,a,s,l),c())}),this.onJoin((a,s,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:l})}),this.onLeave((a,s,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const s=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(s,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const v=s[f];if(v){const _=g.map(C=>C.presence_ref),T=v.map(C=>C.presence_ref),E=g.filter(C=>T.indexOf(C.presence_ref)<0),S=v.filter(C=>_.indexOf(C.presence_ref)<0);E.length>0&&(c[f]=E),S.length>0&&(d[f]=S)}else c[f]=g}),this.syncDiff(s,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:s,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(c,d)=>{var f;const g=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),g.length>0){const v=e[c].map(T=>T.presence_ref),_=g.filter(T=>v.indexOf(T.presence_ref)<0);e[c].unshift(..._)}r(c,g,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const g=d.map(v=>v.presence_ref);f=f.filter(v=>g.indexOf(v.presence_ref)<0),e[c]=f,a(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ny;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ny||(ny={}));var ry;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ry||(ry={}));var $a;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})($a||($a={}));class sp{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=jn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Vh(this,Qr.join,this.params,this.timeout),this.rejoinTimer=new LT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qr.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Ec(this),this.broadcastEndpointURL=OT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==jn.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e($a.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e($a.CLOSED));const d={},f={broadcast:s,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var v;if(this.socket.setAuth(),g===void 0){e==null||e($a.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,T=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,E=[];for(let S=0;S<T;S++){const C=_[S],{filter:{event:k,schema:A,table:b,filter:D}}=C,B=g&&g[S];if(B&&B.event===k&&B.schema===A&&B.table===b&&B.filter===D)E.push(Object.assign(Object.assign({},C),{id:B.id}));else{this.unsubscribe(),this.state=jn.errored,e==null||e($a.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e($a.SUBSCRIBED);return}}).receive("error",g=>{this.state=jn.errored,e==null||e($a.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e($a.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=jn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Vh(this,Qr.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(s),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Vh(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,s;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:g}=Qr;if(r&&[c,d,f,g].indexOf(l)>=0&&r!==this._joinRef())return;let _=this._onMessage(l,n,r);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var E,S,C;return((E=T.filter)===null||E===void 0?void 0:E.event)==="*"||((C=(S=T.filter)===null||S===void 0?void 0:S.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===l}).map(T=>T.callback(_,r)):(s=this.bindings[l])===null||s===void 0||s.filter(T=>{var E,S,C,k,A,b;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const D=T.id,B=(E=T.filter)===null||E===void 0?void 0:E.event;return D&&((S=n.ids)===null||S===void 0?void 0:S.includes(D))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((C=n.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const D=(A=(k=T==null?void 0:T.filter)===null||k===void 0?void 0:k.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return D==="*"||D===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:S,table:C,commit_timestamp:k,type:A,errors:b}=E;_=Object.assign(Object.assign({},{schema:S,table:C,commit_timestamp:k,eventType:A,new:{},old:{},errors:b}),this._getPayloadRecords(E))}T.callback(_,r)})}_isClosed(){return this.state===jn.closed}_isJoined(){return this.state===jn.joined}_isJoining(){return this.state===jn.joining}_isLeaving(){return this.state===jn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),s={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&sp.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Qr.close,{},e)}_onError(e){this._on(Qr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=ey(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=ey(e.columns,e.old_record)),n}}const ay=()=>{},qk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Yk{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=FT,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ay,this.ref=0,this.logger=ay,this.conn=null,this.sendBuffer=[],this.serializer=new Bk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let l;return s?l=s:typeof fetch>"u"?l=(...c)=>tu(async()=>{const{default:d}=await Promise.resolve().then(()=>il);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${dm.websocket}`,this.httpEndpoint=OT(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,l)=>l(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new LT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Fk),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ok}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Tc.connecting:return ds.Connecting;case Tc.open:return ds.Open;case Tc.closing:return ds.Closing;default:return ds.Closed}}isConnected(){return this.connectionState()===ds.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(s=>s.topic===r);if(a)return a;{const s=new sp(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:a,ref:s}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${s})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:Pk};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Qr.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Uk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:s,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,s),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,s,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Qr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([qk],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class op extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function An(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Wk extends op{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class mm extends op{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Jk=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const UT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>il);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Kk=()=>Jk(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield tu(()=>Promise.resolve().then(()=>il),void 0)).Response:Response}),pm=t=>{if(Array.isArray(t))return t.map(n=>pm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[a]=pm(r)}),e};var Ms=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const Hh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Xk=(t,e,n)=>Ms(void 0,void 0,void 0,function*(){const r=yield Kk();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new Wk(Hh(a),t.status||500))}).catch(a=>{e(new mm(Hh(a),a))}):e(new mm(Hh(t),t))}),Zk=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function nu(t,e,n,r,a,s){return Ms(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,Zk(e,r,a,s)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>Xk(d,c,r))})})}function Gf(t,e,n,r){return Ms(this,void 0,void 0,function*(){return nu(t,"GET",e,n,r)})}function Ai(t,e,n,r,a){return Ms(this,void 0,void 0,function*(){return nu(t,"POST",e,r,a,n)})}function Qk(t,e,n,r,a){return Ms(this,void 0,void 0,function*(){return nu(t,"PUT",e,r,a,n)})}function e4(t,e,n,r){return Ms(this,void 0,void 0,function*(){return nu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function BT(t,e,n,r,a){return Ms(this,void 0,void 0,function*(){return nu(t,"DELETE",e,r,a,n)})}var lr=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const t4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},iy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class n4{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=UT(a)}uploadOrUpdate(e,n,r,a){return lr(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},iy),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),d&&s.append("metadata",this.encodeMetadata(d)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",l.cacheControl),d&&s.append("metadata",this.encodeMetadata(d))):(s=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),v=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:s,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),_=yield v.json();return v.ok?{data:{path:f,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(s){if(An(s))return{data:null,error:s};throw s}})}upload(e,n,r){return lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return lr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let d;const f=Object.assign({upsert:iy.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",f.cacheControl)):(d=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const v=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:g}),_=yield v.json();return v.ok?{data:{path:s,fullPath:_.Key},error:null}:{data:null,error:_}}catch(d){if(An(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return lr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const s=yield Ai(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new op("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(An(r))return{data:null,error:r};throw r}})}update(e,n,r){return lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return lr(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(An(a))return{data:null,error:a};throw a}})}copy(e,n,r){return lr(this,void 0,void 0,function*(){try{return{data:{path:(yield Ai(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(An(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return lr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),s=yield Ai(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(a){if(An(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return lr(this,void 0,void 0,function*(){try{const a=yield Ai(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(a){if(An(a))return{data:null,error:a};throw a}})}download(e,n){return lr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=s?`?${s}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield Gf(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(An(c))return{data:null,error:c};throw c}})}info(e){return lr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Gf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:pm(r),error:null}}catch(r){if(An(r))return{data:null,error:r};throw r}})}exists(e){return lr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield e4(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(An(r)&&r instanceof mm){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&a.push(s);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(e){return lr(this,void 0,void 0,function*(){try{return{data:yield BT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(An(n))return{data:null,error:n};throw n}})}list(e,n,r){return lr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},t4),n),{prefix:e||""});return{data:yield Ai(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(An(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const r4="2.7.1",a4={"X-Client-Info":`storage-js/${r4}`};var No=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class i4{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},a4),n),this.fetch=UT(r)}listBuckets(){return No(this,void 0,void 0,function*(){try{return{data:yield Gf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(An(e))return{data:null,error:e};throw e}})}getBucket(e){return No(this,void 0,void 0,function*(){try{return{data:yield Gf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(An(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return No(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(An(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return No(this,void 0,void 0,function*(){try{return{data:yield Qk(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(An(r))return{data:null,error:r};throw r}})}emptyBucket(e){return No(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(An(n))return{data:null,error:n};throw n}})}deleteBucket(e){return No(this,void 0,void 0,function*(){try{return{data:yield BT(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(An(n))return{data:null,error:n};throw n}})}}class s4 extends i4{constructor(e,n={},r){super(e,n,r)}from(e){return new n4(this.url,this.headers,e,this.fetch)}}const o4="2.50.3";let mc="";typeof Deno<"u"?mc="deno":typeof document<"u"?mc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mc="react-native":mc="node";const l4={"X-Client-Info":`supabase-js-${mc}/${o4}`},c4={headers:l4},u4={schema:"public"},f4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},d4={};var h4=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const m4=t=>{let e;return t?e=t:typeof fetch>"u"?e=kT:e=fetch,(...n)=>e(...n)},p4=()=>typeof Headers>"u"?NT:Headers,g4=(t,e,n)=>{const r=m4(n),a=p4();return(s,l)=>h4(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),r(s,Object.assign(Object.assign({},l),{headers:f}))})};var x4=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};function v4(t){return t.endsWith("/")?t:t+"/"}function y4(t,e){var n,r;const{db:a,auth:s,realtime:l,global:c}=t,{db:d,auth:f,realtime:g,global:v}=e,_={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),s),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(n=v==null?void 0:v.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>x4(this,void 0,void 0,function*(){return""})};return t.accessToken?_.accessToken=t.accessToken:delete _.accessToken,_}const jT="2.70.0",Oo=30*1e3,gm=3,$h=gm*Oo,_4="http://localhost:9999",w4="supabase.auth.token",T4={"X-Client-Info":`gotrue-js/${jT}`},xm="X-Supabase-Api-Version",VT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},E4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,S4=6e5;class lp extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function it(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class C4 extends lp{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function b4(t){return it(t)&&t.name==="AuthApiError"}class HT extends lp{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ji extends lp{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class bi extends ji{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function A4(t){return it(t)&&t.name==="AuthSessionMissingError"}class wf extends ji{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Tf extends ji{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ef extends ji{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function k4(t){return it(t)&&t.name==="AuthImplicitGrantRedirectError"}class sy extends ji{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vm extends ji{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Gh(t){return it(t)&&t.name==="AuthRetryableFetchError"}class oy extends ji{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Sc extends ji{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const zf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ly=` 	
\r=`.split(""),N4=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ly.length;e+=1)t[ly[e].charCodeAt(0)]=-2;for(let e=0;e<zf.length;e+=1)t[zf[e].charCodeAt(0)]=e;return t})();function cy(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(zf[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(zf[r]),e.queuedBits-=6}}function $T(t,e,n){const r=N4[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function uy(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=l=>{D4(l,r,n)};for(let l=0;l<t.length;l+=1)$T(t.charCodeAt(l),a,s);return e.join("")}function R4(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function M4(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}R4(r,e)}}function D4(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function I4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)$T(t.charCodeAt(a),n,r);return new Uint8Array(e)}function F4(t){const e=[];return M4(t,n=>e.push(n)),new Uint8Array(e)}function L4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>cy(a,n,r)),cy(null,n,r),e.join("")}function P4(t){return Math.round(Date.now()/1e3)+t}function O4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Zr=()=>typeof window<"u"&&typeof document<"u",cs={tested:!1,writable:!1},Cc=()=>{if(!Zr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cs.tested)return cs.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),cs.tested=!0,cs.writable=!0}catch{cs.tested=!0,cs.writable=!1}return cs.writable};function U4(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,s)=>{e[s]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const GT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>il);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},B4=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",zT=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Sf=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Cf=async(t,e)=>{await t.removeItem(e)};class gd{constructor(){this.promise=new gd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}gd.promiseConstructor=Promise;function zh(t){const e=t.split(".");if(e.length!==3)throw new Sc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!E4.test(e[r]))throw new Sc("JWT not in base64url format");return{header:JSON.parse(uy(e[0])),payload:JSON.parse(uy(e[1])),signature:I4(e[2]),raw:{header:e[0],payload:e[1]}}}async function j4(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function V4(t,e){return new Promise((r,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await t(s);if(!e(s,null,l)){r(l);return}}catch(l){if(!e(s,l)){a(l);return}}})()})}function H4(t){return("0"+t.toString(16)).substr(-2)}function $4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let s=0;s<56;s++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,H4).join("")}async function G4(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function z4(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await G4(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ro(t,e,n=!1){const r=$4();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await zT(t,`${e}-code-verifier`,a);const s=await z4(r);return[s,r===s?"plain":"s256"]}const q4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Y4(t){const e=t.headers.get(xm);if(!e||!e.match(q4))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function W4(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function J4(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const K4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Mo(t){if(!K4.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var X4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const fs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Z4=[502,503,504];async function fy(t){var e;if(!B4(t))throw new vm(fs(t),0);if(Z4.includes(t.status))throw new vm(fs(t),t.status);let n;try{n=await t.json()}catch(s){throw new HT(fs(s),s)}let r;const a=Y4(t);if(a&&a.getTime()>=VT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new oy(fs(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new bi}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new oy(fs(n),t.status,n.weak_password.reasons);throw new C4(fs(n),t.status||500,r)}const Q4=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function pt(t,e,n,r){var a;const s=Object.assign({},r==null?void 0:r.headers);s[xm]||(s[xm]=VT["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await eN(t,e,n+c,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function eN(t,e,n,r,a,s){const l=Q4(e,r,a,s);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new vm(fs(d),0)}if(c.ok||await fy(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await fy(d)}}function Ha(t){var e;let n=null;aN(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=P4(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function dy(t){const e=Ha(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ni(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function tN(t){return{data:t,error:null}}function nN(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s}=t,l=X4(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function rN(t){return t}function aN(t){return t.access_token&&t.refresh_token&&t.expires_in}const qh=["global","local","others"];var iN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class sN{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=GT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=qh[0]){if(qh.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${qh.join(", ")}`);try{return await pt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await pt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ni})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=iN(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await pt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:nN,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(it(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await pt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ni})}catch(n){if(it(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,s,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},g=await pt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:rN});if(g.error)throw g.error;const v=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(d=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return T.length>0&&(T.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(E.split(";")[1].split("=")[1]);f[`${C}Page`]=S}),f.total=parseInt(_)),{data:Object.assign(Object.assign({},v),f),error:null}}catch(f){if(it(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Mo(e);try{return await pt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ni})}catch(n){if(it(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Mo(e);try{return await pt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ni})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Mo(e);try{return await pt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ni})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Mo(e.userId);try{const{data:n,error:r}=await pt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(it(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Mo(e.userId),Mo(e.id);try{return{data:await pt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}}}const oN={getItem:t=>Cc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Cc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Cc()&&globalThis.localStorage.removeItem(t)}};function hy(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function lN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Do={debug:!!(globalThis&&Cc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qT extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class cN extends qT{}async function uN(t,e,n){Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Do.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new cN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Do.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}lN();const fN={url:_4,storageKey:w4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:T4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function my(t,e,n){return await n()}class Oc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Oc.nextInstanceID,Oc.nextInstanceID+=1,this.instanceID>0&&Zr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},fN),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new sN({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=GT(a.fetch),this.lock=a.lock||my,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Zr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=uN:this.lock=my,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Cc()?this.storage=oN:(this.memoryStorage={},this.storage=hy(this.memoryStorage)):(this.memoryStorage={},this.storage=hy(this.memoryStorage)),Zr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${jT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=U4(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Zr()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),k4(s)){const d=(e=s.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return it(n)?{error:n}:{error:new HT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const s=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ha}),{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(s){if(it(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,a;try{let s;if("email"in e){const{email:g,password:v,options:_}=e;let T=null,E=null;this.flowType==="pkce"&&([T,E]=await Ro(this.storage,this.storageKey)),s=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:g,password:v,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:T,code_challenge_method:E},xform:Ha})}else if("phone"in e){const{phone:g,password:v,options:_}=e;s=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(a=_==null?void 0:_.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:Ha})}else throw new Tf("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(s){if(it(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:l,options:c}=e;n=await pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:dy})}else if("phone"in e){const{phone:s,password:l,options:c}=e;n=await pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:dy})}else throw new Tf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new wf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(it(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,s,l,c,d,f,g,v,_,T;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:C,wallet:k,statement:A,options:b}=e;let D;if(Zr())if(typeof k=="object")D=k;else{const G=window;if("solana"in G&&typeof G.solana=="object"&&("signIn"in G.solana&&typeof G.solana.signIn=="function"||"signMessage"in G.solana&&typeof G.solana.signMessage=="function"))D=G.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=k}const B=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in D&&D.signIn){const G=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),A?{statement:A}:null));let F;if(Array.isArray(G)&&G[0]&&typeof G[0]=="object")F=G[0];else if(G&&typeof G=="object"&&"signedMessage"in G&&"signature"in G)F=G;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)E=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),S=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in D)||typeof D.signMessage!="function"||!("publicKey"in D)||typeof D!="object"||!D.publicKey||!("toBase58"in D.publicKey)||typeof D.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${B.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(a=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((f=b==null?void 0:b.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((v=(g=b==null?void 0:b.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...b.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const G=await D.signMessage(new TextEncoder().encode(E),"utf8");if(!G||!(G instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=G}}try{const{data:C,error:k}=await pt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:L4(S)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:Ha});if(k)throw k;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new wf}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:k})}catch(C){if(it(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(e){const n=await Sf(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:s,error:l}=await pt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ha});if(await Cf(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new wf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:l})}catch(s){if(it(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:s,nonce:l}=e,c=await pt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ha}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new wf}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(n){if(it(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,s,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Ro(this.storage,this.storageKey));const{error:v}=await pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:g}=await pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g}}throw new Tf("You must provide either an email or phone number.")}catch(c){if(it(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,s;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await pt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Ha});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(it(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=await Ro(this.storage,this.storageKey)),await pt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:tN})}catch(s){if(it(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new bi;const{error:a}=await pt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(it(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:s}=e,{error:l}=await pt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:s}=e,{data:l,error:c}=await pt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new Tf("You must provide either an email or phone number and a type")}catch(n){if(it(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Sf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$h:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:e},error:null}}const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ni}):await this._useSession(async n=>{var r,a,s;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new bi}:await pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Ni})})}catch(n){if(it(n))return A4(n)&&(await this._removeSession(),await Cf(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new bi;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await Ro(this.storage,this.storageKey));const{data:f,error:g}=await pt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Ni});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new bi;const n=Date.now()/1e3;let r=n,a=!0,s=null;const{payload:l}=zh(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(it(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new bi;const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(it(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Zr())throw new Ef("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ef(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new sy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ef("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sy("No code detected.");const{data:A,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!s||!c||!l||!f)throw new Ef("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(c);let _=g+v;d&&(_=parseInt(d));const T=_-g;T*1e3<=Oo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${v}s`);const E=_-v;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,g);const{data:S,error:C}=await this._getUser(s);if(C)throw C;const k={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:v,expires_at:_,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:e.type},error:null}}catch(r){if(it(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Sf(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{error:s};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(b4(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Cf(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=O4(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:s},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Ro(this.storage,this.storageKey,!0));try{return await pt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(it(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async s=>{var l,c,d,f,g;const{data:v,error:_}=s;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await pt(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(f=v.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return Zr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(it(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:l}=n;if(l)throw l;return await pt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(it(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await V4(async a=>(a>0&&await j4(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await pt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ha})),(a,s)=>{const l=200*Math.pow(2,a);return s&&Gh(s)&&Date.now()+l-r<Oo})}catch(r){if(this._debug(n,"error",r),it(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Zr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Sf(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<$h;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${$h}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),Gh(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new bi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new gd;const{data:s,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!s.session)throw new bi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(a,"error",s),it(s)){const l={session:null,error:s};return Gh(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){s.push(d)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await zT(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Cf(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Zr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Oo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Oo}ms, refresh threshold is ${gm} ticks`),a<=gm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof qT)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,l]=await Ro(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);a.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await pt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(it(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await pt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(it(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{data:null,error:s};const{data:l,error:c}=await pt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(it(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await pt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(it(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:s}=e;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=zh(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+S4>Date.now()))return r;const{data:a,error:s}=await pt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new Sc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(l=>l.kid===e),!r)throw new Sc("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:T,error:E}=await this.getSession();if(E||!T.session)return{data:null,error:E};r=T.session.access_token}const{header:a,payload:s,signature:l,raw:{header:c,payload:d}}=zh(r);if(W4(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:T}=await this.getUser(r);if(T)throw T;return{data:{claims:s,header:a,signature:l},error:null}}const f=J4(a.alg),g=await this.fetchJwk(a.kid,n),v=await crypto.subtle.importKey("jwk",g,f,!0,["verify"]);if(!await crypto.subtle.verify(f,v,l,F4(`${c}.${d}`)))throw new Sc("Invalid JWT signature");return{data:{claims:s,header:a,signature:l},error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}}}Oc.nextInstanceID=0;const dN=Oc;class hN extends dN{constructor(e){super(e)}}var mN=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?s(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class pN{constructor(e,n,r){var a,s,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=v4(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,g={db:u4,realtime:d4,auth:Object.assign(Object.assign({},f4),{storageKey:f}),global:c4},v=y4(r??{},g);this.storageKey=(a=v.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=v.global.headers)!==null&&s!==void 0?s:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=g4(n,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new Dk(new URL("rest/v1",d).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),v.accessToken||this._listenForAuthEvents()}get functions(){return new _k(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new s4(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return mN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:s,flowType:l,lock:c,debug:d},f,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hN({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Yk(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const gN=(t,e,n)=>new pN(t,e,n),xN="https://znpylxcqmerkfinbzoge.supabase.co",vN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpucHlseGNxbWVya2ZpbmJ6b2dlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwMjYyNjQsImV4cCI6MjA2NzYwMjI2NH0.6kHzp3nPH3nIP9NJ7M9-lT_OtUHLjifM86ryjfCa65I",rt=gN(xN,vN);var Wo=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t))(Wo||{}),ym=(t=>(t.PENDING="pending",t.ACHIEVED="achieved",t.MISSED="missed",t))(ym||{}),ms=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t.BLOCKED="Blocked",t))(ms||{}),ma=(t=>(t[t.INPUT_FORM=0]="INPUT_FORM",t[t.PROJECT_FLOW=1]="PROJECT_FLOW",t[t.TASK_DETAIL=2]="TASK_DETAIL",t))(ma||{}),St;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const s={};for(const l of a)s[l]=l;return s},t.getValidEnumValues=a=>{const s=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of s)l[c]=a[c];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(s){return a[s]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const s=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&s.push(l);return s},t.find=(a,s)=>{for(const l of a)if(s(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,s=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(a,s)=>typeof s=="bigint"?s.toString():s})(St||(St={}));var py;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(py||(py={}));const Ue=St.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ki=t=>{switch(typeof t){case"undefined":return Ue.undefined;case"string":return Ue.string;case"number":return Number.isNaN(t)?Ue.nan:Ue.number;case"boolean":return Ue.boolean;case"function":return Ue.function;case"bigint":return Ue.bigint;case"symbol":return Ue.symbol;case"object":return Array.isArray(t)?Ue.array:t===null?Ue.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Ue.promise:typeof Map<"u"&&t instanceof Map?Ue.map:typeof Set<"u"&&t instanceof Set?Ue.set:typeof Date<"u"&&t instanceof Date?Ue.date:Ue.object;default:return Ue.unknown}},Ie=St.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ja extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},a=s=>{for(const l of s.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),r}static assert(e){if(!(e instanceof Ja))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,St.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const s=a.path[0];n[s]=n[s]||[],n[s].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ja.create=t=>new Ja(t);const _m=(t,e)=>{let n;switch(t.code){case Ie.invalid_type:t.received===Ue.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Ie.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,St.jsonStringifyReplacer)}`;break;case Ie.unrecognized_keys:n=`Unrecognized key(s) in object: ${St.joinValues(t.keys,", ")}`;break;case Ie.invalid_union:n="Invalid input";break;case Ie.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${St.joinValues(t.options)}`;break;case Ie.invalid_enum_value:n=`Invalid enum value. Expected ${St.joinValues(t.options)}, received '${t.received}'`;break;case Ie.invalid_arguments:n="Invalid function arguments";break;case Ie.invalid_return_type:n="Invalid function return type";break;case Ie.invalid_date:n="Invalid date";break;case Ie.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:St.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Ie.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Ie.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Ie.custom:n="Invalid input";break;case Ie.invalid_intersection_types:n="Intersection results could not be merged";break;case Ie.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Ie.not_finite:n="Number must be finite";break;default:n=e.defaultError,St.assertNever(t)}return{message:n}};let yN=_m;function _N(){return yN}const wN=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,s=[...n,...a.path||[]],l={...a,path:s};if(a.message!==void 0)return{...a,path:s,message:a.message};let c="";const d=r.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:s,message:c}};function Pe(t,e){const n=_N(),r=wN({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===_m?void 0:_m].filter(a=>!!a)});t.common.issues.push(r)}class tr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return et;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const s=await a.key,l=await a.value;r.push({key:s,value:l})}return tr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:s,value:l}=a;if(s.status==="aborted"||l.status==="aborted")return et;s.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[s.value]=l.value)}return{status:e.value,value:r}}}const et=Object.freeze({status:"aborted"}),pc=t=>({status:"dirty",value:t}),Vr=t=>({status:"valid",value:t}),gy=t=>t.status==="aborted",xy=t=>t.status==="dirty",Jo=t=>t.status==="valid",qf=t=>typeof Promise<"u"&&t instanceof Promise;var Be;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Be||(Be={}));class _a{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const vy=(t,e)=>{if(Jo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ja(t.common.issues);return this._error=n,this._error}}};function lt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??n??c.defaultError}},description:a}}class xt{get description(){return this._def.description}_getType(e){return ki(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ki(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tr,ctx:{common:e.parent.common,data:e.data,parsedType:ki(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(qf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ki(e)},a=this._parseSync({data:e,path:r.path,parent:r});return vy(r,a)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ki(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:n});return Jo(s)?{value:s.value}:{issues:n.common.issues}}catch(s){(a=(r=s==null?void 0:s.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>Jo(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ki(e)},a=this._parse({data:e,path:r.path,parent:r}),s=await(qf(a)?a:Promise.resolve(a));return vy(r,s)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,s)=>{const l=e(a),c=()=>s.addIssue({code:Ie.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new Zo({schema:this,typeName:Ze.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ii.create(this,this._def)}nullable(){return Qo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return va.create(this)}promise(){return Xf.create(this,this._def)}or(e){return Wf.create([this,e],this._def)}and(e){return Jf.create(this,e,this._def)}transform(e){return new Zo({...lt(this._def),schema:this,typeName:Ze.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Sm({...lt(this._def),innerType:this,defaultValue:n,typeName:Ze.ZodDefault})}brand(){return new GN({typeName:Ze.ZodBranded,type:this,...lt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Cm({...lt(this._def),innerType:this,catchValue:n,typeName:Ze.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return cp.create(this,e)}readonly(){return bm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const TN=/^c[^\s-]{8,}$/i,EN=/^[0-9a-z]+$/,SN=/^[0-9A-HJKMNP-TV-Z]{26}$/i,CN=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bN=/^[a-z0-9_-]{21}$/i,AN=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,kN=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,NN=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,RN="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Yh;const MN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,DN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,IN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,FN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,LN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,PN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,YT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ON=new RegExp(`^${YT}$`);function WT(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function UN(t){return new RegExp(`^${WT(t)}$`)}function BN(t){let e=`${YT}T${WT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function jN(t,e){return!!((e==="v4"||!e)&&MN.test(t)||(e==="v6"||!e)&&IN.test(t))}function VN(t,e){if(!AN.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function HN(t,e){return!!((e==="v4"||!e)&&DN.test(t)||(e==="v6"||!e)&&FN.test(t))}class ga extends xt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ue.string){const s=this._getOrReturnCtx(e);return Pe(s,{code:Ie.invalid_type,expected:Ue.string,received:s.parsedType}),et}const r=new tr;let a;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const l=e.data.length>s.value,c=e.data.length<s.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?Pe(a,{code:Ie.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):c&&Pe(a,{code:Ie.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")NN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"email",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")Yh||(Yh=new RegExp(RN,"u")),Yh.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"emoji",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")CN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"uuid",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")bN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"nanoid",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")TN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"cuid",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")EN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"cuid2",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")SN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"ulid",code:Ie.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Pe(a,{validation:"url",code:Ie.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"regex",code:Ie.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?BN(s).test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?ON.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?UN(s).test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?kN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"duration",code:Ie.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?jN(e.data,s.version)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"ip",code:Ie.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?VN(e.data,s.alg)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"jwt",code:Ie.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?HN(e.data,s.version)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"cidr",code:Ie.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?LN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"base64",code:Ie.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?PN.test(e.data)||(a=this._getOrReturnCtx(e,a),Pe(a,{validation:"base64url",code:Ie.invalid_string,message:s.message}),r.dirty()):St.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Ie.invalid_string,...Be.errToObj(r)})}_addCheck(e){return new ga({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Be.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Be.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Be.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Be.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Be.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Be.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Be.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Be.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Be.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Be.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Be.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Be.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Be.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Be.errToObj(n)})}nonempty(e){return this.min(1,Be.errToObj(e))}trim(){return new ga({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ga({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ga({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ga.create=t=>new ga({checks:[],typeName:Ze.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...lt(t)});function $N(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,s=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return s%l/10**a}class _s extends xt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ue.number){const s=this._getOrReturnCtx(e);return Pe(s,{code:Ie.invalid_type,expected:Ue.number,received:s.parsedType}),et}let r;const a=new tr;for(const s of this._def.checks)s.kind==="int"?St.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.invalid_type,expected:"integer",received:"float",message:s.message}),a.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty()):s.kind==="multipleOf"?$N(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.not_multiple_of,multipleOf:s.value,message:s.message}),a.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.not_finite,message:s.message}),a.dirty()):St.assertNever(s);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Be.toString(n))}setLimit(e,n,r,a){return new _s({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Be.toString(a)}]})}_addCheck(e){return new _s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Be.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&St.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}_s.create=t=>new _s({checks:[],typeName:Ze.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...lt(t)});class ws extends xt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Ue.bigint)return this._getInvalidInput(e);let r;const a=new tr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),a.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),a.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:Ie.not_multiple_of,multipleOf:s.value,message:s.message}),a.dirty()):St.assertNever(s);return{status:a.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Pe(n,{code:Ie.invalid_type,expected:Ue.bigint,received:n.parsedType}),et}gte(e,n){return this.setLimit("min",e,!0,Be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Be.toString(n))}setLimit(e,n,r,a){return new ws({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Be.toString(a)}]})}_addCheck(e){return new ws({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ws.create=t=>new ws({checks:[],typeName:Ze.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...lt(t)});class Yf extends xt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ue.boolean){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.boolean,received:r.parsedType}),et}return Vr(e.data)}}Yf.create=t=>new Yf({typeName:Ze.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...lt(t)});class Ko extends xt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ue.date){const s=this._getOrReturnCtx(e);return Pe(s,{code:Ie.invalid_type,expected:Ue.date,received:s.parsedType}),et}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Pe(s,{code:Ie.invalid_date}),et}const r=new tr;let a;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(a=this._getOrReturnCtx(e,a),Pe(a,{code:Ie.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):St.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ko({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Be.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Be.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Ko.create=t=>new Ko({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ze.ZodDate,...lt(t)});class yy extends xt{_parse(e){if(this._getType(e)!==Ue.symbol){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.symbol,received:r.parsedType}),et}return Vr(e.data)}}yy.create=t=>new yy({typeName:Ze.ZodSymbol,...lt(t)});class _y extends xt{_parse(e){if(this._getType(e)!==Ue.undefined){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.undefined,received:r.parsedType}),et}return Vr(e.data)}}_y.create=t=>new _y({typeName:Ze.ZodUndefined,...lt(t)});class wy extends xt{_parse(e){if(this._getType(e)!==Ue.null){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.null,received:r.parsedType}),et}return Vr(e.data)}}wy.create=t=>new wy({typeName:Ze.ZodNull,...lt(t)});class Ty extends xt{constructor(){super(...arguments),this._any=!0}_parse(e){return Vr(e.data)}}Ty.create=t=>new Ty({typeName:Ze.ZodAny,...lt(t)});class wm extends xt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Vr(e.data)}}wm.create=t=>new wm({typeName:Ze.ZodUnknown,...lt(t)});class Pi extends xt{_parse(e){const n=this._getOrReturnCtx(e);return Pe(n,{code:Ie.invalid_type,expected:Ue.never,received:n.parsedType}),et}}Pi.create=t=>new Pi({typeName:Ze.ZodNever,...lt(t)});class Ey extends xt{_parse(e){if(this._getType(e)!==Ue.undefined){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.void,received:r.parsedType}),et}return Vr(e.data)}}Ey.create=t=>new Ey({typeName:Ze.ZodVoid,...lt(t)});class va extends xt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==Ue.array)return Pe(n,{code:Ie.invalid_type,expected:Ue.array,received:n.parsedType}),et;if(a.exactLength!==null){const l=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(l||c)&&(Pe(n,{code:l?Ie.too_big:Ie.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Pe(n,{code:Ie.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Pe(n,{code:Ie.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>a.type._parseAsync(new _a(n,l,n.path,c)))).then(l=>tr.mergeArray(r,l));const s=[...n.data].map((l,c)=>a.type._parseSync(new _a(n,l,n.path,c)));return tr.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new va({...this._def,minLength:{value:e,message:Be.toString(n)}})}max(e,n){return new va({...this._def,maxLength:{value:e,message:Be.toString(n)}})}length(e,n){return new va({...this._def,exactLength:{value:e,message:Be.toString(n)}})}nonempty(e){return this.min(1,e)}}va.create=(t,e)=>new va({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ze.ZodArray,...lt(e)});function Uo(t){if(t instanceof mn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ii.create(Uo(r))}return new mn({...t._def,shape:()=>e})}else return t instanceof va?new va({...t._def,type:Uo(t.element)}):t instanceof Ii?Ii.create(Uo(t.unwrap())):t instanceof Qo?Qo.create(Uo(t.unwrap())):t instanceof Ts?Ts.create(t.items.map(e=>Uo(e))):t}class mn extends xt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=St.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==Ue.object){const f=this._getOrReturnCtx(e);return Pe(f,{code:Ie.invalid_type,expected:Ue.object,received:f.parsedType}),et}const{status:r,ctx:a}=this._processInputParams(e),{shape:s,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof Pi&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const g=s[f],v=a.data[f];d.push({key:{status:"valid",value:f},value:g._parse(new _a(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof Pi){const f=this._def.unknownKeys;if(f==="passthrough")for(const g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(f==="strict")c.length>0&&(Pe(a,{code:Ie.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const g of c){const v=a.data[g];d.push({key:{status:"valid",value:g},value:f._parse(new _a(a,v,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const g of d){const v=await g.key,_=await g.value;f.push({key:v,value:_,alwaysSet:g.alwaysSet})}return f}).then(f=>tr.mergeObjectSync(r,f)):tr.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return Be.errToObj,new mn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,l;const a=((l=(s=this._def).errorMap)==null?void 0:l.call(s,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Be.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new mn({...this._def,unknownKeys:"strip"})}passthrough(){return new mn({...this._def,unknownKeys:"passthrough"})}extend(e){return new mn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new mn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ze.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new mn({...this._def,catchall:e})}pick(e){const n={};for(const r of St.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new mn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of St.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new mn({...this._def,shape:()=>n})}deepPartial(){return Uo(this)}partial(e){const n={};for(const r of St.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}return new mn({...this._def,shape:()=>n})}required(e){const n={};for(const r of St.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Ii;)s=s._def.innerType;n[r]=s}return new mn({...this._def,shape:()=>n})}keyof(){return JT(St.objectKeys(this.shape))}}mn.create=(t,e)=>new mn({shape:()=>t,unknownKeys:"strip",catchall:Pi.create(),typeName:Ze.ZodObject,...lt(e)});mn.strictCreate=(t,e)=>new mn({shape:()=>t,unknownKeys:"strict",catchall:Pi.create(),typeName:Ze.ZodObject,...lt(e)});mn.lazycreate=(t,e)=>new mn({shape:t,unknownKeys:"strip",catchall:Pi.create(),typeName:Ze.ZodObject,...lt(e)});class Wf extends xt{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(s){for(const c of s)if(c.result.status==="valid")return c.result;for(const c of s)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=s.map(c=>new Ja(c.ctx.common.issues));return Pe(n,{code:Ie.invalid_union,unionErrors:l}),et}if(n.common.async)return Promise.all(r.map(async s=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(a);{let s;const l=[];for(const d of r){const f={...n,common:{...n.common,issues:[]},parent:null},g=d._parseSync({data:n.data,path:n.path,parent:f});if(g.status==="valid")return g;g.status==="dirty"&&!s&&(s={result:g,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const c=l.map(d=>new Ja(d));return Pe(n,{code:Ie.invalid_union,unionErrors:c}),et}}get options(){return this._def.options}}Wf.create=(t,e)=>new Wf({options:t,typeName:Ze.ZodUnion,...lt(e)});function Tm(t,e){const n=ki(t),r=ki(e);if(t===e)return{valid:!0,data:t};if(n===Ue.object&&r===Ue.object){const a=St.objectKeys(e),s=St.objectKeys(t).filter(c=>a.indexOf(c)!==-1),l={...t,...e};for(const c of s){const d=Tm(t[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(n===Ue.array&&r===Ue.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let s=0;s<t.length;s++){const l=t[s],c=e[s],d=Tm(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===Ue.date&&r===Ue.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Jf extends xt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(s,l)=>{if(gy(s)||gy(l))return et;const c=Tm(s.value,l.value);return c.valid?((xy(s)||xy(l))&&n.dirty(),{status:n.value,value:c.data}):(Pe(r,{code:Ie.invalid_intersection_types}),et)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,l])=>a(s,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Jf.create=(t,e,n)=>new Jf({left:t,right:e,typeName:Ze.ZodIntersection,...lt(n)});class Ts extends xt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ue.array)return Pe(r,{code:Ie.invalid_type,expected:Ue.array,received:r.parsedType}),et;if(r.data.length<this._def.items.length)return Pe(r,{code:Ie.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),et;!this._def.rest&&r.data.length>this._def.items.length&&(Pe(r,{code:Ie.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new _a(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(s).then(l=>tr.mergeArray(n,l)):tr.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Ts({...this._def,rest:e})}}Ts.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ts({items:t,typeName:Ze.ZodTuple,rest:null,...lt(e)})};class Kf extends xt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ue.object)return Pe(r,{code:Ie.invalid_type,expected:Ue.object,received:r.parsedType}),et;const a=[],s=this._def.keyType,l=this._def.valueType;for(const c in r.data)a.push({key:s._parse(new _a(r,c,r.path,c)),value:l._parse(new _a(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?tr.mergeObjectAsync(n,a):tr.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof xt?new Kf({keyType:e,valueType:n,typeName:Ze.ZodRecord,...lt(r)}):new Kf({keyType:ga.create(),valueType:e,typeName:Ze.ZodRecord,...lt(n)})}}class Sy extends xt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ue.map)return Pe(r,{code:Ie.invalid_type,expected:Ue.map,received:r.parsedType}),et;const a=this._def.keyType,s=this._def.valueType,l=[...r.data.entries()].map(([c,d],f)=>({key:a._parse(new _a(r,c,r.path,[f,"key"])),value:s._parse(new _a(r,d,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,g=await d.value;if(f.status==="aborted"||g.status==="aborted")return et;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,g=d.value;if(f.status==="aborted"||g.status==="aborted")return et;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}}}}Sy.create=(t,e,n)=>new Sy({valueType:e,keyType:t,typeName:Ze.ZodMap,...lt(n)});class Uc extends xt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ue.set)return Pe(r,{code:Ie.invalid_type,expected:Ue.set,received:r.parsedType}),et;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Pe(r,{code:Ie.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Pe(r,{code:Ie.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const s=this._def.valueType;function l(d){const f=new Set;for(const g of d){if(g.status==="aborted")return et;g.status==="dirty"&&n.dirty(),f.add(g.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((d,f)=>s._parse(new _a(r,d,r.path,f)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,n){return new Uc({...this._def,minSize:{value:e,message:Be.toString(n)}})}max(e,n){return new Uc({...this._def,maxSize:{value:e,message:Be.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Uc.create=(t,e)=>new Uc({valueType:t,minSize:null,maxSize:null,typeName:Ze.ZodSet,...lt(e)});class Em extends xt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Em.create=(t,e)=>new Em({getter:t,typeName:Ze.ZodLazy,...lt(e)});class Cy extends xt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Pe(n,{received:n.data,code:Ie.invalid_literal,expected:this._def.value}),et}return{status:"valid",value:e.data}}get value(){return this._def.value}}Cy.create=(t,e)=>new Cy({value:t,typeName:Ze.ZodLiteral,...lt(e)});function JT(t,e){return new Xo({values:t,typeName:Ze.ZodEnum,...lt(e)})}class Xo extends xt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Pe(n,{expected:St.joinValues(r),received:n.parsedType,code:Ie.invalid_type}),et}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Pe(n,{received:n.data,code:Ie.invalid_enum_value,options:r}),et}return Vr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Xo.create(e,{...this._def,...n})}exclude(e,n=this._def){return Xo.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Xo.create=JT;class by extends xt{_parse(e){const n=St.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ue.string&&r.parsedType!==Ue.number){const a=St.objectValues(n);return Pe(r,{expected:St.joinValues(a),received:r.parsedType,code:Ie.invalid_type}),et}if(this._cache||(this._cache=new Set(St.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=St.objectValues(n);return Pe(r,{received:r.data,code:Ie.invalid_enum_value,options:a}),et}return Vr(e.data)}get enum(){return this._def.values}}by.create=(t,e)=>new by({values:t,typeName:Ze.ZodNativeEnum,...lt(e)});class Xf extends xt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ue.promise&&n.common.async===!1)return Pe(n,{code:Ie.invalid_type,expected:Ue.promise,received:n.parsedType}),et;const r=n.parsedType===Ue.promise?n.data:Promise.resolve(n.data);return Vr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Xf.create=(t,e)=>new Xf({type:t,typeName:Ze.ZodPromise,...lt(e)});class Zo extends xt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ze.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,s={addIssue:l=>{Pe(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),a.type==="preprocess"){const l=a.transform(r.data,s);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return et;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?et:d.status==="dirty"||n.value==="dirty"?pc(d.value):d});{if(n.value==="aborted")return et;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?et:c.status==="dirty"||n.value==="dirty"?pc(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,s);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?et:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?et:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Jo(l))return et;const c=a.transform(l.value,s);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>Jo(l)?Promise.resolve(a.transform(l.value,s)).then(c=>({status:n.value,value:c})):et);St.assertNever(a)}}Zo.create=(t,e,n)=>new Zo({schema:t,typeName:Ze.ZodEffects,effect:e,...lt(n)});Zo.createWithPreprocess=(t,e,n)=>new Zo({schema:e,effect:{type:"preprocess",transform:t},typeName:Ze.ZodEffects,...lt(n)});class Ii extends xt{_parse(e){return this._getType(e)===Ue.undefined?Vr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ii.create=(t,e)=>new Ii({innerType:t,typeName:Ze.ZodOptional,...lt(e)});class Qo extends xt{_parse(e){return this._getType(e)===Ue.null?Vr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qo.create=(t,e)=>new Qo({innerType:t,typeName:Ze.ZodNullable,...lt(e)});class Sm extends xt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Ue.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Sm.create=(t,e)=>new Sm({innerType:t,typeName:Ze.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...lt(e)});class Cm extends xt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return qf(a)?a.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ja(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ja(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Cm.create=(t,e)=>new Cm({innerType:t,typeName:Ze.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...lt(e)});class Ay extends xt{_parse(e){if(this._getType(e)!==Ue.nan){const r=this._getOrReturnCtx(e);return Pe(r,{code:Ie.invalid_type,expected:Ue.nan,received:r.parsedType}),et}return{status:"valid",value:e.data}}}Ay.create=t=>new Ay({typeName:Ze.ZodNaN,...lt(t)});class GN extends xt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class cp extends xt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?et:s.status==="dirty"?(n.dirty(),pc(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?et:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new cp({in:e,out:n,typeName:Ze.ZodPipeline})}}class bm extends xt{_parse(e){const n=this._def.innerType._parse(e),r=a=>(Jo(a)&&(a.value=Object.freeze(a.value)),a);return qf(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}bm.create=(t,e)=>new bm({innerType:t,typeName:Ze.ZodReadonly,...lt(e)});var Ze;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ze||(Ze={}));const us=ga.create,ky=_s.create;ws.create;const zN=Yf.create;Ko.create;const Ny=wm.create;Pi.create;const gc=va.create,qN=mn.create,YN=Wf.create;Jf.create;Ts.create;const WN=Kf.create,JN=Em.create,KN=Xo.create;Xf.create;Ii.create;Qo.create;const Io={string:t=>ga.create({...t,coerce:!0}),number:t=>_s.create({...t,coerce:!0}),boolean:t=>Yf.create({...t,coerce:!0}),bigint:t=>ws.create({...t,coerce:!0}),date:t=>Ko.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let XN,ZN;function QN(){return{geminiUrl:XN,vertexUrl:ZN}}function eR(t,e,n){var r,a,s;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=QN();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(s=l.geminiUrl)!==null&&s!==void 0?s:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ds{}function je(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const s=e[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const d=t[c];if(Array.isArray(n))for(let f=0;f<d.length;f++){const g=d[f];m(g,e.slice(s+1),n[f])}else for(const f of d)m(f,e.slice(s+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const d=t[c];m(d[0],e.slice(s+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const s=t[a];return Array.isArray(s)?s.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ry;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ry||(Ry={}));var My;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(My||(My={}));var xa;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(xa||(xa={}));var Dy;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Dy||(Dy={}));var Iy;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Iy||(Iy={}));var Fy;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Fy||(Fy={}));var Ly;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Ly||(Ly={}));var Py;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Py||(Py={}));var Oy;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Oy||(Oy={}));var Uy;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Uy||(Uy={}));var By;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(By||(By={}));var jy;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(jy||(jy={}));var Vy;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Vy||(Vy={}));var Hy;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Hy||(Hy={}));var $y;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})($y||($y={}));var Gy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Gy||(Gy={}));var Zf;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Zf||(Zf={}));var zy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(zy||(zy={}));var Am;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Am||(Am={}));var qy;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(qy||(qy={}));var Yy;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Yy||(Yy={}));var Wy;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Wy||(Wy={}));var Jy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Jy||(Jy={}));var Ky;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Ky||(Ky={}));var Xy;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Xy||(Xy={}));var Zy;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Zy||(Zy={}));var Qy;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(Qy||(Qy={}));var e_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(e_||(e_={}));var t_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(t_||(t_={}));var n_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(n_||(n_={}));var r_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(r_||(r_={}));var a_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(a_||(a_={}));var i_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(i_||(i_={}));var s_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(s_||(s_={}));var o_;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(o_||(o_={}));var l_;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(l_||(l_={}));var c_;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(c_||(c_={}));var u_;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(u_||(u_={}));var f_;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(f_||(f_={}));var d_;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(d_||(d_={}));var h_;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(h_||(h_={}));var jo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(jo||(jo={}));class km{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class hc{get text(){var e,n,r,a,s,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const v=[];for(const _ of(d=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[T,E]of Object.entries(_))T!=="text"&&T!=="thought"&&(E!==null||E!==void 0)&&v.push(T);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,f+=_.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,n,r,a,s,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const v of(d=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,T]of Object.entries(v))_!=="inlineData"&&(T!==null||T!==void 0)&&g.push(_);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,n,r,a,s,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,n,r,a,s,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,n,r,a,s,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class m_{}class p_{}class tR{}class nR{}class g_{}class x_{}class v_{}class rR{}class y_{}class __{}class w_{}class aR{}class iR{}class sR{}class T_{}class oR{get text(){var e,n,r;let a="",s=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;s=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var e,n,r;let a="";const s=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&s.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class lR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function It(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function KT(t,e){const n=It(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function XT(t){return Array.isArray(t)?t.map(e=>Qf(e)):[Qf(t)]}function Qf(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function ZT(t){const e=Qf(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function QT(t){const e=Qf(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function E_(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function e2(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>E_(e)):[E_(t)]}function Nm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function S_(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function C_(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Gn(t){if(t==null)throw new Error("ContentUnion is required");return Nm(t)?t:{role:"user",parts:e2(t)}}function t2(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Gn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Gn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Gn(n)):[Gn(e)]}function Br(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(S_(t)||C_(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Gn(t)]}const e=[],n=[],r=Nm(t[0]);for(const a of t){const s=Nm(a);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(a);else{if(S_(a)||C_(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:e2(n)}),e}const cR=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),b_=KN(["string","number","integer","object","array","boolean","null"]),uR=YN([b_,gc(b_)]);function fR(t=!0){const e=JN(()=>{const n=qN({type:uR.optional(),format:us().optional(),title:us().optional(),description:us().optional(),default:Ny().optional(),items:e.optional(),minItems:Io.string().optional(),maxItems:Io.string().optional(),enum:gc(Ny()).optional(),properties:WN(us(),e).optional(),required:gc(us()).optional(),minProperties:Io.string().optional(),maxProperties:Io.string().optional(),propertyOrdering:gc(us()).optional(),minimum:ky().optional(),maximum:ky().optional(),minLength:Io.string().optional(),maxLength:Io.string().optional(),pattern:us().optional(),anyOf:gc(e).optional(),additionalProperties:zN().optional()});return t?n.strict():n});return e}function dR(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(xa).includes(n[0].toUpperCase())?n[0].toUpperCase():xa.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(xa).includes(r.toUpperCase())?r.toUpperCase():xa.TYPE_UNSPECIFIED})}}function Ho(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&dR(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(xa).includes(c.toUpperCase())?c.toUpperCase():xa.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=Ho(c);else if(r.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push(Ho(f))}e[l]=d}else if(a.includes(l)){const d={};for(const[f,g]of Object.entries(c))d[f]=Ho(g);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Bc(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=fR().parse(t);return Ho(e)}else return Ho(t)}function up(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function fp(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function sl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Bc(e.parameters)),e.response&&(e.response=Bc(e.response));return t}function ol(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function hR(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function Za(t,e){if(typeof e!="string")throw new Error("name must be a string");return hR(t,e,"cachedContents")}function n2(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Qa(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function mR(t){return t!=null&&typeof t=="object"&&"name"in t}function pR(t){return t!=null&&typeof t=="object"&&"video"in t}function gR(t){return t!=null&&typeof t=="object"&&"uri"in t}function r2(t){var e;let n;if(mR(t)&&(n=t.name),!(gR(t)&&(n=t.uri,n===void 0))&&!(pR(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function a2(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function i2(t){for(const e of["models","tunedModels","publisherModels"])if(xR(t,e))return t[e];return[]}function xR(t,e){return t!==null&&typeof t=="object"&&e in t}function vR(t,e={}){const n=t,r={name:n.name,description:n.description,parameters:Ho(xd(n.inputSchema))};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function yR(t,e={}){const n=[],r=new Set;for(const a of t){const s=a.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const l=vR(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function _R(t){const e=[];for(const n of t)e.push(xd(n));return e}function wR(t){const e={};for(const[n,r]of Object.entries(t)){const a=r;e[n]=xd(a)}return e}function xd(t){const e=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[s,l]of Object.entries(t))if(e.has(s))a[s]=xd(l);else if(n.has(s))a[s]=_R(l);else if(r.has(s))a[s]=wR(l);else if(s==="type"){const c=l.toUpperCase();a[s]=Object.values(xa).includes(c)?c:xa.TYPE_UNSPECIFIED}else cR.has(s)&&(a[s]=l);return a}function s2(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function TR(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ll(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function o2(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ER(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function SR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function CR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function bR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],ER(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],SR(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],CR(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function l2(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>bR(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function AR(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const D=h(t,["propertyOrdering"]);D!=null&&m(e,["propertyOrdering"],D);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const G=h(t,["title"]);G!=null&&m(e,["title"],G);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function kR(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function NR(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function RR(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function MR(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],RR(n)),e}function DR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function IR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],DR(n)),e}function FR(){return{}}function LR(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>NR(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],MR(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],IR(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],FR());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function PR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function OR(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function UR(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],OR(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function BR(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],PR(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],UR(r)),e}function jR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function c2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],jR(n)),e}function VR(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],c2(r)),e}function HR(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>VR(a))),m(e,["speakerVoiceConfigs"],r)}return e}function $R(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],c2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],HR(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function GR(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function zR(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],l2(Gn(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],AR(Bc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let z=b;Array.isArray(z)&&(z=z.map(ee=>kR(ee))),m(n,["safetySettings"],z)}const D=h(e,["tools"]);if(n!==void 0&&D!=null){let z=ol(D);Array.isArray(z)&&(z=z.map(ee=>LR(sl(ee)))),m(n,["tools"],z)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],BR(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=h(e,["cachedContent"]);n!==void 0&&G!=null&&m(n,["cachedContent"],Za(t,G));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const W=h(e,["mediaResolution"]);W!=null&&m(r,["mediaResolution"],W);const U=h(e,["speechConfig"]);if(U!=null&&m(r,["speechConfig"],$R(up(U))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ae=h(e,["thinkingConfig"]);return ae!=null&&m(r,["thinkingConfig"],GR(ae)),r}function qR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>l2(c))),m(n,["request","contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["request","generationConfig"],zR(t,s,n)),n}function YR(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>qR(t,l))),m(n,["requests","requests"],s)}return n}function WR(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function JR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],YR(t,s2(t,a)));const s=h(e,["config"]);return s!=null&&m(n,["config"],WR(s,n)),n}function KR(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function XR(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function ZR(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function QR(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],ZR(n,e)),e}function e3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function t3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function n3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function r3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],n3(TR(a))),n}function a3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],It(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],t3(s2(t,a)));const s=h(e,["config"]);return s!=null&&m(n,["config"],r3(s,n)),n}function i3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function s3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function o3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function l3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],o3(n,e)),e}function c3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ll(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function u2(){return{}}function u3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function f3(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function d3(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function h3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],u3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],f3(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],d3(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function m3(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>h3(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function p3(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function g3(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function x3(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>g3(a))),m(e,["urlMetadata"],r)}return e}function v3(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],m3(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],p3(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],x3(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function y3(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>v3(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const s=h(t,["usageMetadata"]);return s!=null&&m(e,["usageMetadata"],s),e}function _3(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],y3(n)),h(t,["error"])!=null&&m(e,["error"],u2()),e}function w3(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>_3(s))),m(e,["inlinedResponses"],a)}return e}function Rm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],o2(a));const s=h(t,["metadata","createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["metadata","model"]);d!=null&&m(e,["model"],d);const f=h(t,["metadata","output"]);return f!=null&&m(e,["dest"],w3(f)),e}function T3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Rm(s))),m(e,["batchJobs"],a)}return e}function E3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],u2()),e}function f2(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function S3(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function C3(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function Mm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],o2(a));const s=h(t,["error"]);s!=null&&m(e,["error"],f2(s));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const d=h(t,["endTime"]);d!=null&&m(e,["endTime"],d);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const v=h(t,["inputConfig"]);v!=null&&m(e,["src"],S3(v));const _=h(t,["outputConfig"]);return _!=null&&m(e,["dest"],C3(_)),e}function b3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Mm(s))),m(e,["batchJobs"],a)}return e}function A3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],f2(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Es;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Es||(Es={}));class ru{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k3 extends Ds{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new ru(Es.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=a3(this.apiClient,e);return c=je("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Mm(g))}else{const f=JR(this.apiClient,e);return c=je("{model}:batchGenerateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Rm(g))}}async get(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=i3(this.apiClient,e);return c=je("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Mm(g))}else{const f=KR(this.apiClient,e);return c=je("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Rm(g))}}async cancel(e){var n,r,a,s;let l="",c={};if(this.apiClient.isVertexAI()){const d=s3(this.apiClient,e);l=je("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=XR(this.apiClient,e);l=je("batches/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=l3(e);return c=je("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=b3(g),_=new T_;return Object.assign(_,v),_})}else{const f=QR(e);return c=je("batches",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=T3(g),_=new T_;return Object.assign(_,v),_})}}async delete(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=c3(this.apiClient,e);return c=je("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>A3(g))}else{const f=e3(this.apiClient,e);return c=je("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>E3(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function R3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function M3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function D3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],N3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],R3(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],M3(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function A_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>D3(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function I3(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function F3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function L3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],F3(n)),e}function P3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function O3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],P3(n)),e}function U3(){return{}}function B3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>I3(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],L3(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],O3(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],U3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function j3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function V3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function H3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],V3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function $3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],j3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],H3(r)),e}function G3(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const s=h(t,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=Br(l);Array.isArray(g)&&(g=g.map(v=>A_(v))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],A_(Gn(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>B3(v))),m(e,["tools"],g)}const f=h(t,["toolConfig"]);if(e!==void 0&&f!=null&&m(e,["toolConfig"],$3(f)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function z3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],KT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],G3(a,n)),n}function q3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Y3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function W3(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function J3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],W3(a,n)),n}function K3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function X3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],K3(n,e)),e}function Z3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function Q3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function e5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function t5(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],Z3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],Q3(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],e5(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function k_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>t5(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function n5(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function r5(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function a5(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],r5(n)),e}function i5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function s5(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],i5(n)),e}function o5(){return{}}function l5(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function c5(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],l5(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function u5(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],c5(n)),e}function f5(){return{}}function d5(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>n5(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],a5(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s5(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],o5());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],u5(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],f5());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function h5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function m5(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function p5(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],m5(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function g5(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],h5(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],p5(r)),e}function x5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const s=h(t,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let v=Br(l);Array.isArray(v)&&(v=v.map(_=>k_(_))),m(e,["contents"],v)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],k_(Gn(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>d5(_))),m(e,["tools"],v)}const f=h(t,["toolConfig"]);e!==void 0&&f!=null&&m(e,["toolConfig"],g5(f));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function v5(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],KT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],x5(a,n)),n}function y5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function _5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function w5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function T5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Za(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],w5(a,n)),n}function E5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function S5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],E5(n,e)),e}function jf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const s=h(t,["createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function C5(){return{}}function b5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>jf(s))),m(e,["cachedContents"],a)}return e}function Vf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const s=h(t,["createTime"]);s!=null&&m(e,["createTime"],s);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function A5(){return{}}function k5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Vf(s))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class N5 extends Ds{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ru(Es.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=v5(this.apiClient,e);return c=je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Vf(g))}else{const f=z3(this.apiClient,e);return c=je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>jf(g))}}async get(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=y5(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Vf(g))}else{const f=q3(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>jf(g))}}async delete(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=_5(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=A5(),v=new __;return Object.assign(v,g),v})}else{const f=Y3(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(()=>{const g=C5(),v=new __;return Object.assign(v,g),v})}}async update(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=T5(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Vf(g))}else{const f=J3(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>jf(g))}}async listInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=S5(e);return c=je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=k5(g),_=new w_;return Object.assign(_,v),_})}else{const f=X3(e);return c=je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=b5(g),_=new w_;return Object.assign(_,v),_})}}}function N_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $t(t){return this instanceof $t?(this.v=t,this):new $t(t)}function $o(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(T){return function(E){return Promise.resolve(E).then(T,v)}}function c(T,E){r[T]&&(a[T]=function(S){return new Promise(function(C,k){s.push([T,S,C,k])>1||d(T,S)})},E&&(a[T]=E(a[T])))}function d(T,E){try{f(r[T](E))}catch(S){_(s[0][3],S)}}function f(T){T.value instanceof $t?Promise.resolve(T.value.v).then(g,v):_(s[0][2],T)}function g(T){d("next",T)}function v(T){d("throw",T)}function _(T,E){T(E),s.shift(),s.length&&d(s[0][0],s[0][1])}}function bc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof N_=="function"?N_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(l){return new Promise(function(c,d){l=t[s](l),a(c,d,l.done,l.value)})}}function a(s,l,c,d){Promise.resolve(d).then(function(f){s({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R5(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:d2(n)}function d2(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function M5(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function R_(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let s=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),s&&!d2(t[r])&&(s=!1),r++;s?e.push(...a):e.pop()}return e}class D5{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new I5(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class I5{constructor(e,n,r,a={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),M5(s)}async sendMessage(e){var n;await this.sendPromise;const r=Gn(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,l,c;const d=await a,f=(l=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,g=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let _=[];g!=null&&(_=(c=g.slice(v))!==null&&c!==void 0?c:[]);const T=f?[f]:[];this.recordHistory(r,T,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=Gn(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?R_(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return $o(this,arguments,function*(){var l,c,d,f;const g=[];try{for(var v=!0,_=bc(e),T;T=yield $t(_.next()),l=T.done,!l;v=!0){f=T.value,v=!1;const E=f;if(R5(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield $t(E)}}catch(E){c={error:E}}finally{try{!v&&!l&&(d=_.return)&&(yield $t(d.call(_)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(s=>s.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...R_(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,vd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function L5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],F5(n,e)),e}function P5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function O5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const s=h(t,["sizeBytes"]);s!=null&&m(e,["sizeBytes"],s);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],P5(S)),e}function U5(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],O5(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function B5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],r2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function j5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],r2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function V5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function Dm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const s=h(t,["sizeBytes"]);s!=null&&m(e,["sizeBytes"],s);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],V5(S)),e}function H5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Dm(s))),m(e,["files"],a)}return e}function $5(){return{}}function G5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z5 extends Ds{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ru(Es.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Dm(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=L5(e);return s=je("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=H5(d),g=new aR;return Object.assign(g,f),g})}}async createInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=U5(e);return s=je("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=$5(),f=new iR;return Object.assign(f,d),f})}}async get(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=B5(e);return s=je("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Dm(d))}}async delete(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=j5(e);return s=je("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=G5(),f=new sR;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q5(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function Y5(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function h2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],q5(n)),e}function W5(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],Y5(n)),e}function J5(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],h2(r)),e}function K5(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>J5(a))),m(e,["speakerVoiceConfigs"],r)}return e}function X5(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],h2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],K5(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function Z5(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],W5(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function Q5(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function eM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function tM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function nM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function rM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function aM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function iM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],Q5(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],tM(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],rM(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function sM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],eM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],nM(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],aM(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function oM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>iM(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function lM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>sM(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function cM(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function uM(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function fM(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function dM(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function hM(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],fM(n)),e}function mM(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],dM(n)),e}function pM(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function gM(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function xM(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],pM(n)),e}function vM(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],gM(n)),e}function yM(){return{}}function _M(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function wM(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],_M(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function TM(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],wM(n)),e}function EM(){return{}}function SM(){return{}}function CM(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>cM(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],hM(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],xM(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],EM());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function bM(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>uM(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],mM(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],vM(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],yM());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],TM(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],SM());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function AM(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function kM(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function M_(){return{}}function D_(){return{}}function NM(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function RM(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function MM(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],NM(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function DM(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],RM(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function IM(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function FM(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function LM(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],IM(r)),e}function PM(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],FM(r)),e}function OM(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function UM(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function BM(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],X5(fp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],oM(Gn(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=ol(E);Array.isArray(B)&&(B=B.map(G=>CM(sl(G)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],AM(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],M_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],M_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],MM(A));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],LM(b));const D=h(t,["proactivity"]);return e!==void 0&&D!=null&&m(e,["setup","proactivity"],OM(D)),n}function jM(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],Z5(fp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],lM(Gn(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=ol(E);Array.isArray(B)&&(B=B.map(G=>bM(sl(G)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],kM(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],D_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],D_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],DM(A));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],PM(b));const D=h(t,["proactivity"]);return e!==void 0&&D!=null&&m(e,["setup","proactivity"],UM(D)),n}function VM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],BM(a,n)),n}function HM(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],jM(a,n)),n}function $M(){return{}}function GM(){return{}}function zM(){return{}}function qM(){return{}}function YM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],XT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],QT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const s=h(t,["video"]);s!=null&&m(e,["video"],ZT(s));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],$M()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],zM()),e}function WM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],XT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],QT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const s=h(t,["video"]);s!=null&&m(e,["video"],ZT(s));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],GM()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],qM()),e}function m2(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function JM(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>m2(a))),m(e,["weightedPrompts"],r)}return e}function p2(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const s=h(t,["guidance"]);s!=null&&m(e,["guidance"],s);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function KM(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],p2(n)),e}function g2(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function x2(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>m2(a))),m(e,["weightedPrompts"],r)}return e}function Im(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],g2(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],x2(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],p2(a));const s=h(t,["playbackControl"]);return s!=null&&m(e,["playbackControl"],s),e}function XM(){return{}}function ZM(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function QM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function eD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function tD(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function nD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function rD(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function aD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function iD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],QM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],tD(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],rD(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function sD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],eD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],nD(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],aD(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function oD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>iD(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function lD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>sD(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function I_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function F_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function cD(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function uD(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>cD(a))),m(e,["urlMetadata"],r)}return e}function fD(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],oD(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const s=h(t,["groundingMetadata"]);s!=null&&m(e,["groundingMetadata"],s);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],I_(c));const d=h(t,["outputTranscription"]);d!=null&&m(e,["outputTranscription"],I_(d));const f=h(t,["urlContextMetadata"]);return f!=null&&m(e,["urlContextMetadata"],uD(f)),e}function dD(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],lD(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const s=h(t,["groundingMetadata"]);s!=null&&m(e,["groundingMetadata"],s);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],F_(c));const d=h(t,["outputTranscription"]);return d!=null&&m(e,["outputTranscription"],F_(d)),e}function hD(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function mD(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function pD(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>hD(a))),m(e,["functionCalls"],r)}return e}function gD(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>mD(a))),m(e,["functionCalls"],r)}return e}function xD(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function vD(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function bf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function Af(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function yD(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const s=h(t,["toolUsePromptTokenCount"]);s!=null&&m(e,["toolUsePromptTokenCount"],s);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(T=>bf(T))),m(e,["promptTokensDetails"],_)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>bf(T))),m(e,["cacheTokensDetails"],_)}const g=h(t,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(T=>bf(T))),m(e,["responseTokensDetails"],_)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let _=v;Array.isArray(_)&&(_=_.map(T=>bf(T))),m(e,["toolUsePromptTokensDetails"],_)}return e}function _D(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const s=h(t,["toolUsePromptTokenCount"]);s!=null&&m(e,["toolUsePromptTokenCount"],s);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(E=>Af(E))),m(e,["promptTokensDetails"],T)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(E=>Af(E))),m(e,["cacheTokensDetails"],T)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>Af(E))),m(e,["responseTokensDetails"],T)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(E=>Af(E))),m(e,["toolUsePromptTokensDetails"],T)}const _=h(t,["trafficType"]);return _!=null&&m(e,["trafficType"],_),e}function wD(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function TD(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function ED(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function SD(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function CD(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],XM());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],fD(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],pD(a));const s=h(t,["toolCallCancellation"]);s!=null&&m(e,["toolCallCancellation"],xD(s));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],yD(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],wD(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],ED(d)),e}function bD(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],ZM(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],dD(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],gD(a));const s=h(t,["toolCallCancellation"]);s!=null&&m(e,["toolCallCancellation"],vD(s));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],_D(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],TD(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],SD(d)),e}function AD(){return{}}function kD(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function ND(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>kD(a))),m(e,["weightedPrompts"],r)}return e}function RD(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const s=h(t,["guidance"]);s!=null&&m(e,["guidance"],s);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function MD(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],ND(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],RD(r)),e}function DD(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],MD(a)),e}function ID(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>DD(a))),m(e,["audioChunks"],r)}return e}function FD(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function LD(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],AD());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],ID(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],FD(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function OD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function UD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function BD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],PD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],OD(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],UD(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function yd(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>BD(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function jD(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const D=h(t,["propertyOrdering"]);D!=null&&m(e,["propertyOrdering"],D);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const G=h(t,["title"]);G!=null&&m(e,["title"],G);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function VD(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function HD(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function $D(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function GD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],$D(n)),e}function zD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function qD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],zD(n)),e}function YD(){return{}}function WD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>HD(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],GD(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],qD(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],YD());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function JD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function KD(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function XD(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],KD(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function ZD(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],JD(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],XD(r)),e}function QD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function v2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],QD(n)),e}function eI(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],v2(r)),e}function tI(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>eI(a))),m(e,["speakerVoiceConfigs"],r)}return e}function nI(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],v2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],tI(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function rI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function aI(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],yd(Gn(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],jD(Bc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let z=b;Array.isArray(z)&&(z=z.map(ee=>VD(ee))),m(n,["safetySettings"],z)}const D=h(e,["tools"]);if(n!==void 0&&D!=null){let z=ol(D);Array.isArray(z)&&(z=z.map(ee=>WD(sl(ee)))),m(n,["tools"],z)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],ZD(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=h(e,["cachedContent"]);n!==void 0&&G!=null&&m(n,["cachedContent"],Za(t,G));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const W=h(e,["mediaResolution"]);W!=null&&m(r,["mediaResolution"],W);const U=h(e,["speechConfig"]);if(U!=null&&m(r,["speechConfig"],nI(up(U))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ae=h(e,["thinkingConfig"]);return ae!=null&&m(r,["thinkingConfig"],rI(ae)),r}function L_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>yd(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["generationConfig"],aI(t,s,n)),n}function iI(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const s=h(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&m(e,["requests[]","outputDimensionality"],s),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function sI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],t2(t,a));const s=h(e,["config"]);s!=null&&m(n,["config"],iI(s,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],It(t,l)),n}function oI(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const s=h(t,["guidanceScale"]);if(e!==void 0&&s!=null&&m(e,["parameters","guidanceScale"],s),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const d=h(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&m(e,["parameters","includeSafetyAttributes"],d);const f=h(t,["includeRaiReason"]);e!==void 0&&f!=null&&m(e,["parameters","includeRaiReason"],f);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const v=h(t,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const _=h(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function lI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["config"]);return s!=null&&m(n,["config"],oI(s,n)),n}function cI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function uI(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const s=h(e,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],a2(t,c)),r}function fI(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],uI(t,r,n)),n}function dI(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const s=h(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),n}function hI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],dI(a,n)),n}function mI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function pI(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function gI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>yd(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],pI(s)),n}function xI(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],Qa(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function vI(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=h(t,["aspectRatio"]);if(e!==void 0&&s!=null&&m(e,["parameters","aspectRatio"],s),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const d=h(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function yI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["image"]);if(s!=null&&m(n,["instances[0]","image"],xI(s)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],vI(l,n)),n}function _I(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function wI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function TI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function EI(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],_I(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],wI(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],TI(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function cl(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>EI(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function SI(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["enum"]);s!=null&&m(e,["enum"],s);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const D=h(t,["propertyOrdering"]);D!=null&&m(e,["propertyOrdering"],D);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const G=h(t,["title"]);G!=null&&m(e,["title"],G);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function CI(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function bI(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function AI(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const s=h(t,["parametersJsonSchema"]);s!=null&&m(e,["parametersJsonSchema"],s);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function kI(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function NI(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],kI(n)),e}function RI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function MI(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],RI(n)),e}function DI(){return{}}function II(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function FI(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],II(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const s=h(t,["httpBasicAuthConfig"]);s!=null&&m(e,["httpBasicAuthConfig"],s);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function LI(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],FI(n)),e}function PI(){return{}}function y2(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>AI(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],NI(a));const s=h(t,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],MI(s)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],DI());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],LI(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],PI());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function OI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function UI(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function BI(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],UI(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function jI(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],OI(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],BI(r)),e}function VI(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function HI(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],VI(n)),e}function $I(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],HI(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function GI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function zI(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],cl(Gn(a)));const s=h(e,["temperature"]);s!=null&&m(r,["temperature"],s);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],SI(Bc(k)));const A=h(e,["responseJsonSchema"]);A!=null&&m(r,["responseJsonSchema"],A);const b=h(e,["routingConfig"]);b!=null&&m(r,["routingConfig"],b);const D=h(e,["modelSelectionConfig"]);D!=null&&m(r,["modelConfig"],CI(D));const B=h(e,["safetySettings"]);if(n!==void 0&&B!=null){let we=B;Array.isArray(we)&&(we=we.map(ie=>bI(ie))),m(n,["safetySettings"],we)}const G=h(e,["tools"]);if(n!==void 0&&G!=null){let we=ol(G);Array.isArray(we)&&(we=we.map(ie=>y2(sl(ie)))),m(n,["tools"],we)}const F=h(e,["toolConfig"]);n!==void 0&&F!=null&&m(n,["toolConfig"],jI(F));const W=h(e,["labels"]);n!==void 0&&W!=null&&m(n,["labels"],W);const U=h(e,["cachedContent"]);n!==void 0&&U!=null&&m(n,["cachedContent"],Za(t,U));const ae=h(e,["responseModalities"]);ae!=null&&m(r,["responseModalities"],ae);const z=h(e,["mediaResolution"]);z!=null&&m(r,["mediaResolution"],z);const ee=h(e,["speechConfig"]);ee!=null&&m(r,["speechConfig"],$I(up(ee)));const Ee=h(e,["audioTimestamp"]);Ee!=null&&m(r,["audioTimestamp"],Ee);const Ae=h(e,["thinkingConfig"]);return Ae!=null&&m(r,["thinkingConfig"],GI(Ae)),r}function P_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>cl(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["generationConfig"],zI(t,s,n)),n}function qI(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const s=h(t,["outputDimensionality"]);e!==void 0&&s!=null&&m(e,["parameters","outputDimensionality"],s);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function YI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],t2(t,a));const s=h(e,["config"]);return s!=null&&m(n,["config"],qI(s,n)),n}function WI(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const s=h(t,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["addWatermark"]);e!==void 0&&C!=null&&m(e,["parameters","addWatermark"],C);const k=h(t,["enhancePrompt"]);return e!==void 0&&k!=null&&m(e,["parameters","enhancePrompt"],k),n}function JI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["config"]);return s!=null&&m(n,["config"],WI(s,n)),n}function _d(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Qa(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function KI(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function XI(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function ZI(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function QI(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function e6(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],_d(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const s=h(t,["maskImageConfig"]);s!=null&&m(e,["maskImageConfig"],KI(s));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],XI(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],ZI(c));const d=h(t,["subjectImageConfig"]);return d!=null&&m(e,["subjectImageConfig"],QI(d)),e}function t6(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const s=h(t,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["editMode"]);e!==void 0&&C!=null&&m(e,["parameters","editMode"],C);const k=h(t,["baseSteps"]);return e!==void 0&&k!=null&&m(e,["parameters","editConfig","baseSteps"],k),n}function n6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["referenceImages"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>e6(d))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],t6(l,n)),n}function r6(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const s=h(t,["outputCompressionQuality"]);e!==void 0&&s!=null&&m(e,["parameters","outputOptions","compressionQuality"],s);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=h(t,["numberOfImages"]);e!==void 0&&d!=null&&m(e,["parameters","sampleCount"],d);const f=h(t,["mode"]);return e!==void 0&&f!=null&&m(e,["parameters","mode"],f),n}function a6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],_d(a));const s=h(e,["upscaleFactor"]);s!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],s);const l=h(e,["config"]);return l!=null&&m(n,["config"],r6(l,n)),n}function i6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function s6(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const s=h(e,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],a2(t,c)),r}function o6(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],s6(t,r,n)),n}function l6(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const s=h(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&m(e,["defaultCheckpointId"],s),n}function c6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],l6(a,n)),n}function u6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function f6(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],cl(Gn(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>y2(c))),m(e,["tools"],l)}const s=h(t,["generationConfig"]);return e!==void 0&&s!=null&&m(e,["generationConfig"],s),n}function d6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>cl(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],f6(s,n)),n}function h6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["contents"]);if(a!=null){let l=Br(a);Array.isArray(l)&&(l=l.map(c=>cl(c))),m(n,["contents"],l)}const s=h(e,["config"]);return s!=null&&m(n,["config"],s),n}function m6(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],Qa(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function p6(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const s=h(t,["fps"]);e!==void 0&&s!=null&&m(e,["parameters","fps"],s);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const d=h(t,["aspectRatio"]);e!==void 0&&d!=null&&m(e,["parameters","aspectRatio"],d);const f=h(t,["resolution"]);e!==void 0&&f!=null&&m(e,["parameters","resolution"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["pubsubTopic"]);e!==void 0&&v!=null&&m(e,["parameters","pubsubTopic"],v);const _=h(t,["negativePrompt"]);e!==void 0&&_!=null&&m(e,["parameters","negativePrompt"],_);const T=h(t,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],_d(S));const C=h(t,["compressionQuality"]);return e!==void 0&&C!=null&&m(e,["parameters","compressionQuality"],C),n}function g6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],It(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const s=h(e,["image"]);s!=null&&m(n,["instances[0]","image"],_d(s));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],m6(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],p6(c,n)),n}function x6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function v6(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function y6(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function _6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],x6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],v6(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],y6(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function w6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>_6(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function T6(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function E6(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function S6(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>E6(a))),m(e,["urlMetadata"],r)}return e}function C6(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],w6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],T6(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],S6(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function O_(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>C6(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const s=h(t,["usageMetadata"]);return s!=null&&m(e,["usageMetadata"],s),e}function b6(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function A6(){return{}}function k6(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>b6(s))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],A6()),e}function N6(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],Qa(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function _2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function R6(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],N6(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],_2(a)),e}function M6(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>R6(s))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],_2(r)),e}function D6(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function Fm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["version"]);s!=null&&m(e,["version"],s);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],D6(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const d=h(t,["outputTokenLimit"]);d!=null&&m(e,["outputTokenLimit"],d);const f=h(t,["supportedGenerationMethods"]);return f!=null&&m(e,["supportedActions"],f),e}function I6(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=i2(r);Array.isArray(a)&&(a=a.map(s=>Fm(s))),m(e,["models"],a)}return e}function F6(){return{}}function L6(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function P6(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],Qa(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function O6(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],P6(n)),e}function U6(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>O6(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function B6(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],U6(l)),e}function j6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function V6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function H6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function $6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],j6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],V6(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],H6(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function G6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>$6(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function z6(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function q6(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function Y6(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>q6(a))),m(e,["urlMetadata"],r)}return e}function W6(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],G6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],z6(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const s=h(t,["finishReason"]);s!=null&&m(e,["finishReason"],s);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],Y6(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function U_(t){const e={},n=h(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>W6(f))),m(e,["candidates"],d)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const s=h(t,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function J6(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function K6(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],J6(r)),e}function X6(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function Z6(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>K6(s))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],X6(r)),e}function Q6(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],Qa(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function w2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function dp(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],Q6(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],w2(a));const s=h(t,["prompt"]);return s!=null&&m(e,["enhancedPrompt"],s),e}function eF(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>dp(s))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],w2(r)),e}function tF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>dp(a))),m(e,["generatedImages"],r)}return e}function nF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>dp(a))),m(e,["generatedImages"],r)}return e}function rF(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function aF(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function iF(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function Lm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const s=h(t,["versionId"]);s!=null&&m(e,["version"],s);const l=h(t,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>rF(_))),m(e,["endpoints"],v)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const d=h(t,["_self"]);d!=null&&m(e,["tunedModelInfo"],aF(d));const f=h(t,["defaultCheckpointId"]);f!=null&&m(e,["defaultCheckpointId"],f);const g=h(t,["checkpoints"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(_=>iF(_))),m(e,["checkpoints"],v)}return e}function sF(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=i2(r);Array.isArray(a)&&(a=a.map(s=>Lm(s))),m(e,["models"],a)}return e}function oF(){return{}}function lF(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function cF(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function uF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],Qa(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function fF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],uF(n)),e}function dF(t){const e={},n=h(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>fF(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function hF(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response"]);return l!=null&&m(e,["response"],dF(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mF="Content-Type",pF="X-Server-Timeout",gF="User-Agent",Pm="x-goog-api-client",xF="1.8.0",vF=`google-genai-sdk/${xF}`,yF="v1beta1",_F="v1beta",B_=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class wF{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:yF,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:_F,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.unaryApiCall(a,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,s]of Object.entries(n))typeof s=="object"?r[a]=Object.assign(Object.assign({},r[a]),s):s!==void 0&&(r[a]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,e.abortSignal),this.streamApiCall(a,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,s=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=s}return n&&n.extraBody!==null&&TF(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await j_(a),new km(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await j_(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return $o(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield $t(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=s.decode(d);try{const v=JSON.parse(f);if("error"in v){const _=JSON.parse(JSON.stringify(v.error)),T=_.status,E=_.code,S=`got status: ${T}. ${JSON.stringify(v)}`;if(E>=400&&E<600)throw new vd({message:S,status:E})}}catch(v){if(v.name==="ApiError")throw v}l+=f;let g=l.match(B_);for(;g;){const v=g[1];try{const _=new Response(v,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield $t(new km(_)),l=l.slice(g[0].length),g=l.match(B_)}catch(_){throw new Error(`exception parsing stream chunk ${v}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=vF+" "+this.clientOptions.userAgentExtra;return e[gF]=n,e[Pm]=n,e[mF]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(pF,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const d=await this.fetchUploadUrl(a,n);return s.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const s={file:e},l=await this.request({path:je("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function j_(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new vd({message:a,status:n}):new Error(a)}}function TF(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,l){const c=Object.assign({},s);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],g=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[d]=r(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EF="mcp_used/unknown";function T2(t){for(const e of t)if(hp(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function E2(t){var e;const n=(e=t[Pm])!==null&&e!==void 0?e:"";t[Pm]=(n+` ${EF}`).trimStart()}function SF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>hp(a)))!==null&&r!==void 0?r:!1}function CF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!hp(a)))!==null&&r!==void 0?r:!1}function hp(t){return t!==null&&typeof t=="object"&&t instanceof mp}function bF(t,e=100){return $o(this,arguments,function*(){let r,a=0;for(;a<e;){const s=yield $t(t.listTools({cursor:r}));for(const l of s.tools)yield yield $t(l),a++;if(!s.nextCursor)break;r=s.nextCursor}})}class mp{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new mp(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const s={},l=[];for(const g of this.mcpClients)try{for(var c=!0,d=(n=void 0,bc(bF(g))),f;f=await d.next(),e=f.done,!e;c=!0){a=f.value,c=!1;const v=a;l.push(v);const _=v.name;if(s[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);s[_]=g}}catch(v){n={error:v}}finally{try{!c&&!e&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),yR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function AF(t,e,n){const r=new lR;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const s=LD(a);Object.assign(r,s),e(r)}class kF{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=MF(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(b=>{f=b}),v=e.callbacks,_=function(){f({})},T=this.apiClient,E={onopen:_,onmessage:b=>{AF(T,v.onmessage,b)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(b){}},S=this.webSocketFactory.create(d,RF(l),E);S.connect(),await g;const C=It(this.apiClient,e.model),k=g2({model:C}),A=Im({setup:k});return S.send(JSON.stringify(A)),new NF(S,this.apiClient)}}class NF{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=JM(e),r=x2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=KM(e),r=Im(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=Im({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(jo.PLAY)}pause(){this.sendPlaybackControl(jo.PAUSE)}stop(){this.sendPlaybackControl(jo.STOP)}resetContext(){this.sendPlaybackControl(jo.RESET_CONTEXT)}close(){this.conn.close()}}function RF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function MF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function IF(t,e,n){const r=new oR;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const s=JSON.parse(a);if(t.isVertexAI()){const l=bD(s);Object.assign(r,l)}else{const l=CD(s);Object.assign(r,l)}e(r)}class FF{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new kF(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,s,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const v=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&T2(e.config.tools)&&E2(v);const _=UF(v);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const U=this.apiClient.getApiKey();let ae="BidiGenerateContent",z="key";U!=null&&U.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),ae="BidiGenerateContentConstrained",z="access_token"),g=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ae}?${z}=${U}`}let T=()=>{};const E=new Promise(U=>{T=U}),S=e.callbacks,C=function(){var U;(U=S==null?void 0:S.onopen)===null||U===void 0||U.call(S),T({})},k=this.apiClient,A={onopen:C,onmessage:U=>{IF(k,S.onmessage,U)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(U){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(U){}},b=this.webSocketFactory.create(g,OF(_),A);b.connect(),await E;let D=It(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const U=this.apiClient.getProject(),ae=this.apiClient.getLocation();D=`projects/${U}/locations/${ae}/`+D}let B={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Zf.AUDIO]}:e.config.responseModalities=[Zf.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const G=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const U of G)if(this.isCallableTool(U)){const ae=U;F.push(await ae.tool())}else F.push(U);F.length>0&&(e.config.tools=F);const W={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=HM(this.apiClient,W):B=VM(this.apiClient,W),delete B.config,b.send(JSON.stringify(B)),new PF(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const LF={turnComplete:!0};class PF{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Br(n.turns),e.isVertexAI()?r=r.map(a=>cl(a)):r=r.map(a=>yd(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(DF)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},LF),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:WM(e)}:n={realtimeInput:YM(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function OF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function UF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const V_=10;function H_(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Hf(l)){a=!0;break}if(!a)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Hf(t){return"callTool"in t&&typeof t.callTool=="function"}function $_(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BF extends Ds{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,s,l,c;const d=await this.processParamsForMcpUsage(n);if(!SF(n)||H_(n.config))return await this.generateContentInternal(d);if(CF(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,g;const v=Br(d.contents),_=(s=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&s!==void 0?s:V_;let T=0;for(;T<_&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const C of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Hf(C)){const A=await C.callTool(f.functionCalls);S.push(...A)}T++,g={role:"user",parts:S},d.contents=Br(d.contents),d.contents.push(E),d.contents.push(g),$_(d.config)&&(v.push(E),v.push(g))}return $_(d.config)&&(f.automaticFunctionCallingHistory=v),f},this.generateContentStream=async n=>{if(H_(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let s;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:l.push(d);let c;return s?c={generatedImages:l,positivePromptSafetyAttributes:s}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ru(Es.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(e){var n,r,a;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const l=await Promise.all(s.map(async d=>Hf(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&T2(e.config.tools)){const d=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),E2(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var n,r,a;const s=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Hf(l)){const c=l,d=await c.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(s.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);s.set(f.name,c)}}return s}async processAfcStream(e){var n,r,a;const s=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:V_;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,g,v){var _,T;return $o(this,arguments,function*(){for(var E,S,C,k;c<s;){l&&(c++,l=!1);const B=yield $t(f.processParamsForMcpUsage(v)),G=yield $t(f.generateContentStreamInternal(B)),F=[],W=[];try{for(var A=!0,b=(S=void 0,bc(G)),D;D=yield $t(b.next()),E=D.done,!E;A=!0){k=D.value,A=!1;const U=k;if(yield yield $t(U),U.candidates&&(!((_=U.candidates[0])===null||_===void 0)&&_.content)){W.push(U.candidates[0].content);for(const ae of(T=U.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(c<s&&ae.functionCall){if(!ae.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(ae.functionCall.name)){const z=yield $t(g.get(ae.functionCall.name).callTool([ae.functionCall]));F.push(...z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${ae.functionCall.name}`)}}}}catch(U){S={error:U}}finally{try{!A&&!E&&(C=b.return)&&(yield $t(C.call(b)))}finally{if(S)throw S.error}}if(F.length>0){l=!0;const U=new hc;U.candidates=[{content:{role:"user",parts:F}}],yield yield $t(U);const ae=[];ae.push(...W),ae.push({role:"user",parts:F});const z=Br(v.contents).concat(ae);v.contents=z}else break}})}(this,d,e)}async generateContentInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=P_(this.apiClient,e);return c=je("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=U_(g),_=new hc;return Object.assign(_,v),_})}else{const f=L_(this.apiClient,e);return c=je("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=O_(g),_=new hc;return Object.assign(_,v),_})}}async generateContentStreamInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=P_(this.apiClient,e);return c=je("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return $o(this,arguments,function*(){var _,T,E,S;try{for(var C=!0,k=bc(v),A;A=yield $t(k.next()),_=A.done,!_;C=!0){S=A.value,C=!1;const D=U_(yield $t(S.json())),B=new hc;Object.assign(B,D),yield yield $t(B)}}catch(b){T={error:b}}finally{try{!C&&!_&&(E=k.return)&&(yield $t(E.call(k)))}finally{if(T)throw T.error}}})})}else{const f=L_(this.apiClient,e);return c=je("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(v){return $o(this,arguments,function*(){var _,T,E,S;try{for(var C=!0,k=bc(v),A;A=yield $t(k.next()),_=A.done,!_;C=!0){S=A.value,C=!1;const D=O_(yield $t(S.json())),B=new hc;Object.assign(B,D),yield yield $t(B)}}catch(b){T={error:b}}finally{try{!C&&!_&&(E=k.return)&&(yield $t(E.call(k)))}finally{if(T)throw T.error}}})})}}async embedContent(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=YI(this.apiClient,e);return c=je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=Z6(g),_=new m_;return Object.assign(_,v),_})}else{const f=sI(this.apiClient,e);return c=je("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=k6(g),_=new m_;return Object.assign(_,v),_})}}async generateImagesInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=JI(this.apiClient,e);return c=je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=eF(g),_=new p_;return Object.assign(_,v),_})}else{const f=lI(this.apiClient,e);return c=je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=M6(g),_=new p_;return Object.assign(_,v),_})}}async editImageInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=n6(this.apiClient,e);return s=je("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=tF(d),g=new tR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=a6(this.apiClient,e);return s=je("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=nF(d),g=new nR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=i6(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lm(g))}else{const f=cI(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Fm(g))}}async listInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=o6(this.apiClient,e);return c=je("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=sF(g),_=new g_;return Object.assign(_,v),_})}else{const f=fI(this.apiClient,e);return c=je("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=I6(g),_=new g_;return Object.assign(_,v),_})}}async update(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=c6(this.apiClient,e);return c=je("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lm(g))}else{const f=hI(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>Fm(g))}}async delete(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=u6(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=oF(),v=new x_;return Object.assign(v,g),v})}else{const f=mI(this.apiClient,e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(()=>{const g=F6(),v=new x_;return Object.assign(v,g),v})}}async countTokens(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=d6(this.apiClient,e);return c=je("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=lF(g),_=new v_;return Object.assign(_,v),_})}else{const f=gI(this.apiClient,e);return c=je("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=L6(g),_=new v_;return Object.assign(_,v),_})}}async computeTokens(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=h6(this.apiClient,e);return s=je("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=cF(d),g=new rR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=g6(this.apiClient,e);return c=je("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>hF(g))}else{const f=yI(this.apiClient,e);return c=je("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>B6(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function VF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function HF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function $F(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],Qa(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function GF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],$F(n)),e}function zF(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>GF(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function qF(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],zF(l)),e}function YF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],Qa(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function WF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],YF(n)),e}function JF(t){const e={},n=h(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>WF(l))),m(e,["generatedVideos"],s)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function G_(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);s!=null&&m(e,["error"],s);const l=h(t,["response"]);return l!=null&&m(e,["response"],JF(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KF extends Ds{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let s;return r&&"httpOptions"in r&&(s=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=VF(e);return c=je("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>G_(g))}else{const f=jF(e);return c=je("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>qF(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=HF(e);return s=je("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>G_(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XF(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function S2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],XF(n)),e}function ZF(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],S2(r)),e}function QF(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ZF(a))),m(e,["speakerVoiceConfigs"],r)}return e}function e8(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],S2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],QF(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function t8(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function n8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function r8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function a8(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],t8(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],n8(a));const s=h(t,["fileData"]);s!=null&&m(e,["fileData"],r8(s));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function i8(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(s=>a8(s))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function s8(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const s=h(t,["parameters"]);s!=null&&m(e,["parameters"],s);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function o8(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function l8(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],o8(n)),e}function c8(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function u8(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],c8(n)),e}function f8(){return{}}function d8(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>s8(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],l8(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],u8(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],f8());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function h8(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function z_(){return{}}function m8(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const s=h(t,["prefixPaddingMs"]);s!=null&&m(e,["prefixPaddingMs"],s);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function p8(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],m8(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function g8(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function x8(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],g8(r)),e}function v8(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function y8(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const s=h(t,["temperature"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","temperature"],s);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],e8(fp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],i8(Gn(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=ol(E);Array.isArray(B)&&(B=B.map(G=>d8(sl(G)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],h8(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],z_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],z_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],p8(A));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],x8(b));const D=h(t,["proactivity"]);return e!==void 0&&D!=null&&m(e,["setup","proactivity"],v8(D)),n}function _8(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],It(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],y8(a,n)),n}function w8(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const s=h(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&m(n,["newSessionExpireTime"],s);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],_8(t,c));const d=h(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&m(n,["fieldMask"],d),r}function T8(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],w8(t,r,n)),n}function E8(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function S8(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(s=>`${n}.${s}`);e.push(...a)}else e.push(n)}return e.join(",")}function C8(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const s=S8(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];s&&d.push(s),c.length>0&&d.push(...c),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class b8 extends Ds{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=T8(this.apiClient,e);s=je("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=C8(c,e.config);return a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>E8(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function k8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function N8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],k8(n,e)),e}function R8(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function M8(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>R8(a))),m(e,["examples","examples"],r)}return e}function D8(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const s=h(t,["learningRateMultiplier"]);if(s!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function I8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],M8(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],D8(a,e)),e}function F8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function L8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const s=h(t,["filter"]);return e!==void 0&&s!=null&&m(e,["_query","filter"],s),n}function P8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],L8(n,e)),e}function O8(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function U8(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function B8(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],U8(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const s=h(t,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=h(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=h(t,["adapterSize"]);if(e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function j8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],O8(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],B8(a,e)),e}function V8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function C2(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],n2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const s=h(t,["tuningTask","startTime"]);s!=null&&m(e,["startTime"],s);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const f=h(t,["baseModel"]);f!=null&&m(e,["baseModel"],f);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],V8(g));const v=h(t,["distillationSpec"]);v!=null&&m(e,["distillationSpec"],v);const _=h(t,["experiment"]);_!=null&&m(e,["experiment"],_);const T=h(t,["labels"]);T!=null&&m(e,["labels"],T);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const C=h(t,["satisfiesPzs"]);C!=null&&m(e,["satisfiesPzs"],C);const k=h(t,["serviceAccount"]);k!=null&&m(e,["serviceAccount"],k);const A=h(t,["tunedModelDisplayName"]);return A!=null&&m(e,["tunedModelDisplayName"],A),e}function H8(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>C2(s))),m(e,["tuningJobs"],a)}return e}function $8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const s=h(t,["error"]);return s!=null&&m(e,["error"],s),e}function G8(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const s=h(t,["endpoint"]);return s!=null&&m(e,["endpoint"],s),e}function z8(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>G8(l))),m(e,["checkpoints"],s)}return e}function Om(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],n2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const s=h(t,["startTime"]);s!=null&&m(e,["startTime"],s);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["error"]);d!=null&&m(e,["error"],d);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const v=h(t,["tunedModel"]);v!=null&&m(e,["tunedModel"],z8(v));const _=h(t,["supervisedTuningSpec"]);_!=null&&m(e,["supervisedTuningSpec"],_);const T=h(t,["tuningDataStats"]);T!=null&&m(e,["tuningDataStats"],T);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const C=h(t,["distillationSpec"]);C!=null&&m(e,["distillationSpec"],C);const k=h(t,["experiment"]);k!=null&&m(e,["experiment"],k);const A=h(t,["labels"]);A!=null&&m(e,["labels"],A);const b=h(t,["pipelineJob"]);b!=null&&m(e,["pipelineJob"],b);const D=h(t,["satisfiesPzi"]);D!=null&&m(e,["satisfiesPzi"],D);const B=h(t,["satisfiesPzs"]);B!=null&&m(e,["satisfiesPzs"],B);const G=h(t,["serviceAccount"]);G!=null&&m(e,["serviceAccount"],G);const F=h(t,["tunedModelDisplayName"]);return F!=null&&m(e,["tunedModelDisplayName"],F),e}function q8(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Om(s))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y8 extends Ds{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new ru(Es.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Am.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=F8(e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Om(g))}else{const f=A8(e);return c=je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>C2(g))}}async listInternal(e){var n,r,a,s;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=P8(e);return c=je("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=q8(g),_=new y_;return Object.assign(_,v),_})}else{const f=N8(e);return c=je("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(g=>g.json()),l.then(g=>{const v=H8(g),_=new y_;return Object.assign(_,v),_})}}async tuneInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const c=j8(e);return s=je("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Om(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=I8(e);return s=je("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>$8(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class W8{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const J8=1024*1024*8,K8=3,X8=1e3,Z8=2,Wh="x-goog-upload-status";async function Q8(t,e,n){var r,a,s;let l=0,c=0,d=new km(new Response),f="upload";for(l=t.size;c<l;){const v=Math.min(J8,l-c),_=t.slice(c,c+v);c+v>=l&&(f+=", finalize");let T=0,E=X8;for(;T<K8&&(d=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(v)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[Wh]));)T++,await tL(E),E=E*Z8;if(c+=v,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[Wh])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[Wh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function eL(t){return{size:t.size,type:t.type}}function tL(t){return new Promise(e=>setTimeout(e,t))}class nL{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Q8(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await eL(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rL{create(e,n,r){return new aL(e,n,r)}}class aL{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const q_="x-goog-api-key";class iL{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(q_)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(q_,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sL="gl-node/";class oL{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=eR(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new iL(this.apiKey);this.apiClient=new wF({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:sL+"web",uploader:new nL,downloader:new W8}),this.models=new BF(this.apiClient),this.live=new FF(this.apiClient,a,new rL),this.batches=new k3(this.apiClient),this.chats=new D5(this.models,this.apiClient),this.caches=new N5(this.apiClient),this.files=new z5(this.apiClient),this.operations=new KF(this.apiClient),this.authTokens=new b8(this.apiClient),this.tunings=new Y8(this.apiClient)}}const aa="gemini-2.5-flash-preview-04-17";let Ht=null;const Jh=t=>{if(!t){Ht=null;return}try{Ht=new oL({apiKey:t})}catch(e){console.error("Failed to initialize Gemini AI:",e),Ht=null}},Is=t=>{const e=n=>{const{position:r,extendedDetails:a,...s}=n,l={...s};if(a){const{reportDeck:c,attachments:d,subSteps:f,decisions:g,...v}=a,_={...v};c&&c.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=c.slides.length),d&&d.length>0&&(_.attachments=d.map(T=>({id:T.id,name:T.name,type:T.type}))),f&&f.length>0&&(_.subSteps=f.map(T=>{const{position:E,attachments:S,actionItems:C,...k}=T,A={...k};return S&&S.length>0&&(A.attachments=S.map(b=>({id:b.id,name:b.name,type:b.type}))),C&&C.length>0&&(A.actionItems=C.map(b=>{const{report:D,...B}=b,G={...B};if(D){const{attachments:F,...W}=D,U={...W};F&&F.length>0&&(U.attachments=F.map(ae=>({id:ae.id,name:ae.name,type:ae.type}))),G.report=U}return G})),A})),l.extendedDetails=_}return l};return Array.isArray(t)?t.map(e):e(t)},wd=t=>({...t,slides:t.slides.map(e=>{if(e.isLocked)return{id:e.id,isLocked:!0,summary:`Locked Slide: Contains ${e.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=e;return{...r,elements:n.map(a=>{var s;if(a.type==="flowchart"&&((s=a.data)!=null&&s.subSteps)){const l=a;return{...l,data:{subStepCount:l.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${l.data.subSteps.length}]`}}}return a})}})}),lL=t=>{const e=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return t.replace(e,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Sa=t=>{let e=t.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=e.match(n);if(r&&r[1]&&(e=r[1].trim()),e=lL(e),e=e.replace(/"((?:\\.|[^"\\])*)"/g,(a,s)=>`"${s.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=e.indexOf("{"),s=e.indexOf("[");if(a===-1&&s===-1)throw console.error("No JSON object or array found in the response string.",t),new Error(`AI response did not contain a valid JSON structure. Raw response: ${t.substring(0,500)}...`);const l=a===-1?s:s===-1?a:Math.min(a,s),c=e.lastIndexOf("}"),d=e.lastIndexOf("]"),f=Math.max(c,d);l>-1&&f>l&&(e=e.substring(l,f+1))}try{return JSON.parse(e)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,t,`
Processed string:`,e),new Error(`Failed to parse AI response as JSON. Raw response: ${t.substring(0,500)}...`)}},ia=(t,e)=>{console.error(`Error in Gemini API call during ${e}:`,t);let n=`AI (${e})`;if(t instanceof Error){const r=t.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="API(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="APIGoogle AI Platform(You have exceeded your API quota.)":n=`AI (${e}): ${t.message}`}throw new Error(n)},cL=async(t,e)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${t}"
    - Target Completion Date: "${e}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Ht.models.generateContent({model:aa,contents:n,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(s=>!s.id||!s.title||!s.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){ia(r,"project plan generation")}},uL=async t=>{var n;if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${t.title}"
    - Task Description: "${t.description}"
    - Required Resources: "${((n=t.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Ht.models.generateContent({model:aa,contents:e,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(s=>!s.title||!s.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){ia(r,"step proposal generation")}},fL=async(t,e)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Is(t))}
        - Existing Decisions List: ${JSON.stringify(e)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Ht.models.generateContent({model:aa,contents:n,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(s=>!s.question||!s.status||!s.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){ia(r,"decision generation")}},dL=async(t,e,n)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Is(e))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(wd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Ht.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),s=Sa(a.text);if(!s||!Array.isArray(s.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return s}catch(a){ia(a,"slide deck regeneration")}},hL=async t=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(wd(t))}
    `;try{const n=await Ht.models.generateContent({model:aa,contents:e,config:{responseMimeType:"application/json"}}),r=Sa(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){ia(n,"slide layout optimization")}},mL=async(t,e,n)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${e}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Is(t),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Ht.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),s=Sa(a.text);if(!s||!s.overallStatus||!s.summary)throw new Error("AI returned an invalid format for the project health report.");return s}catch(a){ia(a,"project health report generation")}},pL=async(t,e,n)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Is(t),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Ht.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),s=Sa(a.text);if(!s||!Array.isArray(s.slides))throw new Error("AI returned an invalid format for the project slide deck.");return s}catch(a){ia(a,"project report deck generation")}},gL=async(t,e,n,r)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Is(e),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(wd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const s=await Ht.models.generateContent({model:aa,contents:a,config:{responseMimeType:"application/json"}}),l=Sa(s.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return l}catch(s){ia(s,"project report deck regeneration")}},xL=t=>{const e=t.match(/^data:(.+);base64,(.*)$/);return e?{mimeType:e[1],data:e[2]}:null},b2=t=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const e=[];for(const n of t){if(e.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=xL(n.content);r?e.push({inlineData:{mimeType:r.mimeType,data:r.data}}):e.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?wd(n.content):Is(n.content);e.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else e.push({text:`Type: Text
Content: ${n.content}`});e.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return e},A2=async(t,e)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${e}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...b2(t)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Ht.models.generateContent({model:aa,contents:{parts:r},config:{responseMimeType:"application/json"}}),s=Sa(a.text);if(!s||!Array.isArray(s.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return s}catch(a){ia(a,"custom slide deck generation")}},vL=async(t,e)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${e}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...b2(t)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Ht.models.generateContent({model:aa,contents:{parts:r}})).text}catch(a){ia(a,"custom text report generation")}},Y_=async(t,e,n)=>{if(!Ht)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${e}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Is(t),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Ht.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),s=Sa(a.text);if(!s||!Array.isArray(s))throw new Error("AI returned an invalid format for the Gantt chart data.");return s}catch(a){ia(a,"Gantt chart data generation")}},Jr="Supabase";class Vn{static async getProjects(){if(!rt)throw new Error(Jr);const{data:{user:e}}=await rt.auth.getUser();if(!e)throw new Error("");const{data:n,error:r}=await rt.from("projects").select(`
        *,
        project_members!inner(role)
      `).order("updated_at",{ascending:!1});if(r)throw new Error(`: ${r.message}`);return n.map(a=>{var s;return{id:a.id,title:a.title,goal:a.goal,targetDate:a.target_date,tasks:a.tasks_data||[],ganttData:a.gantt_data,createdAt:a.created_at,updatedAt:a.updated_at,lastModifiedBy:a.last_modified_by,version:a.version||1,userRole:((s=a.project_members[0])==null?void 0:s.role)||"viewer"}})}static async getProjectWithMembers(e){var d;if(!rt)throw new Error(Jr);const{data:{user:n}}=await rt.auth.getUser();if(!n)throw new Error("");const{data:r,error:a}=await rt.from("projects").select("*, project_members!inner(role)").eq("id",e).single();if(a)throw new Error(`: ${a.message}`);const{data:s,error:l}=await rt.from("project_members_with_email").select("*").eq("project_id",e);if(l)throw console.error(":",l),new Error(`: ${l.message}`);const c=s.map(f=>{var g;return{id:f.id,projectId:f.project_id,userId:f.user_id,role:f.role,invitedBy:f.invited_by,invitedAt:f.invited_at,joinedAt:f.joined_at,status:f.status,userEmail:((g=f.user_profiles)==null?void 0:g.email)||""}});return{id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at,lastModifiedBy:r.last_modified_by,version:r.version||1,userRole:((d=r.project_members[0])==null?void 0:d.role)||"viewer",members:c}}static async createProject(e,n,r,a=[],s){if(!rt)throw new Error(Jr);const{data:{user:l}}=await rt.auth.getUser();if(!l)throw new Error("");const{data:c,error:d}=await rt.from("projects").insert({user_id:l.id,title:e,goal:n,target_date:r,tasks_data:a,gantt_data:s,last_modified_by:l.id,version:1}).select().single();if(d)throw new Error(`: ${d.message}`);return{id:c.id,title:c.title,goal:c.goal,targetDate:c.target_date,tasks:c.tasks_data||[],ganttData:c.gantt_data,createdAt:c.created_at,updatedAt:c.updated_at,lastModifiedBy:c.last_modified_by,version:c.version,userRole:"owner"}}static async updateProject(e,n){var c;if(!rt)throw new Error(Jr);const{data:{user:r}}=await rt.auth.getUser();if(!r)throw new Error("");const a={};n.title!==void 0&&(a.title=n.title),n.goal!==void 0&&(a.goal=n.goal),n.targetDate!==void 0&&(a.target_date=n.targetDate),n.tasks!==void 0&&(a.tasks_data=n.tasks),n.ganttData!==void 0&&(a.gantt_data=n.ganttData);const{data:s,error:l}=await rt.from("projects").update(a).eq("id",e).select(`
      *,
      project_members!inner(role)
    `).single();if(l)throw new Error(`: ${l.message}`);return{id:s.id,title:s.title,goal:s.goal,targetDate:s.target_date,tasks:s.tasks_data||[],ganttData:s.gantt_data,createdAt:s.created_at,updatedAt:s.updated_at,lastModifiedBy:s.last_modified_by,version:s.version||1,userRole:((c=s.project_members[0])==null?void 0:c.role)||"viewer"}}static async deleteProject(e){if(!rt)throw new Error(Jr);const{error:n}=await rt.from("projects").delete().eq("id",e);if(n)throw new Error(`: ${n.message}`)}static async getProject(e){var a;if(!rt)throw new Error(Jr);const{data:n,error:r}=await rt.from("projects").select(`
        *,
        project_members!inner(role)
      `).eq("id",e).single();if(r)throw new Error(`: ${r.message}`);return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,version:n.version||1,userRole:((a=n.project_members[0])==null?void 0:a.role)||"viewer"}}static async inviteToProject(e,n,r){if(!rt)throw new Error(Jr);const{data:{user:a}}=await rt.auth.getUser();if(!a)throw new Error("");const{data:s,error:l}=await rt.from("project_invitations").insert({project_id:e,email:n,role:r,invited_by:a.id}).select().single();if(l)throw new Error(`: ${l.message}`);return{id:s.id,projectId:s.project_id,email:s.email,role:s.role,invitedBy:s.invited_by,token:s.token,expiresAt:s.expires_at,createdAt:s.created_at,usedAt:s.used_at}}static async joinProjectByInvitation(e){if(!rt)throw new Error(Jr);const{data:n,error:r}=await rt.rpc("join_project_by_invitation",{invitation_token:e});if(r)throw new Error(`: ${r.message}`);return n}static async getProjectInvitations(e){if(!rt)throw new Error(Jr);const{data:n,error:r}=await rt.from("project_invitations").select("*").eq("project_id",e).is("used_at",null).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(r)throw new Error(`: ${r.message}`);return n.map(a=>({id:a.id,projectId:a.project_id,email:a.email,role:a.role,invitedBy:a.invited_by,token:a.token,expiresAt:a.expires_at,createdAt:a.created_at,usedAt:a.used_at}))}static async updateMemberRole(e,n,r){if(!rt)throw new Error(Jr);const{error:a}=await rt.from("project_members").update({role:r}).eq("project_id",e).eq("user_id",n);if(a)throw new Error(`: ${a.message}`)}static async removeMember(e,n){if(!rt)throw new Error(Jr);const{error:r}=await rt.from("project_members").delete().eq("project_id",e).eq("user_id",n);if(r)throw new Error(`: ${r.message}`)}static subscribeToProjectChanges(e,n,r){if(!rt)return console.warn("Supabase"),()=>{};const a=rt.channel(`project-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${e}`},n).on("postgres_changes",{event:"*",schema:"public",table:"project_members",filter:`project_id=eq.${e}`},r).subscribe();return()=>{rt.removeChannel(a)}}}const _n=({size:t="md",color:e="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return x.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[x.jsx("div",{className:`animate-spin rounded-full border-4 ${e} border-t-transparent ${r[t]}`}),n&&x.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},Td=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),pp=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),yL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),fr=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),k2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),N2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),el=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),R2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ka=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),Ed=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),gs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),M2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Ss=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),_L=({title:t,...e})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[t&&x.jsx("title",{children:t}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),gp=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),xp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),wL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),Sd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),D2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),TL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),EL=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),SL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),CL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),bL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),AL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),I2=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),kL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),NL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),RL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),jc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),vp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),ML=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),DL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),Oi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),F2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),IL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),FL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),L2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Cs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Vc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),bs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),Hc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),ed=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),LL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),PL=({onSubmit:t,isLoading:e,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:s="",onOpenProjectList:l,onLogout:c,user:d})=>{const[f,g]=H.useState(a),[v,_]=H.useState(s),T=H.useRef(null);ys.useEffect(()=>{g(a)},[a]),ys.useEffect(()=>{_(s)},[s]);const E=new Date().toISOString().split("T")[0],S=D=>{if(D.preventDefault(),!f.trim()||!v){alert("");return}t(f,v)},C=()=>{var D;(D=T.current)==null||D.click()},k=D=>{var G;const B=(G=D.target.files)==null?void 0:G[0];B&&(n(B),D.target.value="")},A=D=>{if(!f.trim()||!v){alert("");return}r(D,f,v)},b=({template:D,title:B,description:G,disabled:F})=>x.jsxs("button",{type:"button",onClick:()=>A(D),disabled:F,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[x.jsx("div",{className:"font-semibold text-md",children:B}),x.jsx("div",{className:"text-xs text-purple-200 mt-1",children:G})]});return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[x.jsxs("div",{className:"text-white text-sm",children:[": ",d==null?void 0:d.email]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[x.jsx(Cs,{className:"w-5 h-5"}),""]}),x.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[x.jsx(Hc,{className:"w-5 h-5"}),""]})]})]}),x.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[x.jsxs("div",{className:"text-center mb-10",children:[x.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),x.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),x.jsxs("form",{onSubmit:S,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(pp,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),x.jsx("textarea",{id:"projectGoal",value:f,onChange:D=>g(D.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Td,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),x.jsx("input",{type:"date",id:"targetDate",value:v,onChange:D=>_(D.target.value),min:E,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),x.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[rt&&x.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:e?x.jsx(_n,{size:"sm",color:"border-white"}):"AI"}),x.jsxs("button",{type:"button",onClick:C,disabled:e,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[x.jsx(N2,{className:"w-5 h-5 mr-2"})," (.json)"]}),x.jsx("input",{type:"file",ref:T,onChange:k,accept:".json",className:"hidden","aria-hidden":"true"})]}),x.jsxs("div",{className:"sm:col-span-2 pt-4",children:[x.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[x.jsx(b,{template:"process-design",disabled:e,title:" (APQP)",description:"APQP"}),x.jsx(b,{template:"process-change",disabled:e,title:" (ISO/IATF)",description:""}),x.jsx(b,{template:"new-product-eval",disabled:e,title:"",description:""}),x.jsx(b,{template:"improvement-project",disabled:e,title:"",description:"DMAIC"}),x.jsx(b,{template:"equipment-modification",disabled:e,title:"",description:""})]})]})]})]}),x.jsx("footer",{className:"mt-12 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})},kf=t=>{switch(t){case ms.IN_PROGRESS:return{icon:x.jsx(EL,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case ms.COMPLETED:return{icon:x.jsx(Ed,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case ms.BLOCKED:return{icon:x.jsx(SL,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case ms.NOT_STARTED:default:return{icon:x.jsx(TL,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},OL=({task:t,onSelectTask:e,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:s,cardRef:l,onStartConnection:c,onEndConnection:d,canEdit:f=!0})=>{var F,W,U,ae;const[g,v]=H.useState(!1),_=H.useRef(null);H.useEffect(()=>{const z=ee=>{_.current&&!_.current.contains(ee.target)&&v(!1)};return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[_]);const T=z=>{f&&(r(t.id,z),v(!1))},E=(F=t.extendedDetails)==null?void 0:F.numericalTarget;let S="text-slate-500";E&&(E.status===ym.ACHIEVED?S="text-green-600":E.status===ym.MISSED?S="text-red-600":S="text-yellow-600");const C=kf(t.status),k=(W=t.extendedDetails)==null?void 0:W.dueDate,A=k?new Date(k+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,b=t.status===ms.IN_PROGRESS,D="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",B=b?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",G=z=>{z.stopPropagation(),c(t.id,z)};return x.jsxs("div",{ref:l,id:`taskcard-${t.id}`,draggable:"true",onDragStart:z=>a(z,t.id),onMouseUp:()=>d(t.id),className:`${D} ${B}`,style:{position:"absolute",left:((U=t.position)==null?void 0:U.x)||0,top:((ae=t.position)==null?void 0:ae.y)||0,touchAction:"none"},children:[x.jsxs("div",{className:"p-5 relative",children:[x.jsx("div",{onMouseDown:G,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[x.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:s+1}),x.jsx("div",{className:"flex-grow min-w-0",children:x.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${t.title}`,children:t.title})})]}),x.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&x.jsx(_L,{className:`w-5 h-5 ${S}`,title:`: ${E.description} (${E.status})`}),x.jsx("button",{onClick:z=>{z.stopPropagation(),e(t)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${t.title}`,children:x.jsx(yL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:z=>{z.stopPropagation(),f&&n(t.id)},disabled:!f,className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:f?"":"","aria-label":`: ${t.title}`,children:x.jsx(Ka,{className:"w-5 h-5"})})]})]}),x.jsx("div",{className:"h-20 mb-3",children:x.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:t.description})}),x.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[x.jsxs("div",{className:"relative",ref:_,children:[x.jsxs("button",{onClick:()=>v(z=>!z),disabled:!f,className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${C.bgColor} ${C.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:f?"":"",children:[ys.cloneElement(C.icon,{className:`w-3 h-3 mr-1 ${C.color}`}),C.text]}),g&&f&&x.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(ms).map(z=>x.jsxs("button",{onClick:()=>T(z),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[ys.cloneElement(kf(z).icon,{className:`w-3.5 h-3.5 mr-2 ${kf(z).color}`}),kf(z).text]},z))})]}),A&&x.jsxs("div",{className:"flex items-center text-orange-600",children:[x.jsx(D2,{className:"w-3.5 h-3.5 mr-1"}),": ",A]})]})]}),x.jsx("button",{onClick:z=>{z.stopPropagation(),e(t)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:f?" ":" "})]})},UL=H.memo(OL),Um=({from:t,to:e,id:n,onDelete:r})=>{const l=t.x,c=e.x,d=(l+c)/2,f=(t.y+e.y)/2,g=`M${l},${t.y} C${l+50},${t.y} ${c-50},${e.y} ${c},${e.y}`;return x.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[x.jsx("defs",{children:x.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:x.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),x.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[x.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),x.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&x.jsxs("g",{transform:`translate(${d}, ${f})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[x.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),x.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},BL=({tasks:t,onClose:e})=>{const[n,r]=H.useState("all"),[a,s]=H.useState(""),[l,c]=H.useState(null),d=H.useMemo(()=>{const E=[];return t.forEach(S=>{var C,k;(k=(C=S.extendedDetails)==null?void 0:C.subSteps)==null||k.forEach(A=>{var b;(b=A.actionItems)==null||b.forEach(D=>{E.push({actionItem:D,subStep:A,task:S})})})}),E},[t]),f=H.useMemo(()=>d.filter(E=>n==="completed"?E.actionItem.completed:n==="pending"?!E.actionItem.completed:!0).filter(E=>{const S=a.toLowerCase();return E.actionItem.text.toLowerCase().includes(S)||E.subStep.text.toLowerCase().includes(S)||(E.subStep.responsible||"").toLowerCase().includes(S)||E.task.title.toLowerCase().includes(S)}),[d,n,a]),g=H.useMemo(()=>{let E=[...f];return l!==null&&E.sort((S,C)=>{let k="",A="";switch(l.key){case"status":k=S.actionItem.completed,A=C.actionItem.completed;break;case"actionItem":k=S.actionItem.text.toLowerCase(),A=C.actionItem.text.toLowerCase();break;case"responsible":k=(S.subStep.responsible||"").toLowerCase(),A=(C.subStep.responsible||"").toLowerCase();break;case"subStep":k=S.subStep.text.toLowerCase(),A=C.subStep.text.toLowerCase();break;case"task":k=S.task.title.toLowerCase(),A=C.task.title.toLowerCase();break;case"dueDate":k=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",A=C.actionItem.dueDate||C.subStep.dueDate||"9999-12-31";break}return k<A?l.direction==="ascending"?-1:1:k>A?l.direction==="ascending"?1:-1:0}),E},[f,l]),v=E=>{let S="ascending";l&&l.key===E&&l.direction==="ascending"&&(S="descending"),c({key:E,direction:S})},_=E=>!l||l.key!==E?x.jsx(Vc,{className:"w-3 h-3 ml-1 opacity-20"}):l.direction==="ascending"?x.jsx(Vc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(bs,{className:"w-3 h-3 ml-1 text-blue-600"}),T=({sortKey:E,label:S,className:C})=>x.jsx("th",{scope:"col",className:`px-6 py-3 ${C||""}`,children:x.jsxs("button",{onClick:()=>v(E),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,_(E)]})});return x.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:x.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[x.jsx(k2,{className:"w-5 h-5"}),""]})]})}),x.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[x.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:x.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[x.jsx("input",{type:"text",placeholder:"...",value:a,onChange:E=>s(E.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),x.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),x.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),x.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),x.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:x.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[x.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:x.jsxs("tr",{children:[x.jsx(T,{sortKey:"status",label:"",className:"w-24"}),x.jsx(T,{sortKey:"actionItem",label:""}),x.jsx(T,{sortKey:"responsible",label:""}),x.jsx(T,{sortKey:"subStep",label:""}),x.jsx(T,{sortKey:"task",label:""}),x.jsx(T,{sortKey:"dueDate",label:""})]})}),x.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:E,subStep:S,task:C},k)=>x.jsxs("tr",{className:"hover:bg-slate-50",children:[x.jsx("td",{className:"px-6 py-3",children:E.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(gp,{className:"w-4 h-4 mr-1"}),""]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(xp,{className:"w-4 h-4 mr-1"}),""]})}),x.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:E.text}),x.jsx("td",{className:"px-6 py-3",children:S.responsible||""}),x.jsx("td",{className:"px-6 py-3",children:S.text}),x.jsx("td",{className:"px-6 py-3",children:C.title}),x.jsx("td",{className:"px-6 py-3",children:E.dueDate||S.dueDate?new Date((E.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},E.id+k)),g.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},W_={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:x.jsx(Ed,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:x.jsx(gs,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:x.jsx(gs,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:x.jsx(gs,{className:"w-12 h-12 text-slate-500"})}},jL=({report:t,onClose:e})=>{if(!t)return null;const n=W_[t.overallStatus]||W_.Unknown;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),x.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[x.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[x.jsx("div",{className:"flex-shrink-0",children:n.icon}),x.jsxs("div",{children:[x.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:t.overallStatus}),x.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:t.summary})]})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Ed,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),x.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:t.positivePoints.map((r,a)=>x.jsx("li",{children:r},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(gs,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),x.jsx("div",{className:"space-y-3",children:t.areasOfConcern.map((r,a)=>x.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[x.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&x.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(M2,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),x.jsx("div",{className:"space-y-3",children:t.suggestions.map((r,a)=>x.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:x.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),x.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},Fs=({message:t})=>t?x.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:t})]}):null,VL=({isOpen:t,onClose:e,projectId:n,projectTitle:r,members:a,userRole:s,onMembersUpdate:l})=>{const[c,d]=H.useState(""),[f,g]=H.useState("editor"),[v,_]=H.useState([]),[T,E]=H.useState(!1),[S,C]=H.useState(!1),[k,A]=H.useState(null),b=s==="owner"||s==="editor";H.useEffect(()=>{t&&b&&D()},[t,n,b]);const D=async()=>{C(!0);try{const z=await Vn.getProjectInvitations(n);_(z)}catch(z){A(z instanceof Error?z.message:"")}finally{C(!1)}},B=async z=>{if(z.preventDefault(),!c.trim()){A("");return}if(a.some(ee=>ee.userEmail===c.trim())){A("");return}if(v.some(ee=>ee.email===c.trim())){A("");return}E(!0),A(null);try{await Vn.inviteToProject(n,c.trim(),f),d(""),await D(),l()}catch(ee){A(ee instanceof Error?ee.message:"")}finally{E(!1)}},G=async(z,ee)=>{if(s==="owner")try{await Vn.updateMemberRole(n,z,ee),l()}catch(Ee){A(Ee instanceof Error?Ee.message:"")}},F=async z=>{if(s==="owner"&&confirm(""))try{await Vn.removeMember(n,z),l()}catch(ee){A(ee instanceof Error?ee.message:"")}},W=z=>{const ee=`${window.location.origin}/invite/${z}`;navigator.clipboard.writeText(ee).then(()=>{alert("")})},U=z=>{switch(z){case"owner":return"";case"editor":return"";case"viewer":return"";default:return z}},ae=z=>{switch(z){case"owner":return"bg-purple-100 text-purple-800";case"editor":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500 mt-1",children:r})]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[k&&x.jsx(Fs,{message:k}),b&&x.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(LL,{className:"w-5 h-5 mr-2"}),""]}),x.jsx("form",{onSubmit:B,className:"space-y-3",children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[x.jsx("input",{type:"email",value:c,onChange:z=>d(z.target.value),placeholder:"",className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T}),x.jsxs("select",{value:f,onChange:z=>g(z.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T,children:[x.jsx("option",{value:"editor",children:""}),x.jsx("option",{value:"viewer",children:""})]}),x.jsxs("button",{type:"submit",disabled:T,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[T?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Ss,{className:"w-4 h-4"}),""]})]})})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(ed,{className:"w-5 h-5 mr-2"})," (",a.length,")"]}),x.jsx("div",{className:"space-y-2",children:a.map(z=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center",children:x.jsx(ed,{className:"w-4 h-4 text-slate-600"})}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:z.userEmail}),x.jsxs("p",{className:"text-xs text-slate-500",children:[": ",new Date(z.joinedAt||z.invitedAt).toLocaleDateString("ja-JP")]})]})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[s==="owner"&&z.role!=="owner"?x.jsxs("select",{value:z.role,onChange:ee=>G(z.userId,ee.target.value),className:"text-xs px-2 py-1 border border-slate-300 rounded",children:[x.jsx("option",{value:"editor",children:""}),x.jsx("option",{value:"viewer",children:""})]}):x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ae(z.role)}`,children:U(z.role)}),s==="owner"&&z.role!=="owner"&&x.jsx("button",{onClick:()=>F(z.userId),className:"p-1 text-red-500 hover:text-red-700 rounded",title:"",children:x.jsx(Ka,{className:"w-4 h-4"})})]})]},z.id))})]}),b&&x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(D2,{className:"w-5 h-5 mr-2"}),""]}),S?x.jsx("div",{className:"flex justify-center py-4",children:x.jsx(_n,{size:"md"})}):v.length===0?x.jsx("p",{className:"text-slate-500 text-sm",children:""}):x.jsx("div",{className:"space-y-2",children:v.map(z=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:z.email}),x.jsxs("p",{className:"text-xs text-slate-500",children:[U(z.role),"   : ",new Date(z.expiresAt).toLocaleDateString("ja-JP")]})]}),x.jsx("button",{onClick:()=>W(z.token),className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:""})]},z.id))})]})]}),x.jsx("footer",{className:"p-6 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700",children:""})})]})}):null},J_=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},HL=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],s=t.map((l,c)=>{const d=l.value/n,[f,g]=J_(r);r+=d;const[v,_]=J_(r),T=d>.5?1:0;return{path:[`M ${f} ${g}`,`A 1 1 0 ${T} 1 ${v} ${_}`,"L 0 0"].join(" "),color:a[c%a.length],label:l.label}});return x.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[x.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:e}),x.jsxs("div",{className:"flex-grow flex items-center",children:[x.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:s.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:s.map((l,c)=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:l.color}}),x.jsx("span",{className:"truncate",children:l.label})]},c))})]})]})},$L=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,s={top:20,right:10,bottom:30,left:30},l=r-s.left-s.right,c=a-s.top-s.bottom,d=t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return`${v},${_}`}).join(" ");return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:s.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${s.left}, ${s.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("line",{x1:"0",y1:c,x2:l,y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:d}),t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return x.jsx("circle",{cx:v,cy:_,r:"2",fill:"#4a90e2"},g)})]})]})},GL=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,s={top:20,right:10,bottom:30,left:30},l=r-s.left-s.right,c=a-s.top-s.bottom,d=t.length>0?l/t.length*.8:0;return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:s.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${s.left}, ${s.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(f=>x.jsxs("g",{transform:`translate(0, ${c-f/n*c})`,children:[x.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),x.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:f.toFixed(0)})]},f)),t.map((f,g)=>x.jsxs("g",{transform:`translate(${g*l/t.length+l/t.length*.1}, 0)`,children:[x.jsx("rect",{x:"0",y:c-f.value/n*c,width:d,height:f.value/n*c,fill:"#4a90e2"}),x.jsx("text",{x:d/2,y:c+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${d/2}, ${c+8})`,children:f.label})]},f.label))]})]})},zL=({subStep:t,statusColor:e})=>{var n,r;return x.jsx("div",{style:{position:"absolute",left:((n=t.position)==null?void 0:n.x)||0,top:((r=t.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${e}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:x.jsx("p",{className:`font-bold break-words ${t.status===Wo.COMPLETED?"line-through text-slate-500":""}`,children:t.text})})},qL=({subSteps:t})=>{if(!t||t.length===0)return x.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const e=l=>{switch(l){case Wo.COMPLETED:return"#22c55e";case Wo.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=H.useMemo(()=>{const l=[];return(t||[]).forEach(c=>{var d;if((d=c==null?void 0:c.nextSubStepIds)!=null&&d.length&&c.position){const f={x:c.position.x+n,y:c.position.y+r/2};c.nextSubStepIds.forEach(g=>{const v=t.find(_=>_.id===g);if(v&&v.position){const _={x:v.position.x,y:v.position.y+r/2};l.push({id:`fc-render-${c.id}-${g}`,from:f,to:_,sourceId:c.id,targetId:g})}})}}),l},[t,n,r]),s=H.useMemo(()=>{if(!t||t.length===0)return{minX:0,minY:0,width:400,height:300};let l=0,c=0;return t.forEach(d=>{d.position&&(l=Math.max(l,d.position.x+n),c=Math.max(c,d.position.y+r))}),{minX:0,minY:0,width:l+20,height:c+20}},[t,n,r]);return x.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:x.jsxs("svg",{width:"100%",height:"100%",viewBox:`${s.minX} ${s.minY} ${s.width} ${s.height}`,children:[x.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),x.jsx("foreignObject",{x:"0",y:"0",width:s.width,height:s.height,children:x.jsx("div",{className:"flowchart-card-container",children:(t||[]).map(l=>x.jsx(zL,{subStep:l,statusColor:e(l.status)},l.id))})}),a.map(l=>x.jsx(Um,{from:l.from,to:l.to,id:l.id},l.id))]})})},YL=({el:t,onUpdate:e,children:n,isSelected:r,onClick:a})=>x.jsx("div",{onClick:s=>{s.stopPropagation(),a()},style:{position:"absolute",left:`${t.position.x}%`,top:`${t.position.y}%`,width:`${t.position.width}%`,height:`${t.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),WL=({tasks:t,initialDeck:e,onSave:n,onClose:r,generateUniqueId:a,projectGoal:s,targetDate:l,reportScope:c})=>{const[d,f]=H.useState(e),[g,v]=H.useState(0),[_,T]=H.useState(null),[E,S]=H.useState(!1),[C,k]=H.useState(null),[A,b]=H.useState(!1),D=H.useRef(null),B=(re,J)=>{f(M=>({...M,slides:M.slides.map(Q=>Q.id===re?{...Q,...typeof J=="function"?J(Q):Q}:Q)}))},G=re=>{const J=d.slides[re];B(J.id,{isLocked:!J.isLocked})},F=(re,J,M)=>{B(re,Q=>({elements:Q.elements.map(I=>I.id===J?{...I,...M}:I)}))},W=async()=>{S(!0),k(null);try{const re={...d,slides:d.slides.map(Q=>Q.isLocked?Q:{...Q,isLocked:void 0})},J=await hL(re),M={...J,slides:J.slides.map((Q,I)=>({...Q,isLocked:d.slides[I].isLocked}))};f(M)}catch(re){k(re instanceof Error?re.message:"")}finally{S(!1)}},U=async()=>{S(!0),k(null);try{let re;c==="project"?re=await gL(d,t,s,l):re=await dL(d,t[0],s),f(re)}catch(re){k(re instanceof Error?re.message:"")}finally{S(!1)}},ae=(re,J)=>{var M,Q,I;for(const X of t){const K=(Q=(M=X.extendedDetails)==null?void 0:M.subSteps)==null?void 0:Q.find(P=>P.id===re);if(K){const P=(I=K==null?void 0:K.actionItems)==null?void 0:I.find(te=>te.id===J);if(P)return P}}},z=re=>{var J,M,Q,I,X;switch(re.type){case"textbox":const K=re;return x.jsx("textarea",{value:K.content,onChange:P=>F(d.slides[g].id,re.id,{content:P.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:K.fontSize,fontWeight:K.fontWeight,textAlign:K.textAlign,color:"#333"}});case"image":{const P=re,te=ae(P.subStepId,P.actionItemId),me=(M=(J=te==null?void 0:te.report)==null?void 0:J.attachments)==null?void 0:M.find(ve=>ve.id===P.attachmentId);return me?x.jsx("img",{src:me.dataUrl,className:"w-full h-full object-contain",alt:me.name}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const P=re,te=ae(P.subStepId,P.actionItemId),me=(Q=te==null?void 0:te.report)==null?void 0:Q.matrixData;return me?x.jsx("div",{className:"p-2 overflow-auto h-full",children:x.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[x.jsx("thead",{children:x.jsx("tr",{className:"bg-slate-200",children:me.headers.map((ve,ye)=>x.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:ve},ye))})}),x.jsx("tbody",{children:me.rows.map((ve,ye)=>x.jsx("tr",{children:ve.map((_e,$e)=>x.jsx("td",{className:"border border-slate-300 p-1",children:_e},`${ye}-${$e}`))},ye))})]})}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const P=re,te=ae(P.subStepId,P.actionItemId),me=(((X=(I=te==null?void 0:te.report)==null?void 0:I.matrixData)==null?void 0:X.rows)||[]).map(ve=>({label:ve[0],value:parseFloat(ve[1])||0})).filter(ve=>ve.label&&!isNaN(ve.value));if(me.length===0)return x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(P.chartType){case"line":return x.jsx($L,{data:me,title:P.title});case"pie":return x.jsx(HL,{data:me,title:P.title});case"bar":default:return x.jsx(GL,{data:me,title:P.title})}}case"flowchart":{const P=re;return P.data&&P.data.subSteps?x.jsx(qL,{subSteps:P.data.subSteps}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},ee=()=>window.print(),Ee=(re,J)=>{const M=JSON.stringify(re,null,2),Q=new Blob([M],{type:"application/json"}),I=URL.createObjectURL(Q),X=document.createElement("a");X.href=I,X.download=J,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(I)},Ae=re=>{re==="pdf"?ee():Ee(d,"report-deck.json"),b(!1)},we=()=>{n(d),r()},ie=d.slides[g],de=c==="project"?`: ${s}`:`: ${t[0].title}`;return x.jsxs(x.Fragment,{children:[x.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),x.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>T(null),children:[x.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[x.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:de}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsxs("button",{onClick:U,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[x.jsx(Sd,{className:"w-4 h-4"})," ",E?"...":""]}),x.jsxs("button",{onClick:W,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[x.jsx(M2,{className:"w-4 h-4"})," ",E?"...":"AI"]}),x.jsxs("div",{className:"relative",ref:D,children:[x.jsx("button",{onClick:()=>b(re=>!re),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:x.jsx(el,{className:"w-5 h-5"})}),A&&x.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[x.jsx("button",{onClick:()=>Ae("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),x.jsx("button",{onClick:()=>Ae("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),x.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",x.jsx(fr,{className:"w-5 h-5"})]}),x.jsx("button",{onClick:we,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),C&&x.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:C}),x.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[x.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:d.slides.map((re,J)=>x.jsxs("div",{onClick:()=>v(J),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===J?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[x.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:x.jsx("button",{onClick:M=>{M.stopPropagation(),G(J)},title:re.isLocked?"":"",className:`p-1 rounded-full ${re.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:re.isLocked?x.jsx(ML,{className:"w-3 h-3"}):x.jsx(DL,{className:"w-3 h-3"})})}),x.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:re.elements.map(M=>x.jsx("div",{style:{position:"absolute",left:`${M.position.x}%`,top:`${M.position.y}%`,width:`${M.position.width}%`,height:`${M.position.height}%`,backgroundColor:"#ccc"}},M.id))}),x.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:J+1})]},re.id))}),x.jsx("main",{className:"flex-grow flex items-center justify-center",children:ie&&x.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:ie.elements.map(re=>x.jsx(YL,{el:re,onUpdate:()=>{},isSelected:_===re.id,onClick:()=>T(re.id),children:z(re)},re.id))})}),x.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[x.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),x.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),x.jsx("div",{className:"hidden print:block",children:d.slides.map((re,J)=>x.jsx("div",{className:"slide-print-page bg-white relative",children:x.jsx("div",{className:"w-full h-full relative",children:re.elements.map(M=>x.jsx("div",{style:{position:"absolute",left:`${M.position.x}%`,top:`${M.position.y}%`,width:`${M.position.width}%`,height:`${M.position.height}%`},children:z(M)},M.id))})},re.id))})]})},JL=({onClose:t,onDownloadAndStartNew:e,onStartNewWithoutSaving:n})=>x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[x.jsx(gs,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:x.jsx(fr,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"p-6",children:[x.jsx("p",{className:"text-slate-700",children:""}),x.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),x.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),x.jsxs("button",{type:"submit",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[x.jsx(el,{className:"w-4 h-4"}),""]})]})]})});function KL(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),e&&(r.href=e),a.href=t,a.href}const XL=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Fi(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let Fo=null;function P2(t={}){return Fo||(t.includeStyleProperties?(Fo=t.includeStyleProperties,Fo):(Fo=Fi(window.getComputedStyle(document.documentElement)),Fo))}function td(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function ZL(t){const e=td(t,"border-left-width"),n=td(t,"border-right-width");return t.clientWidth+e+n}function QL(t){const e=td(t,"border-top-width"),n=td(t,"border-bottom-width");return t.clientHeight+e+n}function O2(t,e={}){const n=e.width||ZL(t),r=e.height||QL(t);return{width:n,height:r}}function eP(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const wr=16384;function tP(t){(t.width>wr||t.height>wr)&&(t.width>wr&&t.height>wr?t.width>t.height?(t.height*=wr/t.width,t.width=wr):(t.width*=wr/t.height,t.height=wr):t.width>wr?(t.height*=wr/t.width,t.width=wr):(t.width*=wr/t.height,t.height=wr))}function nd(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function nP(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function rP(t,e,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${e}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),a.appendChild(s),s.appendChild(t),nP(a)}const ur=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||ur(n,e)};function aP(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function iP(t,e){return P2(e).map(n=>{const r=t.getPropertyValue(n),a=t.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function sP(t,e,n,r){const a=`.${t}:${e}`,s=n.cssText?aP(n):iP(n,r);return document.createTextNode(`${a}{${s}}`)}function K_(t,e,n,r){const a=window.getComputedStyle(t,n),s=a.getPropertyValue("content");if(s===""||s==="none")return;const l=XL();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(sP(l,n,a,r)),e.appendChild(c)}function oP(t,e,n){K_(t,e,":before",n),K_(t,e,":after",n)}const X_="application/font-woff",Z_="image/jpeg",lP={woff:X_,woff2:X_,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Z_,jpeg:Z_,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function cP(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function yp(t){const e=cP(t).toLowerCase();return lP[e]||""}function uP(t){return t.split(/,/)[1]}function Bm(t){return t.search(/^(data:)/)!==-1}function fP(t,e){return`data:${e};base64,${t}`}async function U2(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((s,l)=>{const c=new FileReader;c.onerror=l,c.onloadend=()=>{try{s(n({res:r,result:c.result}))}catch(d){l(d)}},c.readAsDataURL(a)})}const Kh={};function dP(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function _p(t,e,n){const r=dP(t,e,n.includeQueryParams);if(Kh[r]!=null)return Kh[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let a;try{const s=await U2(t,n.fetchRequestInit,({res:l,result:c})=>(e||(e=l.headers.get("Content-Type")||""),uP(c)));a=fP(s,e)}catch(s){a=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;s&&(l=typeof s=="string"?s:s.message),l&&console.warn(l)}return Kh[r]=a,a}async function hP(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):nd(e)}async function mP(t,e){if(t.currentSrc){const s=document.createElement("canvas"),l=s.getContext("2d");s.width=t.clientWidth,s.height=t.clientHeight,l==null||l.drawImage(t,0,0,s.width,s.height);const c=s.toDataURL();return nd(c)}const n=t.poster,r=yp(n),a=await _p(n,r,e);return nd(a)}async function pP(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await Cd(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function gP(t,e){return ur(t,HTMLCanvasElement)?hP(t):ur(t,HTMLVideoElement)?mP(t,e):ur(t,HTMLIFrameElement)?pP(t,e):t.cloneNode(B2(t))}const xP=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",B2=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function vP(t,e,n){var r,a;if(B2(e))return e;let s=[];return xP(t)&&t.assignedNodes?s=Fi(t.assignedNodes()):ur(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?s=Fi(t.contentDocument.body.childNodes):s=Fi(((a=t.shadowRoot)!==null&&a!==void 0?a:t).childNodes),s.length===0||ur(t,HTMLVideoElement)||await s.reduce((l,c)=>l.then(()=>Cd(c,n)).then(d=>{d&&e.appendChild(d)}),Promise.resolve()),e}function yP(t,e,n){const r=e.style;if(!r)return;const a=window.getComputedStyle(t);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):P2(n).forEach(s=>{let l=a.getPropertyValue(s);s==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),ur(t,HTMLIFrameElement)&&s==="display"&&l==="inline"&&(l="block"),s==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(s,l,a.getPropertyPriority(s))})}function _P(t,e){ur(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),ur(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function wP(t,e){if(ur(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(a=>t.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function TP(t,e,n){return ur(e,Element)&&(yP(t,e,n),oP(t,e,n),_P(t,e),wP(t,e)),e}async function EP(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let s=0;s<n.length;s++){const c=n[s].getAttribute("xlink:href");if(c){const d=t.querySelector(c),f=document.querySelector(c);!d&&f&&!r[c]&&(r[c]=await Cd(f,e,!0))}}const a=Object.values(r);if(a.length){const s="http://www.w3.org/1999/xhtml",l=document.createElementNS(s,"svg");l.setAttribute("xmlns",s),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const c=document.createElementNS(s,"defs");l.appendChild(c);for(let d=0;d<a.length;d++)c.appendChild(a[d]);t.appendChild(l)}return t}async function Cd(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>gP(r,e)).then(r=>vP(t,r,e)).then(r=>TP(t,r,e)).then(r=>EP(r,e))}const j2=/url\((['"]?)([^'"]+?)\1\)/g,SP=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,CP=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function bP(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function AP(t){const e=[];return t.replace(j2,(n,r,a)=>(e.push(a),n)),e.filter(n=>!Bm(n))}async function kP(t,e,n,r,a){try{const s=n?KL(e,n):e,l=yp(e);let c;return a||(c=await _p(s,l,r)),t.replace(bP(e),`$1${c}$3`)}catch{}return t}function NP(t,{preferredFontFormat:e}){return e?t.replace(CP,n=>{for(;;){const[r,,a]=SP.exec(n)||[];if(!a)return"";if(a===e)return`src: ${r};`}}):t}function V2(t){return t.search(j2)!==-1}async function H2(t,e,n){if(!V2(t))return t;const r=NP(t,n);return AP(r).reduce((s,l)=>s.then(c=>kP(c,l,e,n)),Promise.resolve(r))}async function Lo(t,e,n){var r;const a=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(a){const s=await H2(a,null,n);return e.style.setProperty(t,s,e.style.getPropertyPriority(t)),!0}return!1}async function RP(t,e){await Lo("background",t,e)||await Lo("background-image",t,e),await Lo("mask",t,e)||await Lo("-webkit-mask",t,e)||await Lo("mask-image",t,e)||await Lo("-webkit-mask-image",t,e)}async function MP(t,e){const n=ur(t,HTMLImageElement);if(!(n&&!Bm(t.src))&&!(ur(t,SVGImageElement)&&!Bm(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,a=await _p(r,yp(r),e);await new Promise((s,l)=>{t.onload=s,t.onerror=e.onImageErrorHandler?(...d)=>{try{s(e.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const c=t;c.decode&&(c.decode=s),c.loading==="lazy"&&(c.loading="eager"),n?(t.srcset="",t.src=a):t.href.baseVal=a})}async function DP(t,e){const r=Fi(t.childNodes).map(a=>$2(a,e));await Promise.all(r).then(()=>t)}async function $2(t,e){ur(t,Element)&&(await RP(t,e),await MP(t,e),await DP(t,e))}function IP(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),t}const Q_={};async function ew(t){let e=Q_[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},Q_[t]=e,e}async function tw(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),U2(c,e.fetchRequestInit,({result:d})=>(n=n.replace(l,`url(${d})`),[l,d]))});return Promise.all(s).then(()=>n)}function nw(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;e.push(d[0])}r=r.replace(a,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(l,"gi");for(;;){let d=s.exec(r);if(d===null){if(d=c.exec(r),d===null)break;s.lastIndex=c.lastIndex}else c.lastIndex=s.lastIndex;e.push(d[0])}return e}async function FP(t,e){const n=[],r=[];return t.forEach(a=>{if("cssRules"in a)try{Fi(a.cssRules||[]).forEach((s,l)=>{if(s.type===CSSRule.IMPORT_RULE){let c=l+1;const d=s.href,f=ew(d).then(g=>tw(g,e)).then(g=>nw(g).forEach(v=>{try{a.insertRule(v,v.startsWith("@import")?c+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:v,error:_})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(f)}})}catch(s){const l=t.find(c=>c.href==null)||document.styleSheets[0];a.href!=null&&r.push(ew(a.href).then(c=>tw(c,e)).then(c=>nw(c).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(t.forEach(a=>{if("cssRules"in a)try{Fi(a.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${a.href}`,s)}}),n))}function LP(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>V2(e.style.getPropertyValue("src")))}async function PP(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Fi(t.ownerDocument.styleSheets),r=await FP(n,e);return LP(r)}function G2(t){return t.trim().replace(/["']/g,"")}function OP(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(s=>{e.add(G2(s))}),Array.from(r.children).forEach(s=>{s instanceof HTMLElement&&n(s)})}return n(t),e}async function UP(t,e){const n=await PP(t,e),r=OP(t);return(await Promise.all(n.filter(s=>r.has(G2(s.style.fontFamily))).map(s=>{const l=s.parentStyleSheet?s.parentStyleSheet.href:null;return H2(s.cssText,l,e)}))).join(`
`)}async function BP(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await UP(t,e);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function jP(t,e={}){const{width:n,height:r}=O2(t,e),a=await Cd(t,e,!0);return await BP(a,e),await $2(a,e),IP(a,e),await rP(a,n,r)}async function VP(t,e={}){const{width:n,height:r}=O2(t,e),a=await jP(t,e),s=await nd(a),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.pixelRatio||eP(),f=e.canvasWidth||n,g=e.canvasHeight||r;return l.width=f*d,l.height=g*d,e.skipAutoScale||tP(l),l.style.width=`${f}`,l.style.height=`${g}`,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,l.width,l.height)),c.drawImage(s,0,0,l.width,l.height),l}async function HP(t,e={}){return(await VP(t,e)).toDataURL()}const xc=40,rw=64,aw=320,iw=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],$P=({data:t,onClose:e,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[s,l]=H.useState(!0),[c,d]=H.useState(new Set),[f,g]=H.useState("all"),v=H.useRef(null),[_,T]=H.useState(!1),[E,S]=H.useState("day"),[C,k]=H.useState({start:"",end:""}),b={day:40,week:15,month:5}[E],D=H.useMemo(()=>{const re=new Map;return t.filter(J=>J.type==="task").forEach((J,M)=>{re.set(J.id,iw[M%iw.length])}),re},[t]),B=H.useCallback((re,J)=>{if(re.type==="task")return re.id;let M=re;for(;M.parentId;){const Q=J.get(M.parentId);if(!Q)return null;if(Q.type==="task")return Q.id;M=Q}return null},[]),G=H.useMemo(()=>new Map(t.map(re=>[re.id,re])),[t]),F=H.useCallback(re=>{const J=B(re,G);return J&&D.get(J)||"#9CA3AF"},[G,D,B]);H.useEffect(()=>{const re=new Set(t.filter(J=>J.type==="task").map(J=>J.id));d(re)},[t]);const W=re=>{d(J=>{const M=new Set(J);return M.has(re)?M.delete(re):M.add(re),M})},U=H.useMemo(()=>{const re=[];return t.filter(M=>M.type==="task").forEach(M=>{re.push(M),c.has(M.id)&&t.filter(I=>I.type==="substep"&&I.parentId===M.id).forEach(I=>{if(re.push(I),c.has(I.id)){const X=t.filter(K=>{if(K.type!=="actionitem"||K.parentId!==I.id)return!1;if(f==="all")return!0;const P=K.progress===100;return f==="completed"?P:f==="pending"?!P:!0});re.push(...X)}})}),re},[t,c,f]),{timelineStart:ae,totalDays:z}=H.useMemo(()=>{if(t.length===0)return{timelineStart:new Date,totalDays:30};const re=t.map(P=>new Date(P.start)).filter(P=>!isNaN(P.getTime())),J=t.map(P=>new Date(P.end)).filter(P=>!isNaN(P.getTime()));let M,Q;re.length===0||J.length===0?(M=new Date,Q=new Date,Q.setMonth(Q.getMonth()+1)):(M=new Date(Math.min(...re.map(P=>P.getTime()))),Q=new Date(Math.max(...J.map(P=>P.getTime()))));let I=C.start?new Date(C.start):M,X=C.end?new Date(C.end):Q;isNaN(I.getTime())&&(I=M),isNaN(X.getTime())&&(X=Q),X<I&&(X=I),I.setDate(I.getDate()-2),X.setDate(X.getDate()+5);const K=(X.getTime()-I.getTime())/(1e3*3600*24);return{timelineStart:I,totalDays:Math.ceil(K)}},[t,C]),ee=H.useMemo(()=>{const re=Q=>{Q=new Date(Date.UTC(Q.getFullYear(),Q.getMonth(),Q.getDate())),Q.setUTCDate(Q.getUTCDate()+4-(Q.getUTCDay()||7));const I=new Date(Date.UTC(Q.getUTCFullYear(),0,1));return Math.ceil(((Q.getTime()-I.getTime())/864e5+1)/7)},J=[];let M=new Date(ae);if(E==="day")for(let Q=0;Q<z;Q++)J.push({secondaryLabel:M.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(M.getDate()),width:b}),M.setDate(M.getDate()+1);else if(E==="week")for(let Q=0;Q<z;Q++)(M.getDay()===1||J.length===0)&&J.push({label:`W${re(M)}`,secondaryLabel:M.toLocaleDateString("ja-JP",{month:"short"}),width:0}),J[J.length-1].width+=b,M.setDate(M.getDate()+1);else if(E==="month"){let Q=-1;for(let I=0;I<z;I++){const X=M.getMonth();X!==Q&&(Q=X,J.push({label:M.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),J[J.length-1].width+=b,M.setDate(M.getDate()+1)}}return J},[ae,z,E,b]),Ee=re=>{const J=new Date(re);return isNaN(J.getTime())?-1:(J.getTime()-ae.getTime())/(1e3*3600*24)},Ae=re=>{switch(re){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},we=re=>t.some(J=>J.parentId===re),ie=H.useCallback(()=>{if(v.current===null){alert("");return}T(!0),HP(v.current,{cacheBust:!0,backgroundColor:"#ffffff",width:v.current.scrollWidth,height:v.current.scrollHeight}).then(re=>{const J=document.createElement("a");J.download="gantt-chart.png",J.href=re,J.click()}).catch(re=>{console.error("",re),alert("")}).finally(()=>{T(!1)})},[]),de=H.useMemo(()=>ee.reduce((re,J)=>re+J.width,0),[ee]);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[x.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),x.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(re=>x.jsx("button",{onClick:()=>S(re),className:`px-3 py-1 text-xs capitalize rounded-md ${E===re?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:re},re))})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),x.jsx("input",{type:"date",value:C.start,onChange:re=>k(J=>({...J,start:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("span",{children:"-"}),x.jsx("input",{type:"date",value:C.end,onChange:re=>k(J=>({...J,end:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("button",{onClick:()=>k({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),x.jsxs("button",{onClick:ie,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(el,{className:"w-4 h-4"}),"PNG"]}),x.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[x.jsx(fr,{className:"w-5 h-5"}),""]})]})]}),x.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${f==="all"?"bg-white shadow-sm":""}`,children:""}),x.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${f==="pending"?"bg-white shadow-sm":""}`,children:""}),x.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${f==="completed"?"bg-white shadow-sm":""}`,children:""})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Sd,{className:"w-4 h-4"}),"AI"]}),x.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:s,onChange:()=>l(re=>!re),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),x.jsx("div",{className:"flex-grow overflow-auto relative",children:x.jsxs("div",{ref:v,className:"grid",style:{gridTemplateColumns:`${aw}px 1fr`,width:`${aw+de}px`},children:[x.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:rw},children:" / "}),x.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:rw},children:x.jsx("div",{className:"flex h-full",children:ee.map((re,J)=>x.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:re.width},children:[re.secondaryLabel&&x.jsx("span",{className:"font-semibold text-slate-600",children:re.secondaryLabel}),x.jsx("div",{className:`font-bold text-slate-800 ${E==="day"?"text-lg":"text-sm"}`,children:re.label})]},J))})}),x.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${U.length}`},children:ee.map((re,J)=>x.jsx("div",{className:"h-full border-r border-slate-200",style:{width:re.width}},J))}),U.map((re,J)=>{const M=F(re),Q=(()=>{const me=U[J+1];return me?B(re,G)!==B(me,G):!0})(),I=Ee(re.start),X=Math.max(.2,Ee(re.end)-I+1),K=I*b,P=X*b,te={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return x.jsxs(ys.Fragment,{children:[x.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:J+2,height:xc,borderBottom:Q?`2px solid ${M}`:"1px solid #e5e7eb"},children:[x.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:M}}),x.jsxs("div",{className:`flex items-center w-full ${Ae(re.type)}`,children:[(re.type==="task"||re.type==="substep")&&(we(re.id)?x.jsx(kL,{onClick:()=>W(re.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${c.has(re.id)?"rotate-0":"-rotate-90"}`}):x.jsx("div",{className:"w-4 h-4 mr-1"})),re.type==="actionitem"&&(re.progress===100?x.jsx(gp,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):x.jsx(xp,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),x.jsx("span",{onClick:()=>n==null?void 0:n(re),className:`truncate text-xs ${re.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:re.name,children:re.name})]})]}),x.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:J+2,borderBottom:Q?`2px solid ${M}`:"1px solid #e5e7eb"},children:I>=0&&x.jsx("div",{title:`${re.name} (${re.progress}%)`,onClick:()=>n==null?void 0:n(re),className:"absolute h-full flex items-center group",style:{left:K,width:P,cursor:n?"pointer":"default"},children:x.jsx("div",{className:"w-full rounded",style:{...te[re.type],backgroundColor:M},children:x.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${re.progress}%`}})})})})]},re.id)}),x.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${U.length}`,position:"relative",pointerEvents:"none"},children:s&&x.jsx(GP,{items:U,getDaysFromStart:Ee,dayWidth:b})})]})})]})})},GP=({items:t,getDaysFromStart:e,dayWidth:n})=>{const r=H.useMemo(()=>{const a=[],s=new Map(t.map((l,c)=>[l.id,c]));return t.forEach((l,c)=>{(l.dependencies||[]).forEach(d=>{const f=s.get(d),g=f!==void 0?t[f]:void 0;if(g&&f!==void 0){const v=e(g.end),_=e(l.start);if(v<0||_<0)return;const T=(v+1)*n,E=f*xc+xc/2,S=_*n,C=c*xc+xc/2,k=T+20,A=S-20,b=`M ${T} ${E} C ${k} ${E}, ${A} ${C}, ${S} ${C}`;a.push({key:`${d}-${l.id}`,d:b})}})}),a},[t,e,n]);return x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[x.jsx("defs",{children:x.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:x.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>x.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},zP=({tasks:t,projectGoal:e,targetDate:n,ganttData:r,projectReportDeck:a,onClose:s,onReportGenerated:l,generateUniqueId:c})=>{const[d,f]=H.useState("list"),[g,v]=H.useState(new Set),[_,T]=H.useState(""),[E,S]=H.useState(!1),[C,k]=H.useState(null),[A,b]=H.useState({key:"taskName",direction:"ascending"}),[D,B]=H.useState("slides"),[G,F]=H.useState(null),W=H.useMemo(()=>{const M=[];return r&&M.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:r}}),a&&M.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:a}}),t.forEach(Q=>{var I,X,K,P,te;(I=Q.extendedDetails)!=null&&I.reportDeck&&M.push({id:`task-report-${Q.id}`,name:`: ${Q.title}`,type:"Task Report",taskName:Q.title,subStepName:"",actionItemName:"",source:{name:`: ${Q.title}`,type:"json",content:Q.extendedDetails.reportDeck}}),(K=(X=Q.extendedDetails)==null?void 0:X.attachments)==null||K.forEach(me=>{M.push({id:me.id,name:me.name,type:"Attachment",taskName:Q.title,subStepName:"",actionItemName:"",source:{name:me.name,type:me.type.startsWith("image/")?"image":"text",content:me.dataUrl,dataUrl:me.dataUrl}})}),(te=(P=Q.extendedDetails)==null?void 0:P.subSteps)==null||te.forEach(me=>{var ve,ye;(ve=me.attachments)==null||ve.forEach(_e=>{M.push({id:_e.id,name:_e.name,type:"Attachment",taskName:Q.title,subStepName:me.text,actionItemName:"",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl,dataUrl:_e.dataUrl}})}),(ye=me.actionItems)==null||ye.forEach(_e=>{var $e,Z,ct;(Z=($e=_e.report)==null?void 0:$e.attachments)==null||Z.forEach(qe=>{M.push({id:qe.id,name:qe.name,type:"Attachment",taskName:Q.title,subStepName:me.text,actionItemName:_e.text,source:{name:qe.name,type:qe.type.startsWith("image/")?"image":"text",content:qe.dataUrl,dataUrl:qe.dataUrl}})}),(ct=_e.report)!=null&&ct.matrixData&&M.push({id:`matrix-${_e.id}`,name:`: ${_e.text}`,type:"Data Matrix",taskName:Q.title,subStepName:me.text,actionItemName:_e.text,source:{name:`: ${_e.text}`,type:"json",content:_e.report.matrixData}})})})}),M},[t,r,a]),U=H.useMemo(()=>{let M=[...W];return A!==null&&M.sort((Q,I)=>{const X=(Q[A.key]||"").toLowerCase(),K=(I[A.key]||"").toLowerCase();return X<K?A.direction==="ascending"?-1:1:X>K?A.direction==="ascending"?1:-1:0}),M},[W,A]),ae=M=>{let Q="ascending";A&&A.key===M&&A.direction==="ascending"&&(Q="descending"),b({key:M,direction:Q})},z=M=>!A||A.key!==M?x.jsx(bs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):A.direction==="ascending"?x.jsx(Vc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(bs,{className:"w-3 h-3 ml-1 text-blue-600"}),ee=M=>{v(Q=>{const I=new Set(Q);return I.has(M)?I.delete(M):I.add(M),I})},Ee=()=>{g.size===W.length?v(new Set):v(new Set(W.map(M=>M.id)))},Ae=async()=>{if(g.size===0){k("1");return}if(!_.trim()){k("");return}S(!0),k(null),F(null);const M=W.filter(Q=>g.has(Q.id)).map(Q=>Q.source);try{if(D==="slides"){const Q=await A2(M,_);l(Q)}else{const Q=await vL(M,_);F(Q)}}catch(Q){k(Q instanceof Error?Q.message:"")}finally{S(!1)}},we=M=>{switch(M){case"Gantt Chart":return x.jsx(L2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return x.jsx(I2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return x.jsx(jc,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(vp,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Cs,{className:"w-5 h-5 text-slate-500"})}},ie=M=>{if(M.dataUrl)return M.dataUrl;if(M.type==="json")try{const Q=JSON.stringify(M.content,null,2),I=new Blob([Q],{type:"application/json"});return URL.createObjectURL(I)}catch{return}},de=H.useMemo(()=>W.filter(M=>g.has(M.id)),[g,W]),re=()=>x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:x.jsx("input",{type:"checkbox",checked:g.size===W.length&&W.length>0,onChange:Ee,className:"w-4 h-4 accent-blue-600"})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),z("name")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-40",children:x.jsxs("button",{onClick:()=>ae("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),z("type")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),z("taskName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),z("subStepName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),z("actionItemName")]})})]})}),x.jsx("tbody",{children:U.map(M=>{const Q=ie(M.source);return x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:x.jsx("input",{type:"checkbox",checked:g.has(M.id),onChange:()=>ee(M.id),className:"w-4 h-4 accent-blue-600"})}),x.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:Q?x.jsx("a",{href:Q,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:M.name}):x.jsx("span",{children:M.name})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:x.jsxs("div",{className:"flex items-center gap-2",children:[we(M.type),x.jsx("span",{children:M.type})]})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:M.taskName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:M.subStepName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:M.actionItemName})]},M.id)})})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",W.length," "]}),x.jsx("button",{onClick:()=>f("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),J=()=>x.jsxs(x.Fragment,{children:[x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",de.length,")"]}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:de.map(M=>x.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[we(M.type),x.jsx("span",{className:"truncate",title:M.name,children:M.name})]},M.id))}),x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:D==="slides",onChange:()=>B("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:D==="text",onChange:()=>B("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),x.jsx("textarea",{value:_,onChange:M=>T(M.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),C&&x.jsx("div",{className:"mt-2",children:x.jsx(Fs,{message:C})}),G&&x.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[x.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),x.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:G}),x.jsx("button",{onClick:()=>navigator.clipboard.writeText(G),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("button",{onClick:()=>{f("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[x.jsx(k2,{className:"w-4 h-4"}),""]}),x.jsxs("button",{onClick:Ae,disabled:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[E?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Oi,{className:"w-5 h-5"}),x.jsx("span",{children:E?"...":""})]})]})]});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[x.jsx(Cs,{className:"w-7 h-7 text-blue-600"}),x.jsx("span",{children:""})]}),x.jsx("button",{onClick:s,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),d==="list"?re():J()]})})},qP=({tasks:t,projectGoal:e,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:s,onUpdateTaskStatus:l,onStartNewProject:c,onExportProject:d,onAddTask:f,onRemoveTask:g,onImportSingleTask:v,onAutoLayout:_,onUndo:T,canUndo:E,onRedo:S,canRedo:C,generateUniqueId:k,onUpdateTaskConnections:A,ganttData:b,setGanttData:D,onCustomReportGenerated:B,onClearApiKey:G,onOpenProjectList:F,onLogout:W,currentProjectId:U,onSaveProject:ae,projectMembers:z=[],userRole:ee="viewer",onMembersUpdate:Ee=()=>{}})=>{H.useRef(null);const Ae=H.useRef(null),[we,ie]=H.useState(new Map),[de,re]=H.useState([]),J=H.useRef(null),M=H.useRef({x:0,y:0}),[Q,I]=H.useState(!1),[X,K]=H.useState(!1),[P,te]=H.useState(null),[me,ve]=H.useState(!1),[ye,_e]=H.useState(null),[$e,Z]=H.useState(!1),[ct,qe]=H.useState(null),[dt,tt]=H.useState(!1),[Me,Ft]=H.useState(null),[pn,sn]=H.useState(!1),[en,rr]=H.useState(!1),[Pn,Jt]=H.useState(null),[Jn,gn]=H.useState(!1),[qt,At]=H.useState(!1),[Nt,Qe]=H.useState(!1),[wt,tn]=H.useState(null),[Ne,Ge]=H.useState({x:0,y:0}),[Ve,ze]=H.useState(!1);H.useEffect(()=>{const R=new Map;t.forEach(j=>{R.set(j.id,we.get(j.id)||H.createRef())}),ie(R)},[t]);const nt=H.useCallback(()=>{if(!Ae.current||we.size===0){re([]);return}const R=[];t.forEach(j=>{var O,V;if(j.nextTaskIds&&j.nextTaskIds.length>0){const q=we.get(j.id),Y=q==null?void 0:q.current;if(!Y)return;const ue=((O=j.position)==null?void 0:O.x)||0,Te=((V=j.position)==null?void 0:V.y)||0,le=Y.getBoundingClientRect(),he={x:ue+le.width,y:Te+le.height/2};j.nextTaskIds.forEach(pe=>{var Ct,Rt;const ke=t.find($r=>$r.id===pe);if(!ke)return;const De=we.get(pe),Le=De==null?void 0:De.current;if(!Le)return;const Re=((Ct=ke.position)==null?void 0:Ct.x)||0,Fe=((Rt=ke.position)==null?void 0:Rt.y)||0,Xe=Le.getBoundingClientRect(),kt={x:Re,y:Fe+Xe.height/2};R.push({id:`conn-${j.id}-${pe}`,from:he,to:kt,sourceId:j.id,targetId:pe})})}}),re(R)},[t,we]);H.useEffect(()=>{const R=setTimeout(nt,50);return()=>clearTimeout(R)},[nt,t]),H.useEffect(()=>{window.addEventListener("resize",nt);const R=new MutationObserver(nt);return Ae.current&&R.observe(Ae.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",nt),R.disconnect()}},[nt]);const dr=(R,j)=>{var V,q;J.current=j;const O=t.find(Y=>Y.id===j);if(Ae.current){const Y=Ae.current.getBoundingClientRect();M.current.x=R.clientX-Y.left-(((V=O==null?void 0:O.position)==null?void 0:V.x)||0),M.current.y=R.clientY-Y.top-(((q=O==null?void 0:O.position)==null?void 0:q.y)||0)}R.dataTransfer.effectAllowed="move"},sa=R=>{R.preventDefault(),R.dataTransfer.dropEffect="move"},Hi=R=>{var he;if(R.preventDefault(),!J.current||!Ae.current)return;const j=Ae.current.getBoundingClientRect(),O=(he=we.get(J.current))==null?void 0:he.current,V=(O==null?void 0:O.offsetWidth)||380,q=(O==null?void 0:O.offsetHeight)||280;let Y=R.clientX-j.left-M.current.x,ue=R.clientY-j.top-M.current.y;const Te=Ae.current.scrollWidth,le=Ae.current.scrollHeight;Y=Math.max(0,Math.min(Y,Te-V)),ue=Math.max(0,Math.min(ue,le-q)),s(J.current,{x:Y,y:ue}),J.current=null,setTimeout(nt,0)},$i=async()=>{ve(!0),_e(null);try{const R=await mL(t,e,n);te(R),K(!0)}catch(R){_e(R instanceof Error?R.message:"")}finally{ve(!1)}},Aa=async()=>{if(ct){Z(!0);return}tt(!0),Ft(null);try{const R=await pL(t,e,n);qe(R),Z(!0)}catch(R){Ft(R instanceof Error?R.message:"")}finally{tt(!1)}},ti=async()=>{if(b){sn(!0);return}rr(!0),Jt(null);try{const R=await Y_(t,e,n);D(R),sn(!0)}catch(R){Jt(R instanceof Error?R.message:"")}finally{rr(!1)}},Vs=async()=>{rr(!0),Jt(null);try{const R=await Y_(t,e,n);D(R)}catch(R){Jt(R instanceof Error?R.message:"")}finally{rr(!1)}},Hs=async()=>{if(U){ze(!0);try{await ae(),alert("")}catch(R){alert(": "+(R instanceof Error?R.message:""))}finally{ze(!1)}}else{const R=prompt(":",`${e.substring(0,50)}...`);if(!R)return;ze(!0);try{const j=await Vn.createProject(R,e,n,t,b);alert(""),Ee()}catch(j){alert(": "+(j instanceof Error?j.message:""))}finally{ze(!1)}}},Gi=(R,j)=>{if(!Ae.current)return;const O=Ae.current.getBoundingClientRect(),V={x:j.clientX-O.left+Ae.current.scrollLeft,y:j.clientY-O.top+Ae.current.scrollTop};tn({fromId:R,fromPos:V})},zi=R=>{if(!wt||wt.fromId===R){tn(null);return}const j=t.find(O=>O.id===wt.fromId);if(j){const O=Array.from(new Set([...j.nextTaskIds||[],R]));A(j.id,O)}tn(null)},$s=(R,j)=>{const O=t.find(V=>V.id===R);if(O){const V=(O.nextTaskIds||[]).filter(q=>q!==j);A(O.id,V)}},hl=R=>{if(!wt||!Ae.current)return;const j=Ae.current.getBoundingClientRect();Ge({x:R.clientX-j.left+Ae.current.scrollLeft,y:R.clientY-j.top+Ae.current.scrollTop})},Cr=()=>{wt&&tn(null)},on=R=>{const j=R.type==="task"?R.id:R.parentId;if(!j)return;const O=t.find(V=>V.id===j);O&&(sn(!1),r(O))},ln=R=>{B(R),At(!1)},oa=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"",hr=ee==="owner"||ee==="editor",ml=ee==="owner"||ee==="editor";return $e&&ct?x.jsx(WL,{tasks:t,initialDeck:ct,onSave:R=>qe(R),onClose:()=>Z(!1),projectGoal:e,targetDate:n,reportScope:"project",generateUniqueId:k}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[x.jsxs("div",{className:"max-w-full mx-auto w-full",children:[x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[x.jsxs("button",{onClick:()=>gn(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[x.jsx(Ss,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[rt&&x.jsx("button",{onClick:F,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"",children:x.jsx(Cs,{className:"w-5 h-5"})}),rt&&x.jsx("button",{onClick:Hs,disabled:Ve,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"",children:Ve?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(el,{className:"w-5 h-5"})}),x.jsx("button",{onClick:T,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:x.jsx(NL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:S,disabled:!C,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:x.jsx(RL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:G,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:x.jsx(Hc,{className:"w-5 h-5 text-yellow-600"})}),x.jsx("button",{onClick:W,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"",children:x.jsx(Hc,{className:"w-5 h-5"})}),x.jsxs("button",{onClick:f,disabled:!hr,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",title:hr?"":"",children:[x.jsx(R2,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(el,{className:"w-5 h-5 mr-2"}),"JSON"]}),x.jsxs("button",{onClick:_,disabled:!hr,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",title:hr?"":"",children:[x.jsx(Sd,{className:"w-5 h-5 mr-2"}),""]})]})]}),x.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),x.jsxs("div",{className:"space-y-2 text-slate-700",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(pp,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),x.jsx("strong",{children:":"}),"",x.jsx("span",{className:"break-all",children:e})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Td,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),x.jsx("strong",{children:":"}),"",oa]}),U&&x.jsx("p",{className:"text-sm text-green-600",children:" Supabase"}),z.length>1&&x.jsxs("div",{className:"flex items-center text-sm text-slate-600 mt-2",children:[x.jsx(ed,{className:"w-4 h-4 mr-1"}),x.jsxs("span",{children:[z.length,""]}),x.jsx("span",{className:"mx-2",children:""}),x.jsxs("span",{children:[": ",ee==="owner"?"":ee==="editor"?"":""]})]})]})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[rt&&ml&&U&&x.jsxs("button",{onClick:()=>Qe(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(ed,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:()=>I(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(F2,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:()=>At(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(Cs,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:ti,disabled:en,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[en?x.jsx(_n,{size:"sm"}):x.jsx(L2,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:$i,disabled:me,title:hr?"":"",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[me?x.jsx(_n,{size:"sm"}):x.jsx(Oi,{className:"w-5 h-5 mr-2"}),"AI"]}),x.jsxs("button",{onClick:Aa,disabled:dt,title:hr?"":"",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[dt?x.jsx(_n,{size:"sm"}):x.jsx(I2,{className:"w-5 h-5 mr-2"}),""]})]})]}),ye&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:ye})}),Me&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Me})}),Pn&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Pn})})]})]}),x.jsxs("div",{ref:Ae,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:sa,onDrop:Hi,onMouseMove:hl,onMouseUp:Cr,children:[x.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[t.map((R,j)=>x.jsx(UL,{cardRef:we.get(R.id),task:R,onSelectTask:r,onRemoveTask:g,onUpdateStatus:l,onDragCardStart:dr,onStartConnection:Gi,onEndConnection:zi,index:j,canEdit:hr},R.id)),de.map(R=>x.jsx(Um,{from:R.from,to:R.to,id:R.id,onDelete:()=>$s(R.sourceId,R.targetId)},R.id)),wt&&x.jsx(Um,{from:wt.fromPos,to:Ne,id:"preview-connector"})]}),t.length===0&&x.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:x.jsx("p",{className:"text-slate-500 text-lg",children:""})})]})]}),pn&&b&&x.jsx($P,{data:b,onClose:()=>sn(!1),onItemClick:on,onRegenerate:Vs,isRegenerating:en}),qt&&x.jsx(zP,{tasks:t,projectGoal:e,targetDate:n,ganttData:b,projectReportDeck:ct,onClose:()=>At(!1),onReportGenerated:ln,generateUniqueId:k}),Q&&x.jsx(BL,{tasks:t,onClose:()=>I(!1)}),X&&x.jsx(jL,{report:P,onClose:()=>K(!1)}),Jn&&x.jsx(JL,{onClose:()=>gn(!1),onDownloadAndStartNew:()=>{d(),c()},onStartNewWithoutSaving:c}),Nt&&U&&x.jsx(VL,{isOpen:Nt,onClose:()=>Qe(!1),projectId:U,projectTitle:e,members:z,userRole:ee,onMembersUpdate:Ee})]})},YP=({proposals:t,existingSubSteps:e,onConfirm:n,onClose:r})=>{const[a,s]=H.useState(()=>{const d={};return t.forEach((f,g)=>{d[g]={decision:"NEW",targetSubStepId:void 0}}),d}),l=(d,f,g)=>{s(v=>({...v,[d]:{...v[d],[f]:g}}))},c=()=>{const d=[],f=[];Object.entries(a).forEach(([g,v])=>{const _=parseInt(g,10),T=t[_];v.decision==="NEW"?d.push(T):v.decision==="ADD"&&v.targetSubStepId&&f.push({targetSubStepId:v.targetSubStepId,title:T.title})}),n({newSubSteps:d,newActionItems:f})};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),x.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[x.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),x.jsx("div",{className:"space-y-3",children:t.map((d,f)=>x.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[x.jsx("p",{className:"font-semibold text-slate-800",children:d.title}),x.jsx("p",{className:"text-sm text-slate-600 mb-3",children:d.description}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("select",{value:a[f].decision,onChange:g=>l(f,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"NEW",children:""}),e.length>0&&x.jsx("option",{value:"ADD",children:""}),x.jsx("option",{value:"IGNORE",children:""})]}),a[f].decision==="ADD"&&x.jsxs("select",{value:a[f].targetSubStepId||"",onChange:g=>l(f,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"",disabled:!0,children:"..."}),e.map(g=>x.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},f))})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z2=1252,WP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Tp=function(t){WP.indexOf(t)!=-1&&(z2=wp[0]=t)};function JP(){Tp(1252)}var ta=function(t){Tp(t)};function q2(){ta(1200),JP()}function sw(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function KP(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function Y2(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var vc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?KP(t.slice(2)):e==254&&n==255?Y2(t.slice(2)):e==65279?t.slice(1):t},Nf=function(e){return String.fromCharCode(e)},ow=function(e){return String.fromCharCode(e)},$c,Mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lw(t){for(var e="",n=0,r=0,a=0,s=0,l=0,c=0,d=0,f=0;f<t.length;)n=t.charCodeAt(f++),s=n>>2,r=t.charCodeAt(f++),l=(n&3)<<4|r>>4,a=t.charCodeAt(f++),c=(r&15)<<2|a>>6,d=a&63,isNaN(r)?c=d=64:isNaN(a)&&(d=64),e+=Mi.charAt(s)+Mi.charAt(l)+Mi.charAt(c)+Mi.charAt(d);return e}function Sr(t){var e="",n=0,r=0,a=0,s=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)s=Mi.indexOf(t.charAt(f++)),l=Mi.indexOf(t.charAt(f++)),n=s<<2|l>>4,e+=String.fromCharCode(n),c=Mi.indexOf(t.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),d=Mi.indexOf(t.charAt(f++)),a=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ls=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ui(t){return gt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function cw(t){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ea=function(e){return gt?Ls(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function Ps(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function Ep(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ep(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var Ri=gt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ls(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function XP(t){for(var e=[],n=0,r=t.length+250,a=Ui(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++s)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=Ui(65535),r=65530)}return e.push(a.slice(0,n)),Ri(e)}var er=/\u0000/g,yc=/[\u0001-\u0006]/g;function Go(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function na(t,e){var n=""+t;return n.length>=e?n:Zt("0",e-n.length)+n}function Sp(t,e){var n=""+t;return n.length>=e?n:Zt(" ",e-n.length)+n}function rd(t,e){var n=""+t;return n.length>=e?n:n+Zt(" ",e-n.length)}function ZP(t,e){var n=""+Math.round(t);return n.length>=e?n:Zt("0",e-n.length)+n}function QP(t,e){var n=""+t;return n.length>=e?n:Zt("0",e-n.length)+n}var uw=Math.pow(2,32);function Po(t,e){if(t>uw||t<-uw)return ZP(t,e);var n=Math.round(t);return QP(n,e)}function ad(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var fw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},dw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function id(t,e,n){for(var r=t<0?-1:1,a=t*r,s=0,l=1,c=0,d=1,f=0,g=0,v=Math.floor(a);f<e&&(v=Math.floor(a),c=v*l+s,g=v*f+d,!(a-v<5e-8));)a=1/(a-v),s=l,l=c,d=f,f=g;if(g>e&&(f>e?(g=d,c=s):(g=f,c=l)),!n)return[0,r*c,g];var _=Math.floor(r*c/g);return[_,r*c-_*g,g]}function ps(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),s=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],s=d.getDay(),r<60&&(s=(s+6)%7),n&&(s=oO(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var W2=new Date(1899,11,31,0,0,0),nO=W2.getTime(),rO=new Date(1900,2,1,0,0,0);function J2(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=rO&&(n+=24*60*60*1e3),(n-(nO+(t.getTimezoneOffset()-W2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function aO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iO(t){var e=t<0?12:11,n=Cp(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function sO(t){var e=Cp(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Gc(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=iO(t):e===10?n=t.toFixed(10).substr(0,12):n=sO(t),Cp(aO(n.toUpperCase()))}function As(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Gc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return jr(14,J2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function oO(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function lO(t,e,n,r){var a="",s=0,l=0,c=n.y,d,f=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,f=e.length;break;case 3:return Xh[n.m-1][1];case 5:return Xh[n.m-1][0];default:return Xh[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,f=e.length;break;case 3:return fw[n.q][0];default:return fw[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?na(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,s=Math.round(l*(n.S+n.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(a=na(s,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var g=f>0?na(d,f):"";return g}function Di(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var K2=/%/g;function cO(t,e,n){var r=e.replace(K2,""),a=e.length-r.length;return qa(t,r,n*Math.pow(10,2*a))+Zt("%",a)}function uO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return qa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function X2(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+X2(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),n=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+s):n+="E+"+(l-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Z2=/# (\?+)( ?)\/( ?)(\d+)/;function fO(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),s=Math.floor(a/r),l=a-s*r,c=r;return n+(s===0?"":""+s)+" "+(l===0?Zt(" ",t[1].length+1+t[4].length):Sp(l,t[1].length)+t[2]+"/"+t[3]+na(c,t[4].length))}function dO(t,e,n){return n+(e===0?"":""+e)+Zt(" ",t[1].length+2+t[4].length)}var Q2=/^#*0*\.([0#]+)/,eE=/\).*[0#]/,tE=/\(###\) ###\\?-####/;function Xn(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function hw(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function mw(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function hO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function mO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Or(t,e,n){if(t.charCodeAt(0)===40&&!e.match(eE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Or("n",r,n):"("+Or("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return uO(t,e,n);if(e.indexOf("%")!==-1)return cO(t,e,n);if(e.indexOf("E")!==-1)return X2(e,n);if(e.charCodeAt(0)===36)return"$"+Or(t,e.substr(e.charAt(1)==" "?2:1),n);var a,s,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+Po(d,e.length);if(e.match(/^[#?]+$/))return a=Po(n,0),a==="0"&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(s=e.match(Z2))return fO(s,d,f);if(e.match(/^#+0+$/))return f+Po(d,e.length-e.indexOf("0"));if(s=e.match(Q2))return a=hw(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Xn(s[1])).replace(/\.$/,"."+Xn(s[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+Zt("0",Xn(s[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+hw(d,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+Di(Po(d,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Or(t,e,-n):Di(""+(Math.floor(n)+hO(n,s[1].length)))+"."+na(mw(n,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Or(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Go(Or(t,e.replace(/[\\-]/g,""),n)),l=0,Go(Go(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(tE))return a=Or(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=id(d,Math.pow(10,l)-1,!1),a=""+f,g=qa("n",s[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=rd(c[2],l),g.length<s[4].length&&(g=Xn(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=id(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sp(c[1],l)+s[2]+"/"+s[3]+rd(c[2],l):Zt(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=Po(n,0),e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Xn(e.substr(0,v)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=mw(n,s[1].length),n<0?"-"+Or(t,e,-n):Di(mO(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?na(0,3-E.length):"")+E})+"."+na(l,s[1].length);switch(e){case"###,##0.00":return Or(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var T=Di(Po(d,0));return T!=="0"?f+T:"";case"###,###.00":return Or(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Or(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function pO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return qa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function gO(t,e,n){var r=e.replace(K2,""),a=e.length-r.length;return qa(t,r,n*Math.pow(10,2*a))+Zt("%",a)}function nE(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+nE(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),n=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+s):n+="E+"+(l-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function pa(t,e,n){if(t.charCodeAt(0)===40&&!e.match(eE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?pa("n",r,n):"("+pa("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return pO(t,e,n);if(e.indexOf("%")!==-1)return gO(t,e,n);if(e.indexOf("E")!==-1)return nE(e,n);if(e.charCodeAt(0)===36)return"$"+pa(t,e.substr(e.charAt(1)==" "?2:1),n);var a,s,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+na(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(s=e.match(Z2))return dO(s,d,f);if(e.match(/^#+0+$/))return f+na(d,e.length-e.indexOf("0"));if(s=e.match(Q2))return a=(""+n).replace(/^([^\.]+)$/,"$1."+Xn(s[1])).replace(/\.$/,"."+Xn(s[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+Zt("0",Xn(s[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+Di(""+d);if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+pa(t,e,-n):Di(""+n)+"."+Zt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return pa(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Go(pa(t,e.replace(/[\\-]/g,""),n)),l=0,Go(Go(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(tE))return a=pa(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=id(d,Math.pow(10,l)-1,!1),a=""+f,g=qa("n",s[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=rd(c[2],l),g.length<s[4].length&&(g=Xn(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=id(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sp(c[1],l)+s[2]+"/"+s[3]+rd(c[2],l):Zt(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Xn(e.substr(0,v)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+pa(t,e,-n):Di(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?na(0,3-E.length):"")+E})+"."+na(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Di(""+d);return T!=="0"?f+T:"";default:if(e.match(/\.[0#?]*$/))return pa(t,e.slice(0,e.lastIndexOf(".")),n)+Xn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function qa(t,e,n){return(n|0)===n?pa(t,e,n):Or(t,e,n)}function xO(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var rE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ul(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":ad(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(rE))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function vO(t,e,n,r){for(var a=[],s="",l=0,c="",d="t",f,g,v,_="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!ad(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(v=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(v);a[a.length]={t:"t",v:s},++l;break;case"\\":var T=t.charAt(++l),E=T==="("||T===")"?T:"t";a[a.length]={t:E,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=ps(e,n,t.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=ps(e,n),f==null))return"";for(s=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=_),a[a.length]={t:c,v:s},d=c;break;case"A":case"a":case"":var S={t:c,v:c};if(f==null&&(f=ps(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(f!=null&&(S.v=f.H>=12?"":""),S.t="T",l+=5,_="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=c;break;case"[":for(s=c;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(rE)){if(f==null&&(f=ps(e,n),f==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},d=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ul(t)||(a[a.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=c;++l<t.length&&(c=t.charAt(l))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;t.charAt(++l)===c;)s+=c;a[a.length]={t:c,v:s},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var C=0,k=0,A;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,d="h",C<1&&(C=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(k=Math.max(k,A[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[l].v.match(/[Hh]/)&&(C=1),C<2&&a[l].v.match(/[Mm]/)&&(C=2),C<3&&a[l].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var b="",D;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=lO(a[l].t.charCodeAt(0),a[l].v,f,k),a[l].t="t";break;case"n":case"?":for(D=l+1;a[D]!=null&&((c=a[D].t)==="?"||c==="D"||(c===" "||c==="t")&&a[D+1]!=null&&(a[D+1].t==="?"||a[D+1].t==="t"&&a[D+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[D].v==="/"||a[D].v===" "&&a[D+1]!=null&&a[D+1].t=="?"));)a[l].v+=a[D].v,a[D]={v:"",t:";"},++D;b+=a[l].v,l=D-1;break;case"G":a[l].t="t",a[l].v=As(e,n);break}var B="",G,F;if(b.length>0){b.charCodeAt(0)==40?(G=e<0&&b.charCodeAt(0)===45?-e:e,F=qa("n",b,G)):(G=e<0&&r>1?-e:e,F=qa("n",b,G),G<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),D=F.length-1;var W=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){W=l;break}var U=a.length;if(W===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(D>=a[l].v.length-1?(D-=a[l].v.length,a[l].v=F.substr(D+1,a[l].v.length)):D<0?a[l].v="":(a[l].v=F.substr(0,D+1),D=-1),a[l].t="t",U=l);D>=0&&U<a.length&&(a[U].v=F.substr(0,D+1)+a[U].v)}else if(W!==a.length&&F.indexOf("E")===-1){for(D=F.indexOf(".")-1,l=W;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===W?a[l].v.indexOf(".")-1:a[l].v.length-1,B=a[l].v.substr(g+1);g>=0;--g)D>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(B=F.charAt(D--)+B);a[l].v=B,a[l].t="t",U=l}for(D>=0&&U<a.length&&(a[U].v=F.substr(0,D+1)+a[U].v),D=F.indexOf(".")+1,l=W;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==W)){for(g=a[l].v.indexOf(".")>-1&&l===W?a[l].v.indexOf(".")+1:0,B=a[l].v.substr(0,g);g<a[l].v.length;++g)D<F.length&&(B+=F.charAt(D++));a[l].v=B,a[l].t="t",U=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(G=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=qa(a[l].t,a[l].v,G),a[l].t="t");var ae="";for(l=0;l!==a.length;++l)a[l]!=null&&(ae+=a[l].v);return ae}var pw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gw(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function yO(t,e){var n=xO(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(pw),c=n[1].match(pw);return gw(e,l)?[r,n[0]]:gw(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,s]}function jr(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:st)[t],r==null&&(r=n.table&&n.table[dw[t]]||st[dw[t]]),r==null&&(r=tO[t]||"General");break}if(ad(r,0))return As(e,n);e instanceof Date&&(e=J2(e,n.date1904));var a=yO(r,e);if(ad(a[1]))return As(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return vO(a[1],e,n,a[0])}function xs(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(st[n]==null){e<0&&(e=n);continue}if(st[n]==t){e=n;break}}e<0&&(e=391)}return st[e]=t,e}function aE(){st=eO()}var _O={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},iE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function wO(t){var e=typeof t=="number"?st[t]:t;return e=e.replace(iE,"(\\d+)"),new RegExp("^"+e+"$")}function TO(t,e,n){var r=-1,a=-1,s=-1,l=-1,c=-1,d=-1;(e.match(iE)||[]).forEach(function(v,_){var T=parseInt(n[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":r=T;break;case"d":s=T;break;case"h":l=T;break;case"s":d=T;break;case"m":l>=0?c=T:a=T;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:r==-1&&a==-1&&s==-1?g:f+"T"+g}var EO=function(){var t={};t.version="1.2.0";function e(){for(var F=0,W=new Array(256),U=0;U!=256;++U)F=U,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,W[U]=F;return typeof Int32Array<"u"?new Int32Array(W):W}var n=e();function r(F){var W=0,U=0,ae=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)z[ae]=F[ae];for(ae=0;ae!=256;++ae)for(U=F[ae],W=256+ae;W<4096;W+=256)U=z[W]=U>>>8^F[U&255];var ee=[];for(ae=1;ae!=16;++ae)ee[ae-1]=typeof Int32Array<"u"?z.subarray(ae*256,ae*256+256):z.slice(ae*256,ae*256+256);return ee}var a=r(n),s=a[0],l=a[1],c=a[2],d=a[3],f=a[4],g=a[5],v=a[6],_=a[7],T=a[8],E=a[9],S=a[10],C=a[11],k=a[12],A=a[13],b=a[14];function D(F,W){for(var U=W^-1,ae=0,z=F.length;ae<z;)U=U>>>8^n[(U^F.charCodeAt(ae++))&255];return~U}function B(F,W){for(var U=W^-1,ae=F.length-15,z=0;z<ae;)U=b[F[z++]^U&255]^A[F[z++]^U>>8&255]^k[F[z++]^U>>16&255]^C[F[z++]^U>>>24]^S[F[z++]]^E[F[z++]]^T[F[z++]]^_[F[z++]]^v[F[z++]]^g[F[z++]]^f[F[z++]]^d[F[z++]]^c[F[z++]]^l[F[z++]]^s[F[z++]]^n[F[z++]];for(ae+=15;z<ae;)U=U>>>8^n[(U^F[z++])&255];return~U}function G(F,W){for(var U=W^-1,ae=0,z=F.length,ee=0,Ee=0;ae<z;)ee=F.charCodeAt(ae++),ee<128?U=U>>>8^n[(U^ee)&255]:ee<2048?(U=U>>>8^n[(U^(192|ee>>6&31))&255],U=U>>>8^n[(U^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,Ee=F.charCodeAt(ae++)&1023,U=U>>>8^n[(U^(240|ee>>8&7))&255],U=U>>>8^n[(U^(128|ee>>2&63))&255],U=U>>>8^n[(U^(128|Ee>>6&15|(ee&3)<<4))&255],U=U>>>8^n[(U^(128|Ee&63))&255]):(U=U>>>8^n[(U^(224|ee>>12&15))&255],U=U>>>8^n[(U^(128|ee>>6&63))&255],U=U>>>8^n[(U^(128|ee&63))&255]);return~U}return t.table=n,t.bstr=D,t.buf=B,t.str=G,t}(),yt=function(){var e={};e.version="1.2.1";function n(R,j){for(var O=R.split("/"),V=j.split("/"),q=0,Y=0,ue=Math.min(O.length,V.length);q<ue;++q){if(Y=O[q].length-V[q].length)return Y;if(O[q]!=V[q])return O[q]<V[q]?-1:1}return O.length-V.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(0,j+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(j+1)}function s(R,j){typeof j=="string"&&(j=new Date(j));var O=j.getHours();O=O<<6|j.getMinutes(),O=O<<5|j.getSeconds()>>>1,R.write_shift(2,O);var V=j.getFullYear()-1980;V=V<<4|j.getMonth()+1,V=V<<5|j.getDate(),R.write_shift(2,V)}function l(R){var j=R.read_shift(2)&65535,O=R.read_shift(2)&65535,V=new Date,q=O&31;O>>>=5;var Y=O&15;O>>>=4,V.setMilliseconds(0),V.setFullYear(O+1980),V.setMonth(Y-1),V.setDate(q);var ue=j&31;j>>>=5;var Te=j&63;return j>>>=6,V.setHours(j),V.setMinutes(Te),V.setSeconds(ue<<1),V}function c(R){In(R,0);for(var j={},O=0;R.l<=R.length-4;){var V=R.read_shift(2),q=R.read_shift(2),Y=R.l+q,ue={};switch(V){case 21589:O=R.read_shift(1),O&1&&(ue.mtime=R.read_shift(4)),q>5&&(O&2&&(ue.atime=R.read_shift(4)),O&4&&(ue.ctime=R.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}R.l=Y,j[V]=ue}return j}var d;function f(){return d||(d={})}function g(R,j){if(R[0]==80&&R[1]==75)return Hi(R,j);if((R[0]|32)==109&&(R[1]|32)==105)return hl(R,j);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,V=512,q=0,Y=0,ue=0,Te=0,le=0,he=[],pe=R.slice(0,512);In(pe,0);var ke=v(pe);switch(O=ke[0],O){case 3:V=512;break;case 4:V=4096;break;case 0:if(ke[1]==0)return Hi(R,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}V!==512&&(pe=R.slice(0,V),In(pe,28));var De=R.slice(0,V);_(pe,O);var Le=pe.read_shift(4,"i");if(O===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Te=pe.read_shift(4,"i"),q=pe.read_shift(4,"i"),le=pe.read_shift(4,"i"),Y=pe.read_shift(4,"i");for(var Re=-1,Fe=0;Fe<109&&(Re=pe.read_shift(4,"i"),!(Re<0));++Fe)he[Fe]=Re;var Xe=T(R,V);C(le,Y,Xe,V,he);var kt=A(Xe,ue,he,V);kt[ue].name="!Directory",q>0&&Te!==Ee&&(kt[Te].name="!MiniFAT"),kt[he[0]].name="!FAT",kt.fat_addrs=he,kt.ssz=V;var Ct={},Rt=[],$r=[],ni=[];b(ue,kt,Xe,Rt,q,Ct,$r,Te),E($r,ni,Rt),Rt.shift();var br={FileIndex:$r,FullPaths:ni};return j&&j.raw&&(br.raw={header:De,sectors:Xe}),br}function v(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Ae,"Header Signature: "),R.l+=16;var j=R.read_shift(2,"u");return[R.read_shift(2,"u"),j]}function _(R,j){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function T(R,j){for(var O=Math.ceil(R.length/j)-1,V=[],q=1;q<O;++q)V[q-1]=R.slice(q*j,(q+1)*j);return V[O-1]=R.slice(O*j),V}function E(R,j,O){for(var V=0,q=0,Y=0,ue=0,Te=0,le=O.length,he=[],pe=[];V<le;++V)he[V]=pe[V]=V,j[V]=O[V];for(;Te<pe.length;++Te)V=pe[Te],q=R[V].L,Y=R[V].R,ue=R[V].C,he[V]===V&&(q!==-1&&he[q]!==q&&(he[V]=he[q]),Y!==-1&&he[Y]!==Y&&(he[V]=he[Y])),ue!==-1&&(he[ue]=V),q!==-1&&V!=he[V]&&(he[q]=he[V],pe.lastIndexOf(q)<Te&&pe.push(q)),Y!==-1&&V!=he[V]&&(he[Y]=he[V],pe.lastIndexOf(Y)<Te&&pe.push(Y));for(V=1;V<le;++V)he[V]===V&&(Y!==-1&&he[Y]!==Y?he[V]=he[Y]:q!==-1&&he[q]!==q&&(he[V]=he[q]));for(V=1;V<le;++V)if(R[V].type!==0){if(Te=V,Te!=he[Te])do Te=he[Te],j[V]=j[Te]+"/"+j[V];while(Te!==0&&he[Te]!==-1&&Te!=he[Te]);he[V]=-1}for(j[0]+="/",V=1;V<le;++V)R[V].type!==2&&(j[V]+="/")}function S(R,j,O){for(var V=R.start,q=R.size,Y=[],ue=V;O&&q>0&&ue>=0;)Y.push(j.slice(ue*ee,ue*ee+ee)),q-=ee,ue=hs(O,ue*4);return Y.length===0?yn(0):Ri(Y).slice(0,R.size)}function C(R,j,O,V,q){var Y=Ee;if(R===Ee){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ue=O[R],Te=(V>>>2)-1;if(!ue)return;for(var le=0;le<Te&&(Y=hs(ue,le*4))!==Ee;++le)q.push(Y);C(hs(ue,V-4),j-1,O,V,q)}}function k(R,j,O,V,q){var Y=[],ue=[];q||(q=[]);var Te=V-1,le=0,he=0;for(le=j;le>=0;){q[le]=!0,Y[Y.length]=le,ue.push(R[le]);var pe=O[Math.floor(le*4/V)];if(he=le*4&Te,V<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+V);if(!R[pe])break;le=hs(R[pe],he)}return{nodes:Y,data:bw([ue])}}function A(R,j,O,V){var q=R.length,Y=[],ue=[],Te=[],le=[],he=V-1,pe=0,ke=0,De=0,Le=0;for(pe=0;pe<q;++pe)if(Te=[],De=pe+j,De>=q&&(De-=q),!ue[De]){le=[];var Re=[];for(ke=De;ke>=0;){Re[ke]=!0,ue[ke]=!0,Te[Te.length]=ke,le.push(R[ke]);var Fe=O[Math.floor(ke*4/V)];if(Le=ke*4&he,V<4+Le)throw new Error("FAT boundary crossed: "+ke+" 4 "+V);if(!R[Fe]||(ke=hs(R[Fe],Le),Re[ke]))break}Y[De]={nodes:Te,data:bw([le])}}return Y}function b(R,j,O,V,q,Y,ue,Te){for(var le=0,he=V.length?2:0,pe=j[R].data,ke=0,De=0,Le;ke<pe.length;ke+=128){var Re=pe.slice(ke,ke+128);In(Re,64),De=Re.read_shift(2),Le=Rp(Re,0,De-he),V.push(Le);var Fe={name:Le,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},Xe=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Xe!==0&&(Fe.ct=D(Re,Re.l-8));var kt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);kt!==0&&(Fe.mt=D(Re,Re.l-8)),Fe.start=Re.read_shift(4,"i"),Fe.size=Re.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=Ee,Fe.name=""),Fe.type===5?(le=Fe.start,q>0&&le!==Ee&&(j[le].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",j[Fe.start]===void 0&&(j[Fe.start]=k(O,Fe.start,j.fat_addrs,j.ssz)),j[Fe.start].name=Fe.name,Fe.content=j[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:le!==Ee&&Fe.start!==Ee&&j[le]&&(Fe.content=S(Fe,j[le].data,(j[Te]||{}).data))),Fe.content&&In(Fe.content,0),Y[Le]=Fe,ue.push(Fe)}}function D(R,j){return new Date((Tr(R,j+4)/1e7*Math.pow(2,32)+Tr(R,j)/1e7-11644473600)*1e3)}function B(R,j){return f(),g(d.readFileSync(R),j)}function G(R,j){var O=j&&j.type;switch(O||gt&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return B(R,j);case"base64":return g(ea(Sr(R)),j);case"binary":return g(ea(R),j)}return g(R,j)}function F(R,j){var O=j||{},V=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=V+"/",R.FileIndex[0]={name:V,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),W(R)}function W(R){var j="Sh33tJ5";if(!yt.find(R,"/"+j)){var O=yn(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:j,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+j),U(R)}}function U(R,j){F(R);for(var O=!1,V=!1,q=R.FullPaths.length-1;q>=0;--q){var Y=R.FileIndex[q];switch(Y.type){case 0:V?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(Y.R*Y.L*Y.C)&&(O=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!j)){var ue=new Date(1987,1,19),Te=0,le=Object.create?Object.create(null):{},he=[];for(q=0;q<R.FullPaths.length;++q)le[R.FullPaths[q]]=!0,R.FileIndex[q].type!==0&&he.push([R.FullPaths[q],R.FileIndex[q]]);for(q=0;q<he.length;++q){var pe=r(he[q][0]);V=le[pe],V||(he.push([pe,{name:a(pe).replace("/",""),type:1,clsid:ie,ct:ue,mt:ue,content:null}]),le[pe]=!0)}for(he.sort(function(Le,Re){return n(Le[0],Re[0])}),R.FullPaths=[],R.FileIndex=[],q=0;q<he.length;++q)R.FullPaths[q]=he[q][0],R.FileIndex[q]=he[q][1];for(q=0;q<he.length;++q){var ke=R.FileIndex[q],De=R.FullPaths[q];if(ke.name=a(De).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||ie,q===0)ke.C=he.length>1?1:-1,ke.size=0,ke.type=5;else if(De.slice(-1)=="/"){for(Te=q+1;Te<he.length&&r(R.FullPaths[Te])!=De;++Te);for(ke.C=Te>=he.length?-1:Te,Te=q+1;Te<he.length&&r(R.FullPaths[Te])!=r(De);++Te);ke.R=Te>=he.length?-1:Te,ke.type=1}else r(R.FullPaths[q+1]||"")==r(De)&&(ke.R=q+1),ke.type=2}}}function ae(R,j){var O=j||{};if(O.fileType=="mad")return Cr(R,O);switch(U(R),O.fileType){case"zip":return Aa(R,O)}var V=function(Le){for(var Re=0,Fe=0,Xe=0;Xe<Le.FileIndex.length;++Xe){var kt=Le.FileIndex[Xe];if(kt.content){var Ct=kt.content.length;Ct>0&&(Ct<4096?Re+=Ct+63>>6:Fe+=Ct+511>>9)}}for(var Rt=Le.FullPaths.length+3>>2,$r=Re+7>>3,ni=Re+127>>7,br=$r+Fe+Rt+ni,Gr=br+127>>7,qi=Gr<=109?0:Math.ceil((Gr-109)/127);br+Gr+qi+127>>7>Gr;)qi=++Gr<=109?0:Math.ceil((Gr-109)/127);var zr=[1,qi,Gr,ni,Rt,Fe,Re,0];return Le.FileIndex[0].size=Re<<6,zr[7]=(Le.FileIndex[0].start=zr[0]+zr[1]+zr[2]+zr[3]+zr[4]+zr[5])+(zr[6]+7>>3),zr}(R),q=yn(V[7]<<9),Y=0,ue=0;{for(Y=0;Y<8;++Y)q.write_shift(1,we[Y]);for(Y=0;Y<8;++Y)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),Y=0;Y<3;++Y)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,V[2]),q.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:Ee),q.write_shift(4,V[3]),q.write_shift(-4,V[1]?V[0]-1:Ee),q.write_shift(4,V[1]),Y=0;Y<109;++Y)q.write_shift(-4,Y<V[2]?V[1]+Y:-1)}if(V[1])for(ue=0;ue<V[1];++ue){for(;Y<236+ue*127;++Y)q.write_shift(-4,Y<V[2]?V[1]+Y:-1);q.write_shift(-4,ue===V[1]-1?Ee:ue+1)}var Te=function(Le){for(ue+=Le;Y<ue-1;++Y)q.write_shift(-4,Y+1);Le&&(++Y,q.write_shift(-4,Ee))};for(ue=Y=0,ue+=V[1];Y<ue;++Y)q.write_shift(-4,de.DIFSECT);for(ue+=V[2];Y<ue;++Y)q.write_shift(-4,de.FATSECT);Te(V[3]),Te(V[4]);for(var le=0,he=0,pe=R.FileIndex[0];le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(he=pe.content.length,!(he<4096)&&(pe.start=ue,Te(he+511>>9)));for(Te(V[6]+7>>3);q.l&511;)q.write_shift(-4,de.ENDOFCHAIN);for(ue=Y=0,le=0;le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(he=pe.content.length,!(!he||he>=4096)&&(pe.start=ue,Te(he+63>>6)));for(;q.l&511;)q.write_shift(-4,de.ENDOFCHAIN);for(Y=0;Y<V[4]<<2;++Y){var ke=R.FullPaths[Y];if(!ke||ke.length===0){for(le=0;le<17;++le)q.write_shift(4,0);for(le=0;le<3;++le)q.write_shift(4,-1);for(le=0;le<12;++le)q.write_shift(4,0);continue}pe=R.FileIndex[Y],Y===0&&(pe.start=pe.size?pe.start-1:Ee);var De=Y===0&&O.root||pe.name;if(he=2*(De.length+1),q.write_shift(64,De,"utf16le"),q.write_shift(2,he),q.write_shift(1,pe.type),q.write_shift(1,pe.color),q.write_shift(-4,pe.L),q.write_shift(-4,pe.R),q.write_shift(-4,pe.C),pe.clsid)q.write_shift(16,pe.clsid,"hex");else for(le=0;le<4;++le)q.write_shift(4,0);q.write_shift(4,pe.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,pe.start),q.write_shift(4,pe.size),q.write_shift(4,0)}for(Y=1;Y<R.FileIndex.length;++Y)if(pe=R.FileIndex[Y],pe.size>=4096)if(q.l=pe.start+1<<9,gt&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+511&-512;else{for(le=0;le<pe.size;++le)q.write_shift(1,pe.content[le]);for(;le&511;++le)q.write_shift(1,0)}for(Y=1;Y<R.FileIndex.length;++Y)if(pe=R.FileIndex[Y],pe.size>0&&pe.size<4096)if(gt&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+63&-64;else{for(le=0;le<pe.size;++le)q.write_shift(1,pe.content[le]);for(;le&63;++le)q.write_shift(1,0)}if(gt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function z(R,j){var O=R.FullPaths.map(function(le){return le.toUpperCase()}),V=O.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),q=!1;j.charCodeAt(0)===47?(q=!0,j=O[0].slice(0,-1)+j):q=j.indexOf("/")!==-1;var Y=j.toUpperCase(),ue=q===!0?O.indexOf(Y):V.indexOf(Y);if(ue!==-1)return R.FileIndex[ue];var Te=!Y.match(yc);for(Y=Y.replace(er,""),Te&&(Y=Y.replace(yc,"!")),ue=0;ue<O.length;++ue)if((Te?O[ue].replace(yc,"!"):O[ue]).replace(er,"")==Y||(Te?V[ue].replace(yc,"!"):V[ue]).replace(er,"")==Y)return R.FileIndex[ue];return null}var ee=64,Ee=-2,Ae="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ee,FREESECT:-1,HEADER_SIGNATURE:Ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(R,j,O){f();var V=ae(R,O);d.writeFileSync(j,V)}function J(R){for(var j=new Array(R.length),O=0;O<R.length;++O)j[O]=String.fromCharCode(R[O]);return j.join("")}function M(R,j){var O=ae(R,j);switch(j&&j.type||"buffer"){case"file":return f(),d.writeFileSync(j.filename,O),O;case"binary":return typeof O=="string"?O:J(O);case"base64":return lw(typeof O=="string"?O:J(O));case"buffer":if(gt)return Buffer.isBuffer(O)?O:Ls(O);case"array":return typeof O=="string"?ea(O):O}return O}var Q;function I(R){try{var j=R.InflateRaw,O=new j;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Q=R;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function X(R,j){if(!Q)return dr(R,j);var O=Q.InflateRaw,V=new O,q=V._processChunk(R.slice(R.l),V._finishFlushFlag);return R.l+=V.bytesRead,q}function K(R){return Q?Q.deflateRawSync(R):Qe(R)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(R){var j=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(j>>16|j>>8|j)&255}for(var ye=typeof Uint8Array<"u",_e=ye?new Uint8Array(256):[],$e=0;$e<256;++$e)_e[$e]=ve($e);function Z(R,j){var O=_e[R&255];return j<=8?O>>>8-j:(O=O<<8|_e[R>>8&255],j<=16?O>>>16-j:(O=O<<8|_e[R>>16&255],O>>>24-j))}function ct(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=6?0:R[V+1]<<8))>>>O&3}function qe(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=5?0:R[V+1]<<8))>>>O&7}function dt(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=4?0:R[V+1]<<8))>>>O&15}function tt(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=3?0:R[V+1]<<8))>>>O&31}function Me(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=1?0:R[V+1]<<8))>>>O&127}function Ft(R,j,O){var V=j&7,q=j>>>3,Y=(1<<O)-1,ue=R[q]>>>V;return O<8-V||(ue|=R[q+1]<<8-V,O<16-V)||(ue|=R[q+2]<<16-V,O<24-V)||(ue|=R[q+3]<<24-V),ue&Y}function pn(R,j,O){var V=j&7,q=j>>>3;return V<=5?R[q]|=(O&7)<<V:(R[q]|=O<<V&255,R[q+1]=(O&7)>>8-V),j+3}function sn(R,j,O){var V=j&7,q=j>>>3;return O=(O&1)<<V,R[q]|=O,j+1}function en(R,j,O){var V=j&7,q=j>>>3;return O<<=V,R[q]|=O&255,O>>>=8,R[q+1]=O,j+8}function rr(R,j,O){var V=j&7,q=j>>>3;return O<<=V,R[q]|=O&255,O>>>=8,R[q+1]=O&255,R[q+2]=O>>>8,j+16}function Pn(R,j){var O=R.length,V=2*O>j?2*O:j+5,q=0;if(O>=j)return R;if(gt){var Y=cw(V);if(R.copy)R.copy(Y);else for(;q<R.length;++q)Y[q]=R[q];return Y}else if(ye){var ue=new Uint8Array(V);if(ue.set)ue.set(R);else for(;q<O;++q)ue[q]=R[q];return ue}return R.length=V,R}function Jt(R){for(var j=new Array(R),O=0;O<R;++O)j[O]=0;return j}function Jn(R,j,O){var V=1,q=0,Y=0,ue=0,Te=0,le=R.length,he=ye?new Uint16Array(32):Jt(32);for(Y=0;Y<32;++Y)he[Y]=0;for(Y=le;Y<O;++Y)R[Y]=0;le=R.length;var pe=ye?new Uint16Array(le):Jt(le);for(Y=0;Y<le;++Y)he[q=R[Y]]++,V<q&&(V=q),pe[Y]=0;for(he[0]=0,Y=1;Y<=V;++Y)he[Y+16]=Te=Te+he[Y-1]<<1;for(Y=0;Y<le;++Y)Te=R[Y],Te!=0&&(pe[Y]=he[Te+16]++);var ke=0;for(Y=0;Y<le;++Y)if(ke=R[Y],ke!=0)for(Te=Z(pe[Y],V)>>V-ke,ue=(1<<V+4-ke)-1;ue>=0;--ue)j[Te|ue<<ke]=ke&15|Y<<4;return V}var gn=ye?new Uint16Array(512):Jt(512),qt=ye?new Uint16Array(32):Jt(32);if(!ye){for(var At=0;At<512;++At)gn[At]=0;for(At=0;At<32;++At)qt[At]=0}(function(){for(var R=[],j=0;j<32;j++)R.push(5);Jn(R,qt,32);var O=[];for(j=0;j<=143;j++)O.push(8);for(;j<=255;j++)O.push(9);for(;j<=279;j++)O.push(7);for(;j<=287;j++)O.push(8);Jn(O,gn,288)})();var Nt=function(){for(var j=ye?new Uint8Array(32768):[],O=0,V=0;O<me.length-1;++O)for(;V<me[O+1];++V)j[V]=O;for(;V<32768;++V)j[V]=29;var q=ye?new Uint8Array(259):[];for(O=0,V=0;O<te.length-1;++O)for(;V<te[O+1];++V)q[V]=O;function Y(Te,le){for(var he=0;he<Te.length;){var pe=Math.min(65535,Te.length-he),ke=he+pe==Te.length;for(le.write_shift(1,+ke),le.write_shift(2,pe),le.write_shift(2,~pe&65535);pe-- >0;)le[le.l++]=Te[he++]}return le.l}function ue(Te,le){for(var he=0,pe=0,ke=ye?new Uint16Array(32768):[];pe<Te.length;){var De=Math.min(65535,Te.length-pe);if(De<10){for(he=pn(le,he,+(pe+De==Te.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,De),le.write_shift(2,~De&65535);De-- >0;)le[le.l++]=Te[pe++];he=le.l*8;continue}he=pn(le,he,+(pe+De==Te.length)+2);for(var Le=0;De-- >0;){var Re=Te[pe];Le=(Le<<5^Re)&32767;var Fe=-1,Xe=0;if((Fe=ke[Le])&&(Fe|=pe&-32768,Fe>pe&&(Fe-=32768),Fe<pe))for(;Te[Fe+Xe]==Te[pe+Xe]&&Xe<250;)++Xe;if(Xe>2){Re=q[Xe],Re<=22?he=en(le,he,_e[Re+1]>>1)-1:(en(le,he,3),he+=5,en(le,he,_e[Re-23]>>5),he+=3);var kt=Re<8?0:Re-4>>2;kt>0&&(rr(le,he,Xe-te[Re]),he+=kt),Re=j[pe-Fe],he=en(le,he,_e[Re]>>3),he-=3;var Ct=Re<4?0:Re-2>>1;Ct>0&&(rr(le,he,pe-Fe-me[Re]),he+=Ct);for(var Rt=0;Rt<Xe;++Rt)ke[Le]=pe&32767,Le=(Le<<5^Te[pe])&32767,++pe;De-=Xe-1}else Re<=143?Re=Re+48:he=sn(le,he,1),he=en(le,he,_e[Re]),ke[Le]=pe&32767,++pe}he=en(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?Y(le,he):ue(le,he)}}();function Qe(R){var j=yn(50+Math.floor(R.length*1.1)),O=Nt(R,j);return j.slice(0,O)}var wt=ye?new Uint16Array(32768):Jt(32768),tn=ye?new Uint16Array(32768):Jt(32768),Ne=ye?new Uint16Array(128):Jt(128),Ge=1,Ve=1;function ze(R,j){var O=tt(R,j)+257;j+=5;var V=tt(R,j)+1;j+=5;var q=dt(R,j)+4;j+=4;for(var Y=0,ue=ye?new Uint8Array(19):Jt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=ye?new Uint8Array(8):Jt(8),pe=ye?new Uint8Array(8):Jt(8),ke=ue.length,De=0;De<q;++De)ue[P[De]]=Y=qe(R,j),le<Y&&(le=Y),he[Y]++,j+=3;var Le=0;for(he[0]=0,De=1;De<=le;++De)pe[De]=Le=Le+he[De-1]<<1;for(De=0;De<ke;++De)(Le=ue[De])!=0&&(Te[De]=pe[Le]++);var Re=0;for(De=0;De<ke;++De)if(Re=ue[De],Re!=0){Le=_e[Te[De]]>>8-Re;for(var Fe=(1<<7-Re)-1;Fe>=0;--Fe)Ne[Le|Fe<<Re]=Re&7|De<<3}var Xe=[];for(le=1;Xe.length<O+V;)switch(Le=Ne[Me(R,j)],j+=Le&7,Le>>>=3){case 16:for(Y=3+ct(R,j),j+=2,Le=Xe[Xe.length-1];Y-- >0;)Xe.push(Le);break;case 17:for(Y=3+qe(R,j),j+=3;Y-- >0;)Xe.push(0);break;case 18:for(Y=11+Me(R,j),j+=7;Y-- >0;)Xe.push(0);break;default:Xe.push(Le),le<Le&&(le=Le);break}var kt=Xe.slice(0,O),Ct=Xe.slice(O);for(De=O;De<286;++De)kt[De]=0;for(De=V;De<30;++De)Ct[De]=0;return Ge=Jn(kt,wt,286),Ve=Jn(Ct,tn,30),j}function nt(R,j){if(R[0]==3&&!(R[1]&3))return[Ui(j),2];for(var O=0,V=0,q=cw(j||1<<18),Y=0,ue=q.length>>>0,Te=0,le=0;(V&1)==0;){if(V=qe(R,O),O+=3,V>>>1)V>>1==1?(Te=9,le=5):(O=ze(R,O),Te=Ge,le=Ve);else{O&7&&(O+=8-(O&7));var he=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,he>0)for(!j&&ue<Y+he&&(q=Pn(q,Y+he),ue=q.length);he-- >0;)q[Y++]=R[O>>>3],O+=8;continue}for(;;){!j&&ue<Y+32767&&(q=Pn(q,Y+32767),ue=q.length);var pe=Ft(R,O,Te),ke=V>>>1==1?gn[pe]:wt[pe];if(O+=ke&15,ke>>>=4,(ke>>>8&255)===0)q[Y++]=ke;else{if(ke==256)break;ke-=257;var De=ke<8?0:ke-4>>2;De>5&&(De=0);var Le=Y+te[ke];De>0&&(Le+=Ft(R,O,De),O+=De),pe=Ft(R,O,le),ke=V>>>1==1?qt[pe]:tn[pe],O+=ke&15,ke>>>=4;var Re=ke<4?0:ke-2>>1,Fe=me[ke];for(Re>0&&(Fe+=Ft(R,O,Re),O+=Re),!j&&ue<Le&&(q=Pn(q,Le+100),ue=q.length);Y<Le;)q[Y]=q[Y-Fe],++Y}}}return j?[q,O+7>>>3]:[q.slice(0,Y),O+7>>>3]}function dr(R,j){var O=R.slice(R.l||0),V=nt(O,j);return R.l+=V[1],V[0]}function sa(R,j){if(R)typeof console<"u"&&console.error(j);else throw new Error(j)}function Hi(R,j){var O=R;In(O,0);var V=[],q=[],Y={FileIndex:V,FullPaths:q};F(Y,{root:j.root});for(var ue=O.length-4;(O[ue]!=80||O[ue+1]!=75||O[ue+2]!=5||O[ue+3]!=6)&&ue>=0;)--ue;O.l=ue+4,O.l+=4;var Te=O.read_shift(2);O.l+=6;var le=O.read_shift(4);for(O.l=le,ue=0;ue<Te;++ue){O.l+=20;var he=O.read_shift(4),pe=O.read_shift(4),ke=O.read_shift(2),De=O.read_shift(2),Le=O.read_shift(2);O.l+=8;var Re=O.read_shift(4),Fe=c(O.slice(O.l+ke,O.l+ke+De));O.l+=ke+De+Le;var Xe=O.l;O.l=Re+4,$i(O,he,pe,Y,Fe),O.l=Xe}return Y}function $i(R,j,O,V,q){R.l+=2;var Y=R.read_shift(2),ue=R.read_shift(2),Te=l(R);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var le=R.read_shift(4),he=R.read_shift(4),pe=R.read_shift(4),ke=R.read_shift(2),De=R.read_shift(2),Le="",Re=0;Re<ke;++Re)Le+=String.fromCharCode(R[R.l++]);if(De){var Fe=c(R.slice(R.l,R.l+De));(Fe[21589]||{}).mt&&(Te=Fe[21589].mt),((q||{})[21589]||{}).mt&&(Te=q[21589].mt)}R.l+=De;var Xe=R.slice(R.l,R.l+he);switch(ue){case 8:Xe=X(R,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var kt=!1;Y&8&&(le=R.read_shift(4),le==134695760&&(le=R.read_shift(4),kt=!0),he=R.read_shift(4),pe=R.read_shift(4)),he!=j&&sa(kt,"Bad compressed size: "+j+" != "+he),pe!=O&&sa(kt,"Bad uncompressed size: "+O+" != "+pe),ln(V,Le,Xe,{unsafe:!0,mt:Te})}function Aa(R,j){var O=j||{},V=[],q=[],Y=yn(1),ue=O.compression?8:0,Te=0,le=0,he=0,pe=0,ke=0,De=R.FullPaths[0],Le=De,Re=R.FileIndex[0],Fe=[],Xe=0;for(le=1;le<R.FullPaths.length;++le)if(Le=R.FullPaths[le].slice(De.length),Re=R.FileIndex[le],!(!Re.size||!Re.content||Le=="Sh33tJ5")){var kt=pe,Ct=yn(Le.length);for(he=0;he<Le.length;++he)Ct.write_shift(1,Le.charCodeAt(he)&127);Ct=Ct.slice(0,Ct.l),Fe[ke]=EO.buf(Re.content,0);var Rt=Re.content;ue==8&&(Rt=K(Rt)),Y=yn(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Te),Y.write_shift(2,ue),Re.mt?s(Y,Re.mt):Y.write_shift(4,0),Y.write_shift(-4,Fe[ke]),Y.write_shift(4,Rt.length),Y.write_shift(4,Re.content.length),Y.write_shift(2,Ct.length),Y.write_shift(2,0),pe+=Y.length,V.push(Y),pe+=Ct.length,V.push(Ct),pe+=Rt.length,V.push(Rt),Y=yn(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Te),Y.write_shift(2,ue),Y.write_shift(4,0),Y.write_shift(-4,Fe[ke]),Y.write_shift(4,Rt.length),Y.write_shift(4,Re.content.length),Y.write_shift(2,Ct.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,kt),Xe+=Y.l,q.push(Y),Xe+=Ct.length,q.push(Ct),++ke}return Y=yn(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,ke),Y.write_shift(2,ke),Y.write_shift(4,Xe),Y.write_shift(4,pe),Y.write_shift(2,0),Ri([Ri(V),Ri(q),Y])}var ti={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vs(R,j){if(R.ctype)return R.ctype;var O=R.name||"",V=O.match(/\.([^\.]+)$/);return V&&ti[V[1]]||j&&(V=(O=j).match(/[\.\\]([^\.\\])+$/),V&&ti[V[1]])?ti[V[1]]:"application/octet-stream"}function Hs(R){for(var j=lw(R),O=[],V=0;V<j.length;V+=76)O.push(j.slice(V,V+76));return O.join(`\r
`)+`\r
`}function Gi(R){var j=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var pe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],V=j.split(`\r
`),q=0;q<V.length;++q){var Y=V[q];if(Y.length==0){O.push("");continue}for(var ue=0;ue<Y.length;){var Te=76,le=Y.slice(ue,ue+Te);le.charAt(Te-1)=="="?Te--:le.charAt(Te-2)=="="?Te-=2:le.charAt(Te-3)=="="&&(Te-=3),le=Y.slice(ue,ue+Te),ue+=Te,ue<Y.length&&(le+="="),O.push(le)}}return O.join(`\r
`)}function zi(R){for(var j=[],O=0;O<R.length;++O){for(var V=R[O];O<=R.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+R[++O];j.push(V)}for(var q=0;q<j.length;++q)j[q]=j[q].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return ea(j.join(`\r
`))}function $s(R,j,O){for(var V="",q="",Y="",ue,Te=0;Te<10;++Te){var le=j[Te];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":V=he[2].trim();break;case"content-type":Y=he[2].trim();break;case"content-transfer-encoding":q=he[2].trim();break}}switch(++Te,q.toLowerCase()){case"base64":ue=ea(Sr(j.slice(Te).join("")));break;case"quoted-printable":ue=zi(j.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var pe=ln(R,V.slice(O.length),ue,{unsafe:!0});Y&&(pe.ctype=Y)}function hl(R,j){if(J(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=j&&j.root||"",V=(gt&&Buffer.isBuffer(R)?R.toString("binary"):J(R)).split(`\r
`),q=0,Y="";for(q=0;q<V.length;++q)if(Y=V[q],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),O||(O=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),Y.slice(0,O.length)!=O););var ue=(V[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var Te="--"+(ue[1]||""),le=[],he=[],pe={FileIndex:le,FullPaths:he};F(pe);var ke,De=0;for(q=0;q<V.length;++q){var Le=V[q];Le!==Te&&Le!==Te+"--"||(De++&&$s(pe,V.slice(ke,q),O),ke=q)}return pe}function Cr(R,j){var O=j||{},V=O.boundary||"SheetJS";V="------="+V;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],Y=R.FullPaths[0],ue=Y,Te=R.FileIndex[0],le=1;le<R.FullPaths.length;++le)if(ue=R.FullPaths[le].slice(Y.length),Te=R.FileIndex[le],!(!Te.size||!Te.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var he=Te.content,pe=gt&&Buffer.isBuffer(he)?he.toString("binary"):J(he),ke=0,De=Math.min(1024,pe.length),Le=0,Re=0;Re<=De;++Re)(Le=pe.charCodeAt(Re))>=32&&Le<128&&++ke;var Fe=ke>=De*4/5;q.push(V),q.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ue),q.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),q.push("Content-Type: "+Vs(Te,ue)),q.push(""),q.push(Fe?Gi(pe):Hs(pe))}return q.push(V+`--\r
`),q.join(`\r
`)}function on(R){var j={};return F(j,R),j}function ln(R,j,O,V){var q=V&&V.unsafe;q||F(R);var Y=!q&&yt.find(R,j);if(!Y){var ue=R.FullPaths[0];j.slice(0,ue.length)==ue?ue=j:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+j).replace("//","/")),Y={name:a(j),type:2},R.FileIndex.push(Y),R.FullPaths.push(ue),q||yt.utils.cfb_gc(R)}return Y.content=O,Y.size=O?O.length:0,V&&(V.CLSID&&(Y.clsid=V.CLSID),V.mt&&(Y.mt=V.mt),V.ct&&(Y.ct=V.ct)),Y}function oa(R,j){F(R);var O=yt.find(R,j);if(O){for(var V=0;V<R.FileIndex.length;++V)if(R.FileIndex[V]==O)return R.FileIndex.splice(V,1),R.FullPaths.splice(V,1),!0}return!1}function hr(R,j,O){F(R);var V=yt.find(R,j);if(V){for(var q=0;q<R.FileIndex.length;++q)if(R.FileIndex[q]==V)return R.FileIndex[q].name=a(O),R.FullPaths[q]=O,!0}return!1}function ml(R){U(R,!0)}return e.find=z,e.read=G,e.parse=g,e.write=M,e.writeFile=re,e.utils={cfb_new:on,cfb_add:ln,cfb_del:oa,cfb_mov:hr,cfb_gc:ml,ReadShift:Ac,CheckField:AE,prep_blob:In,bconcat:Ri,use_zlib:I,_deflateRaw:Qe,_inflateRaw:dr,consts:de},e}();function SO(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function wa(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function bp(t){for(var e=[],n=wa(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}var sd=new Date(1899,11,30,0,0,0);function nr(t,e){var n=t.getTime(),r=sd.getTime()+(t.getTimezoneOffset()-sd.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var sE=new Date,CO=sd.getTime()+(sE.getTimezoneOffset()-sd.getTimezoneOffset())*6e4,xw=sE.getTimezoneOffset();function bd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+CO),e.getTimezoneOffset()!==xw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-xw)*6e4),e}function bO(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(n=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[s],10)}return e}var vw=new Date("2017-02-19T19:06:09.000Z"),oE=isNaN(vw.getFullYear())?new Date("2/19/17"):vw,AO=oE.getFullYear()==2017;function Nn(t,e){var n=new Date(t);if(AO)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(oE.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ks(t,e){if(gt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return wc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wc(Y2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return wc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wc(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Fn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Fn(t[n]));return e}function Zt(t,e){for(var n="";n.length<e;)n+=t;return n}function ra(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,s){return n=-n,s}),!isNaN(e=Number(r)))?e/n:e}var kO=["january","february","march","april","may","june","july","august","september","october","november","december"];function tl(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&kO.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||s>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var NO=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var s=n.split(r),l=[s[0]],c=1;c<s.length;++c)l.push(a),l.push(s[c]);return l}}();function lE(t){return t?t.content&&t.type?ks(t.content,!0):t.data?vc(t.data):t.asNodeBuffer&&gt?vc(t.asNodeBuffer().toString("binary")):t.asBinary?vc(t.asBinary()):t._data&&t._data.getContent?vc(ks(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function cE(t){if(!t)return null;if(t.data)return sw(t.data);if(t.asNodeBuffer&&gt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?sw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function RO(t){return t&&t.name.slice(-4)===".bin"?cE(t):lE(t)}function Ur(t,e){for(var n=t.FullPaths||wa(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var l=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[s]]:t.FileIndex[s]}return null}function Ap(t,e){var n=Ur(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function dn(t,e,n){if(!n)return RO(Ap(t,e));if(!e)return null;try{return dn(t,e)}catch{return null}}function Er(t,e,n){if(!n)return lE(Ap(t,e));if(!e)return null;try{return Er(t,e)}catch{return null}}function MO(t,e,n){return cE(Ap(t,e))}function yw(t){for(var e=t.FullPaths||wa(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function DO(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return gt?r=Ls(n):r=XP(n),yt.utils.cfb_add(t,e,r)}yt.utils.cfb_add(t,e,n)}else t.file(e,n)}function uE(t,e){switch(e.type){case"base64":return yt.read(t,{type:"base64"});case"binary":return yt.read(t,{type:"binary"});case"buffer":case"array":return yt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function _c(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var fE=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_w=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,FO=/<[^>]*>/g,Wn=fE.match(_w)?_w:FO,LO=/<\w*:/,PO=/<(\/?)\w+:/;function Ke(t,e,n){for(var r={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(IO),c=0,d="",f=0,g="",v="",_=1;if(l)for(f=0;f!=l.length;++f){for(v=l[f],s=0;s!=v.length&&v.charCodeAt(s)!==61;++s);for(g=v.slice(0,s).trim();v.charCodeAt(s+1)==32;)++s;for(_=(a=v.charCodeAt(s+1))==34||a==39?1:0,d=v.slice(s+1+_,v.length-_),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=d,r[g.toLowerCase()]=d;else{var T=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[T]&&g.slice(c-3,c)=="ext")continue;r[T]=d,r[T.toLowerCase()]=d}}return r}function Ca(t){return t.replace(PO,"<$1")}var dE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},OO=bp(dE),Tt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(c,d){return dE[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,s))+a.slice(s+9,l)+n(a.slice(l+3))}}(),UO=/[&<>'"]/g,BO=/[\u0000-\u001f]/g;function kp(t){var e=t+"";return e.replace(UO,function(n){return OO[n]}).replace(/\n/g,"<br/>").replace(BO,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var ww=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function zt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zh(t){for(var e="",n=0,r=0,a=0,s=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|s&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Tw(t){var e=Ui(2*t.length),n,r,a=1,s=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=n%256,e[s++]=n>>>8;return e.slice(0,s).toString("ucs2")}function Ew(t){return Ls(t,"binary").toString("utf8")}var Rf="foo bar baz",Vt=gt&&(Ew(Rf)==Zh(Rf)&&Ew||Tw(Rf)==Zh(Rf)&&Tw)||Zh,wc=gt?function(t){return Ls(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},zc=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),hE=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),jO=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),VO=/<\/?(?:vt:)?variant>/g,HO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Sw(t,e){var n=Ke(t),r=t.match(jO(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(s){var l=s.replace(VO,"").match(HO);l&&a.push({v:Vt(l[2]),t:l[1]})}),a}var $O=/(^\s|\s$|\n)/;function GO(t){return wa(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function zO(t,e,n){return"<"+t+(n!=null?GO(n):"")+(e!=null?(e.match($O)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Np(t){if(gt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Vt(Ps(Ep(t)));throw new Error("Bad input format: expected Buffer or string")}var qc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qO={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},YO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function WO(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function JO(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,l=r?-e:e;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)t[n+c]=s&255;t[n+6]=(a&15)<<4|s&15,t[n+7]=a>>4|r}var Cw=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,s=t[0][r].length;a<s;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},bw=gt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ls(e)})):Cw(t)}:Cw,Aw=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(Ga(t,a)));return r.join("").replace(er,"")},Rp=gt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(er,""):Aw(t,e,n)}:Aw,kw=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},mE=gt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):kw(t,e,n)}:kw,Nw=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Bo(t,a)));return r.join("")},au=gt?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):Nw(e,n,r)}:Nw,pE=function(t,e){var n=Tr(t,e);return n>0?au(t,e+4,e+4+n-1):""},gE=pE,xE=function(t,e){var n=Tr(t,e);return n>0?au(t,e+4,e+4+n-1):""},vE=xE,yE=function(t,e){var n=2*Tr(t,e);return n>0?au(t,e+4,e+4+n-1):""},_E=yE,wE=function(e,n){var r=Tr(e,n);return r>0?Rp(e,n+4,n+4+r):""},TE=wE,EE=function(t,e){var n=Tr(t,e);return n>0?au(t,e+4,e+4+n):""},SE=EE,CE=function(t,e){return WO(t,e)},od=CE,bE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&(gE=function(e,n){if(!Buffer.isBuffer(e))return pE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},vE=function(e,n){if(!Buffer.isBuffer(e))return xE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},_E=function(e,n){if(!Buffer.isBuffer(e))return yE(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},TE=function(e,n){if(!Buffer.isBuffer(e))return wE(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},SE=function(e,n){if(!Buffer.isBuffer(e))return EE(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},od=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):CE(e,n)},bE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Bo=function(t,e){return t[e]},Ga=function(t,e){return t[e+1]*256+t[e]},KO=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Tr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},hs=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},XO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ac(t,e){var n="",r,a,s=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,gt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(Ga(this,f)),f+=2;t*=2;break;case"utf8":n=au(this,this.l,this.l+t);break;case"utf16le":t*=2,n=Rp(this,this.l,this.l+t);break;case"wstr":return Ac.call(this,t,"dbcs");case"lpstr-ansi":n=gE(this,this.l),t=4+Tr(this,this.l);break;case"lpstr-cp":n=vE(this,this.l),t=4+Tr(this,this.l);break;case"lpwstr":n=_E(this,this.l),t=4+2*Tr(this,this.l);break;case"lpp4":t=4+Tr(this,this.l),n=TE(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Tr(this,this.l),n=SE(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=Bo(this,this.l+t++))!==0;)s.push(Nf(l));n=s.join("");break;case"_wstr":for(t=0,n="";(l=Ga(this,this.l+t))!==0;)s.push(Nf(l)),t+=2;t+=2,n=s.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Bo(this,f),this.l=f+1,c=Ac.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Nf(Ga(this,f))),f+=2}n=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Bo(this,f),this.l=f+1,c=Ac.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Nf(Bo(this,f))),f+=1}n=s.join("");break;default:switch(t){case 1:return r=Bo(this,this.l),this.l++,r;case 2:return r=(e==="i"?KO:Ga)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?hs:XO)(this,this.l),this.l+=4,r):(a=Tr(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=od(this,this.l):a=od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=mE(this,this.l,t);break}}return this.l+=t,n}var ZO=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},QO=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},eU=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function tU(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)eU(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,ZO(this,e,this.l);break;case 8:if(r=8,n==="f"){JO(this,e,this.l);break}case 16:break;case-4:r=4,QO(this,e,this.l);break}return this.l+=r,this}function AE(t,e){var n=mE(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function In(t,e){t.l=e,t.read_shift=Ac,t.chk=AE,t.write_shift=tU}function Yn(t,e){t.l+=e}function yn(t){var e=Ui(t);return In(e,0),e}function ei(t,e,n){if(t){var r,a,s;In(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=hd[c]||hd[65535];for(r=t.read_shift(1),s=r&127,a=1;a<4&&r&128;++a)s+=((r=t.read_shift(1))&127)<<7*a;d=t.l+s;var g=f.f&&f.f(t,s,n);if(t.l=d,e(g,f,c))return}}}function jm(){var t=[],e=gt?256:2048,n=function(f){var g=yn(f);return In(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},s=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,e)))},l=function(){return a(),Ri(t)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:c,end:l,_bufs:t}}function kc(t,e,n){var r=Fn(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Rw(t,e,n){var r=Fn(t);return r.s=kc(r.s,e.s,n),r.e=kc(r.e,e.s,n),r}function Nc(t,e){if(t.cRel&&t.c<0)for(t=Fn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Fn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=at(t);return!t.cRel&&t.cRel!=null&&(n=aU(n)),!t.rRel&&t.rRel!=null&&(n=nU(n)),n}function Qh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+wn(t.s.c)+":"+(t.e.cRel?"":"$")+wn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ln(t.s.r)+":"+(t.e.rRel?"":"$")+Ln(t.e.r):Nc(t.s,e.biff)+":"+Nc(t.e,e.biff)}function Mp(t){return parseInt(rU(t),10)-1}function Ln(t){return""+(t+1)}function nU(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rU(t){return t.replace(/\$(\d+)$/,"$1")}function Dp(t){for(var e=iU(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function wn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function aU(t){return t.replace(/^([A-Z])/,"$$$1")}function iU(t){return t.replace(/^\$([A-Z])/,"$1")}function sU(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qn(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function at(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function fl(t){var e=t.indexOf(":");return e==-1?{s:Qn(t),e:Qn(t)}:{s:Qn(t.slice(0,e)),e:Qn(t.slice(e+1))}}function _t(t,e){return typeof e>"u"||typeof e=="number"?_t(t.s,t.e):(typeof t!="string"&&(t=at(t)),typeof e!="string"&&(e=at(e)),t==e?t:t+":"+e)}function Qt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,s=t.length;for(n=0;r<s&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<s&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=s&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=s&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function Mw(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=jr(t.z,n?nr(e):e)}catch{}try{return t.w=jr((t.XF||{}).numFmtId||(n?14:0),n?nr(e):e)}catch{return""+e}}function Xa(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?Bs[t.v]||t.v:e==null?Mw(t,t.v):Mw(t,e))}function Vi(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function kE(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,s=t||(a?[]:{}),l=0,c=0;if(s&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?Qn(r.origin):r.origin;l=d.r,c=d.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var g=Qt(s["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var T={v:e[v][_]},E=l+v,S=c+_;if(f.s.r>E&&(f.s.r=E),f.s.c>S&&(f.s.c=S),f.e.r<E&&(f.e.r=E),f.e.c<S&&(f.e.c=S),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))T=e[v][_];else if(Array.isArray(T.v)&&(T.f=e[v][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(r.nullError)T.t="e",T.v=0;else if(r.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=r.dateNF||st[14],r.cellDates?(T.t="d",T.w=jr(T.z,nr(T.v))):(T.t="n",T.v=nr(T.v),T.w=jr(T.z,T.v))):T.t="s";if(a)s[E]||(s[E]=[]),s[E][S]&&s[E][S].z&&(T.z=s[E][S].z),s[E][S]=T;else{var C=at({c:S,r:E});s[C]&&s[C].z&&(T.z=s[C].z),s[C]=T}}}return f.s.c<1e7&&(s["!ref"]=_t(f)),s}function dl(t,e){return kE(null,t,e)}function oU(t){return t.read_shift(4,"i")}function qn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function lU(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Ip(t,e){var n=t.l,r=t.read_shift(1),a=qn(t),s=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)s.push(lU(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}var cU=Ip;function Hr(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Os(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var uU=qn;function Fp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var fU=qn,Vm=Fp;function Lp(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?od([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):hs(e,0)>>2;return n?a/100:a}function NE(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Us=NE;function $n(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function dU(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var f=vs[a];f&&(e.rgb=Wc(f));break;case 2:e.rgb=Wc([l,c,d]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function hU(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function RE(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function mU(t){return RE(t,1)}function pU(t){return RE(t,2)}var Pp=2,cr=3,Mf=11,Dw=12,ld=19,Df=64,gU=65,xU=71,vU=4108,yU=4126,kn=80,ME=81,_U=[kn,ME],wU={1:{n:"CodePage",t:Pp},2:{n:"Category",t:kn},3:{n:"PresentationFormat",t:kn},4:{n:"ByteCount",t:cr},5:{n:"LineCount",t:cr},6:{n:"ParagraphCount",t:cr},7:{n:"SlideCount",t:cr},8:{n:"NoteCount",t:cr},9:{n:"HiddenCount",t:cr},10:{n:"MultimediaClipCount",t:cr},11:{n:"ScaleCrop",t:Mf},12:{n:"HeadingPairs",t:vU},13:{n:"TitlesOfParts",t:yU},14:{n:"Manager",t:kn},15:{n:"Company",t:kn},16:{n:"LinksUpToDate",t:Mf},17:{n:"CharacterCount",t:cr},19:{n:"SharedDoc",t:Mf},22:{n:"HyperlinksChanged",t:Mf},23:{n:"AppVersion",t:cr,p:"version"},24:{n:"DigSig",t:gU},26:{n:"ContentType",t:kn},27:{n:"ContentStatus",t:kn},28:{n:"Language",t:kn},29:{n:"Version",t:kn},255:{},2147483648:{n:"Locale",t:ld},2147483651:{n:"Behavior",t:ld},1919054434:{}},TU={1:{n:"CodePage",t:Pp},2:{n:"Title",t:kn},3:{n:"Subject",t:kn},4:{n:"Author",t:kn},5:{n:"Keywords",t:kn},6:{n:"Comments",t:kn},7:{n:"Template",t:kn},8:{n:"LastAuthor",t:kn},9:{n:"RevNumber",t:kn},10:{n:"EditTime",t:Df},11:{n:"LastPrinted",t:Df},12:{n:"CreatedDate",t:Df},13:{n:"ModifiedDate",t:Df},14:{n:"PageCount",t:cr},15:{n:"WordCount",t:cr},16:{n:"CharCount",t:cr},17:{n:"Thumbnail",t:xU},18:{n:"Application",t:kn},19:{n:"DocSecurity",t:cr},255:{},2147483648:{n:"Locale",t:ld},2147483651:{n:"Behavior",t:ld},1919054434:{}},Iw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function SU(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var CU=SU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vs=Fn(CU),Bs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},DE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function bU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function AU(t){var e=bU();if(!t||!t.match)return e;var n={};if((t.match(Wn)||[]).forEach(function(r){var a=Ke(r);switch(a[0].replace(LO,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[Fw[a.ContentType]]!==void 0&&e[Fw[a.ContentType]].push(a.PartName);break}}),e.xmlns!==qO.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}var Vo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Hm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Rc(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(Wn)||[]).forEach(function(a){var s=Ke(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:_c(s.Target,e);n[c]=l,r[s.Id]=l}}),n["!id"]=r,n}var kU="application/vnd.oasis.opendocument.spreadsheet";function NU(t,e){for(var n=Np(t),r,a;r=qc.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=Ke(r[0],!1),a.path=="/"&&a.type!==kU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var Mc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RU=function(){for(var t=new Array(Mc.length),e=0;e<Mc.length;++e){var n=Mc[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function IE(t){var e={};t=Vt(t);for(var n=0;n<Mc.length;++n){var r=Mc[n],a=t.match(RU[n]);a!=null&&a.length>0&&(e[r[1]]=Tt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Nn(e[r[1]]))}return e}var MU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function FE(t,e,n,r){var a=[];if(typeof t=="string")a=Sw(t,r);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(g){return{v:g}}));var l=typeof e=="string"?Sw(e,r).map(function(g){return g.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=d,n.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(c,c+d);break}c+=d}}function DU(t,e,n){var r={};return e||(e={}),t=Vt(t),MU.forEach(function(a){var s=(t.match(zc(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=Tt(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&FE(r.HeadingPairs,r.TitlesOfParts,e,n),e}var IU=/<[^>]+>[^<]*/g;function FU(t,e){var n={},r="",a=t.match(IU);if(a)for(var s=0;s!=a.length;++s){var l=a[s],c=Ke(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Tt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),g=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Tt(g);break;case"bool":n[r]=zt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=Nn(g);break;case"cy":case"error":n[r]=Tt(g);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}var LU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},em;function PU(t,e,n){em||(em=bp(LU)),e=em[e]||e,t[e]=n}function Op(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LE(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function PE(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function OE(t,e,n){return e===31?PE(t):LE(t,e,n)}function $m(t,e,n){return OE(t,e,n===!1?0:4)}function OU(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return OE(t,e,0)}function UU(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(er,""),t.l-a&2&&(t.l+=2)}return n}function BU(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(er,"");return n}function jU(t){var e=t.l,n=cd(t,ME);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=cd(t,cr);return[n,r]}function VU(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(jU(t));return n}function Lw(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var s=t.read_shift(4),l=t.read_shift(4);r[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(er,"").replace(yc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function UE(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function HU(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function cd(t,e,n){var r=t.read_shift(2),a,s=n||{};if(t.l+=2,e!==Dw&&r!==e&&_U.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===Dw?r:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return LE(t,r,4).replace(er,"");case 31:return PE(t);case 64:return Op(t);case 65:return UE(t);case 71:return HU(t);case 80:return $m(t,r,!s.raw).replace(er,"");case 81:return OU(t,r).replace(er,"");case 4108:return VU(t);case 4126:case 4127:return r==4127?UU(t):BU(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function Pw(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),s=[],l=0,c=0,d=-1,f={};for(l=0;l!=a;++l){var g=t.read_shift(4),v=t.read_shift(4);s[l]=[g,v+n]}s.sort(function(A,b){return A[1]-b[1]});var _={};for(l=0;l!=a;++l){if(t.l!==s[l][1]){var T=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,T=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],T=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],T=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(T=!1,t.l=s[l][1]),T)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[s[l][0]];if(_[E.n]=cd(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(c=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(s[l][0]===1){if(c=_.CodePage=cd(t,Pp),ta(c),d!==-1){var S=t.l;t.l=s[d][1],f=Lw(t,c),t.l=S}}else if(s[l][0]===0){if(c===0){d=l,t.l=s[l+1][1];continue}f=Lw(t,c)}else{var C=f[s[l][0]],k;switch(t[t.l]){case 65:t.l+=4,k=UE(t);break;case 30:t.l+=4,k=$m(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=$m(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=an(t,4);break;case 64:t.l+=4,k=Nn(Op(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[C]=k}}return t.l=n+r,_}function Ow(t,e,n){var r=t.content;if(!r)return{};In(r,0);var a,s,l,c,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),g=r.read_shift(16);if(g!==yt.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var v=Pw(r,e),_={SystemIdentifier:f};for(var T in v)_[T]=v[T];if(_.FMTID=s,a===1)return _;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var E;try{E=Pw(r,null)}catch{}for(T in E)_[T]=E[T];return _.FMTID=[s,l],_}function Ci(t,e){return t.read_shift(e),null}function $U(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function an(t,e){return t.read_shift(e)===1}function hn(t){return t.read_shift(2,"u")}function BE(t,e){return $U(t,e,hn)}function GU(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function iu(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function zU(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,s=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*l),r&&(t.l+=c),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Ns(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function su(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Ns(t,r,n)}function js(t,e,n){if(n.biff>5)return su(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function qU(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function YU(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(er,"");return r&&(t.l+=24),a}function WU(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(er,"");return n+l}function JU(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return YU(t);case"0303000000000000c000000000000046":return WU(t);default:throw new Error("Unsupported Moniker "+n)}}function If(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(er,""):"";return n}function KU(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var s,l,c,d,f="",g,v;a&16&&(s=If(t,n-t.l)),a&128&&(l=If(t,n-t.l)),(a&257)===257&&(c=If(t,n-t.l)),(a&257)===1&&(d=JU(t,n-t.l)),a&8&&(f=If(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(v=Op(t)),t.l=n;var _=l||c||d||"";_&&f&&(_+="#"+f),_||(_="#"+f),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),v&&(T.time=v),s&&(T.Tooltip=s),T}function jE(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function VE(t,e){var n=jE(t);return n[3]=0,n}function ba(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function XU(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function ZU(t,e,n){return e===0?"":js(t,e,n)}function QU(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),s=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,s,l]}function HE(t){var e=t.read_shift(2),n=Lp(t);return[e,n]}function e7(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=iu(t,e,n),s=t.read_shift(2);if(r-=t.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return t.l+=s,a}function Ad(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function $E(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var t7=$E;function GE(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function n7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function r7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Bn(t){t.l+=2,t.l+=t.read_shift(2)}var a7={0:Bn,4:Bn,5:Bn,6:Bn,7:r7,8:Bn,9:Bn,10:Bn,11:Bn,12:Bn,13:n7,14:Bn,15:Bn,16:Bn,17:Bn,18:Bn,19:Bn,20:Bn,21:GE};function i7(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(a7[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function Ff(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function s7(t,e){return e===0||t.read_shift(2),1200}function o7(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=js(t,0,n);return t.read_shift(e+r-t.l),a}function l7(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function c7(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=iu(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:s,name:l}}function u7(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),s=[],l=0;l!=a&&t.l<n;++l)s.push(zU(t));return s.Count=r,s.Unique=a,s}function f7(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function d7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function h7(t){var e=XU(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function m7(t){return t.read_shift(2),t.read_shift(4)}function Uw(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,a]}function p7(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:s,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function g7(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function x7(){}function v7(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=iu(t,0,n),r}function y7(t){var e=ba(t);return e.isst=t.read_shift(4),e}function _7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=ba(t);n.biff==2&&t.l++;var s=su(t,r-t.l,n);return a.val=s,a}function w7(t,e,n){var r=t.read_shift(2),a=js(t,0,n);return[r,a]}var T7=js;function Bw(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),d=t.read_shift(2);return t.l=r,{s:{r:s,c},e:{r:l,c:d}}}function E7(t){var e=t.read_shift(2),n=t.read_shift(2),r=HE(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function S7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),s=[];t.l<n;)s.push(HE(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:s}}function C7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),s=[];t.l<n;)s.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:s}}function b7(t,e,n,r){var a={},s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return a.patternType=EU[c>>26],r.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function A7(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=b7(t,e,r.fStyle,n),r}function k7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function jw(t,e,n){var r=ba(t);(n.biff==2||e==9)&&++t.l;var a=GU(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function N7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=ba(t),a=$n(t);return r.val=a,r}var Vw=ZU;function R7(t,e,n){var r=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Ns(t,s),c=[];r>t.l;)c.push(su(t));return[s,a,l,c]}function Hw(t,e,n){var r=t.read_shift(2),a,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=e7(t,e-2,n)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var M7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $w(t,e,n){var r=t.l+e,a=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),d=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var f=Ns(t,l,n);a&32&&(f=M7[f.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var v=r==t.l||c===0||!(g>0)?[]:dV(t,g,n,c);return{chKey:s,Name:f,itab:d,rgce:v}}function zE(t,e,n){if(n.biff<8)return D7(t,e,n);for(var r=[],a=t.l+e,s=t.read_shift(n.biff>8?4:2);s--!==0;)r.push(QU(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function D7(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=iu(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function I7(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),s=Ns(t,r,n),l=Ns(t,a,n);return[s,l]}function F7(t,e,n){var r=$E(t);t.l++;var a=t.read_shift(1);return e-=8,[hV(t,e,n),a,r]}function Gw(t,e,n){var r=t7(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,uV(t,e,n)]}function L7(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function P7(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=js(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,s]}}function O7(t,e,n){return P7(t,e,n)}function U7(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(Ad(t));return n}function B7(t,e,n){if(n&&n.biff<8)return V7(t,e,n);var r=GE(t),a=i7(t,e-22,r[1]);return{cmo:r,ft:a}}var j7={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function V7(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((j7[r]||Yn)(t,e,n)),{cmo:[a,r,s],ft:l}}function H7(t,e,n){var r=t.l,a="";try{t.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=qU(t,6,n);var c=t.read_shift(2);t.read_shift(2),hn(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-r!=t.lens[f])throw new Error("TxO: bad continue record");var g=t[t.l],v=Ns(t,t.lens[f+1]-t.lens[f]-1);if(a+=v,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function $7(t,e){var n=Ad(t);t.l+=16;var r=KU(t,e-24);return[n,r]}function G7(t,e){t.read_shift(2);var n=Ad(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(er,""),[n,r]}function z7(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=Iw[n]||n,n=t.read_shift(2),e[1]=Iw[n]||n,e}function q7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(VE(t));return n}function Y7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(VE(t));return n}function W7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function qE(t,e,n){if(!n.cellStyles)return Yn(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),s=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var f={s:a,e:s,w:l,ixfe:c,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function J7(t,e){var n={};return e<32||(t.l+=16,n.header=$n(t),n.footer=$n(t),t.l+=2),n}function K7(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}var X7=ba,Z7=BE,Q7=su;function e9(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function t9(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=ba(t);++t.l;var a=js(t,e-7,n);return r.t="str",r.val=a,r}function n9(t){var e=ba(t);++t.l;var n=$n(t);return e.t="n",e.val=n,e}function r9(t){var e=ba(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function a9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function i9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function s9(t,e,n){var r=t.l+e,a=ba(t),s=t.read_shift(2),l=Ns(t,s,n);return t.l=r,a.t="str",a.val=l,a}var o9=[2,3,48,49,131,139,140,245],zw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,d){var f=[],g=Ui(1);switch(d.type){case"base64":g=ea(Sr(c));break;case"binary":g=ea(c);break;case"buffer":case"array":g=c;break}In(g,0);var v=g.read_shift(1),_=!!(v&136),T=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var S=0,C=521;v==2&&(S=g.read_shift(2)),g.l+=3,v!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),v!=2&&(C=g.read_shift(2));var k=g.read_shift(2),A=d.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(A=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var b=[],D={},B=Math.min(g.length,v==2?521:C-10-(T?264:0)),G=E?32:11;g.l<B&&g[g.l]!=13;)switch(D={},D.name=$c.utils.decode(A,g.slice(g.l,g.l+G)).replace(/[\u0000\r\n].*$/g,""),g.l+=G,D.type=String.fromCharCode(g.read_shift(1)),v!=2&&!E&&(D.offset=g.read_shift(4)),D.len=g.read_shift(1),v==2&&(D.offset=g.read_shift(2)),D.dec=g.read_shift(1),D.name.length&&b.push(D),v!=2&&(g.l+=E?13:14),D.type){case"B":(!T||D.len!=8)&&d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(g[g.l]!==13&&(g.l=C-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=C;var F=0,W=0;for(f[0]=[],W=0;W!=b.length;++W)f[0][W]=b[W].name;for(;S-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,f[++F]=[],W=0,W=0;W!=b.length;++W){var U=g.slice(g.l,g.l+b[W].len);g.l+=b[W].len,In(U,0);var ae=$c.utils.decode(A,U);switch(b[W].type){case"C":ae.trim().length&&(f[F][W]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?f[F][W]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):f[F][W]=ae;break;case"F":f[F][W]=parseFloat(ae.trim());break;case"+":case"I":f[F][W]=E?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":f[F][W]=!0;break;case"N":case"F":f[F][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[F][W]="##MEMO##"+(E?parseInt(ae.trim(),10):U.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(f[F][W]=+ae||0);break;case"@":f[F][W]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":f[F][W]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":f[F][W]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][W]=-U.read_shift(-8,"f");break;case"B":if(T&&b[W].len==8){f[F][W]=U.read_shift(8,"f");break}case"G":case"P":U.l+=b[W].len;break;case"0":if(b[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[W].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=b,f}function r(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var g=dl(n(c,f),f);return g["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,g}function a(c,d){try{return Vi(r(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&ta(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=jm(),v=Km(c,{header:1,raw:!0,cellDates:!0}),_=v[0],T=v.slice(1),E=c["!cols"]||[],S=0,C=0,k=0,A=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++k;continue}if(_[S]!=null){if(++k,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(C=0;C<1024;++C)if(_.indexOf(_[S]+"_"+C)==-1){_[S]+="_"+C;break}}}}var b=Qt(c["!ref"]),D=[],B=[],G=[];for(S=0;S<=b.e.c-b.s.c;++S){var F="",W="",U=0,ae=[];for(C=0;C<T.length;++C)T[C][S]!=null&&ae.push(T[C][S]);if(ae.length==0||_[S]==null){D[S]="?";continue}for(C=0;C<ae.length;++C){switch(typeof ae[C]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=ae[C]instanceof Date?"D":"C";break;default:W="C"}U=Math.max(U,String(ae[C]).length),F=F&&F!=W?"C":W}U>250&&(U=250),W=((E[S]||{}).DBF||{}).type,W=="C"&&E[S].DBF.len>U&&(U=E[S].DBF.len),F=="B"&&W=="N"&&(F="N",G[S]=E[S].DBF.dec,U=E[S].DBF.len),B[S]=F=="C"||W=="N"?U:s[F]||0,A+=B[S],D[S]=F}var z=g.next(32);for(z.write_shift(4,318902576),z.write_shift(4,T.length),z.write_shift(2,296+32*k),z.write_shift(2,A),S=0;S<4;++S)z.write_shift(4,0);for(z.write_shift(4,0|(+e[z2]||3)<<8),S=0,C=0;S<_.length;++S)if(_[S]!=null){var ee=g.next(32),Ee=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,Ee,"sbcs"),ee.write_shift(1,D[S]=="?"?"C":D[S],"sbcs"),ee.write_shift(4,C),ee.write_shift(1,B[S]||s[D[S]]||0),ee.write_shift(1,G[S]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),C+=B[S]||s[D[S]]||0}var Ae=g.next(264);for(Ae.write_shift(4,13),S=0;S<65;++S)Ae.write_shift(4,0);for(S=0;S<T.length;++S){var we=g.next(A);for(we.write_shift(1,0),C=0;C<_.length;++C)if(_[C]!=null)switch(D[C]){case"L":we.write_shift(1,T[S][C]==null?63:T[S][C]?84:70);break;case"B":we.write_shift(8,T[S][C]||0,"f");break;case"N":var ie="0";for(typeof T[S][C]=="number"&&(ie=T[S][C].toFixed(G[C]||0)),k=0;k<B[C]-ie.length;++k)we.write_shift(1,32);we.write_shift(1,ie,"sbcs");break;case"D":T[S][C]?(we.write_shift(4,("0000"+T[S][C].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(T[S][C].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+T[S][C].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var de=String(T[S][C]!=null?T[S][C]:"").slice(0,B[C]);for(we.write_shift(1,de,"sbcs"),k=0;k<B[C]-de.length;++k)we.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),l9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+wa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,T){var E=t[T];return typeof E=="number"?ow(E):E},r=function(_,T,E){var S=T.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:ow(S)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return s(Sr(_),T);case"binary":return s(_,T);case"buffer":return s(gt&&Buffer.isBuffer(_)?_.toString("binary"):Ps(_),T);case"array":return s(ks(_),T)}throw new Error("Unrecognized type "+T.type)}function s(_,T){var E=_.split(/[\n\r]+/),S=-1,C=-1,k=0,A=0,b=[],D=[],B=null,G={},F=[],W=[],U=[],ae=0,z;for(+T.codepage>=0&&ta(+T.codepage);k!==E.length;++k){ae=0;var ee=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),Ee=ee.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Ae=Ee[0],we;if(ee.length>0)switch(Ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ee[1].charAt(0)=="P"&&D.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,de=!1,re=!1,J=!1,M=-1,Q=-1;for(A=1;A<Ee.length;++A)switch(Ee[A].charAt(0)){case"A":break;case"X":C=parseInt(Ee[A].slice(1))-1,de=!0;break;case"Y":for(S=parseInt(Ee[A].slice(1))-1,de||(C=0),z=b.length;z<=S;++z)b[z]=[];break;case"K":we=Ee[A].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(ra(we))?isNaN(tl(we).getDate())||(we=Nn(we)):(we=ra(we),B!==null&&ul(B)&&(we=bd(we))),ie=!0;break;case"E":J=!0;var I=zo(Ee[A].slice(1),{r:S,c:C});b[S][C]=[b[S][C],I];break;case"S":re=!0,b[S][C]=[b[S][C],"S5S"];break;case"G":break;case"R":M=parseInt(Ee[A].slice(1))-1;break;case"C":Q=parseInt(Ee[A].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}if(ie&&(b[S][C]&&b[S][C].length==2?b[S][C][0]=we:b[S][C]=we,B=null),re){if(J)throw new Error("SYLK shared formula cannot have own formula");var X=M>-1&&b[M][Q];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");b[S][C][1]=nS(X[1],{r:S-M,c:C-Q})}break;case"F":var K=0;for(A=1;A<Ee.length;++A)switch(Ee[A].charAt(0)){case"X":C=parseInt(Ee[A].slice(1))-1,++K;break;case"Y":for(S=parseInt(Ee[A].slice(1))-1,z=b.length;z<=S;++z)b[z]=[];break;case"M":ae=parseInt(Ee[A].slice(1))/20;break;case"F":break;case"G":break;case"P":B=D[parseInt(Ee[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=Ee[A].slice(1).split(" "),z=parseInt(U[0],10);z<=parseInt(U[1],10);++z)ae=parseInt(U[2],10),W[z-1]=ae===0?{hidden:!0}:{wch:ae},nl(W[z-1]);break;case"C":C=parseInt(Ee[A].slice(1))-1,W[C]||(W[C]={});break;case"R":S=parseInt(Ee[A].slice(1))-1,F[S]||(F[S]={}),ae>0?(F[S].hpt=ae,F[S].hpx=Jc(ae)):ae===0&&(F[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}K<1&&(B=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}}return F.length>0&&(G["!rows"]=F),W.length>0&&(G["!cols"]=W),T&&T.sheetRows&&(b=b.slice(0,T.sheetRows)),[b,G]}function l(_,T){var E=a(_,T),S=E[0],C=E[1],k=dl(S,T);return wa(C).forEach(function(A){k[A]=C[A]}),k}function c(_,T){return Vi(l(_,T),T)}function d(_,T,E,S){var C="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":C+=_.v||0,_.f&&!_.F&&(C+=";E"+WB(_.f,{r:E,c:S}));break;case"b":C+=_.v?"TRUE":"FALSE";break;case"e":C+=_.w||_.v;break;case"d":C+='"'+(_.w||_.v)+'"';break;case"s":C+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function f(_,T){T.forEach(function(E,S){var C="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?C+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=fd(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=dd(E.wpx)),typeof E.wch=="number"&&(C+=Math.round(E.wch))),C.charAt(C.length-1)!=" "&&_.push(C)})}function g(_,T){T.forEach(function(E,S){var C="F;";E.hidden?C+="M0;":E.hpt?C+="M"+20*E.hpt+";":E.hpx&&(C+="M"+20*QE(E.hpx)+";"),C.length>2&&_.push(C+"R"+(S+1))})}function v(_,T){var E=["ID;PWXL;N;E"],S=[],C=Qt(_["!ref"]),k,A=Array.isArray(_),b=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&f(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var D=C.s.r;D<=C.e.r;++D)for(var B=C.s.c;B<=C.e.c;++B){var G=at({r:D,c:B});k=A?(_[D]||[])[B]:_[G],!(!k||k.v==null&&(!k.f||k.F))&&S.push(d(k,_,D,B))}return E.join(b)+b+S.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:l,from_sheet:v}}(),c9=function(){function t(s,l){switch(l.type){case"base64":return e(Sr(s),l);case"binary":return e(s,l);case"buffer":return e(gt&&Buffer.isBuffer(s)?s.toString("binary"):Ps(s),l);case"array":return e(ks(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),d=-1,f=-1,g=0,v=[];g!==c.length;++g){if(c[g].trim()==="BOT"){v[++d]=[],f=0;continue}if(!(d<0)){var _=c[g].trim().split(","),T=_[0],E=_[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){v[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?v[d][f]=!0:S==="FALSE"?v[d][f]=!1:isNaN(ra(E))?isNaN(tl(E).getDate())?v[d][f]=E:v[d][f]=Nn(E):v[d][f]=ra(E),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),v[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function n(s,l){return dl(t(s,l),l)}function r(s,l){return Vi(n(s,l),l)}var a=function(){var s=function(d,f,g,v,_){d.push(f),d.push(g+","+v),d.push('"'+_.replace(/"/g,'""')+'"')},l=function(d,f,g,v){d.push(f+","+g),d.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var f=[],g=Qt(d["!ref"]),v,_=Array.isArray(d);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,g.e.r-g.s.r+1,""),s(f,"TUPLES",0,g.e.c-g.s.c+1,""),s(f,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(f,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=at({r:T,c:E});if(v=_?(d[T]||[])[E]:d[S],!v){l(f,1,0,"");continue}switch(v.t){case"n":var C=v.w;!C&&v.v!=null&&(C=v.v),C==null?v.f&&!v.F?l(f,1,0,"="+v.f):l(f,1,0,""):l(f,0,C,"V");break;case"b":l(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=jr(v.z||st[14],nr(Nn(v.v)))),l(f,0,v.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var k=`\r
`,A=f.join(k);return A}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),u9=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(v,_){for(var T=v.split(`
`),E=-1,S=-1,C=0,k=[];C!==T.length;++C){var A=T[C].trim().split(":");if(A[0]==="cell"){var b=Qn(A[1]);if(k.length<=b.r)for(E=k.length;E<=b.r;++E)k[E]||(k[E]=[]);switch(E=b.r,S=b.c,A[2]){case"t":k[E][S]=t(A[3]);break;case"v":k[E][S]=+A[3];break;case"vtf":var D=A[A.length-1];case"vtc":switch(A[3]){case"nl":k[E][S]=!!+A[4];break;default:k[E][S]=+A[4];break}A[2]=="vtf"&&(k[E][S]=[k[E][S],D])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function r(v,_){return dl(n(v,_),_)}function a(v,_){return Vi(r(v,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var _=[],T=[],E,S="",C=fl(v["!ref"]),k=Array.isArray(v),A=C.s.r;A<=C.e.r;++A)for(var b=C.s.c;b<=C.e.c;++b)if(S=at({r:A,c:b}),E=k?(v[A]||[])[b]:v[S],!(!E||E.v==null||E.t==="z")){switch(T=["cell",S,"t"],E.t){case"s":case"str":T.push(e(E.v));break;case"n":E.f?(T[2]="vtf",T[3]="n",T[4]=E.v,T[5]=e(E.f)):(T[2]="v",T[3]=E.v);break;case"b":T[2]="vt"+(E.f?"f":"c"),T[3]="nl",T[4]=E.v?"1":"0",T[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var D=nr(Nn(E.v));T[2]="vtc",T[3]="nd",T[4]=""+D,T[5]=E.w||jr(E.z||st[14],D);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(v){return[s,l,c,l,f(v),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),Yc=function(){function t(g,v,_,T,E){E.raw?v[_][T]=g:g===""||(g==="TRUE"?v[_][T]=!0:g==="FALSE"?v[_][T]=!1:isNaN(ra(g))?isNaN(tl(g).getDate())?v[_][T]=g:v[_][T]=Nn(g):v[_][T]=ra(g))}function e(g,v){var _=v||{},T=[];if(!g||g.length===0)return T;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var C=10,k=0,A=0;A<=S;++A)k=E[A].indexOf(" "),k==-1?k=E[A].length:k++,C=Math.max(C,k);for(A=0;A<=S;++A){T[A]=[];var b=0;for(t(E[A].slice(0,C).trim(),T,A,b,_),b=1;b<=(E[A].length-C)/10+1;++b)t(E[A].slice(C+(b-1)*10,C+b*10).trim(),T,A,b,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var v={},_=!1,T=0,E=0;T<g.length;++T)(E=g.charCodeAt(T))==34?_=!_:!_&&E in n&&(v[E]=(v[E]||0)+1);E=[];for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T]);if(!E.length){v=r;for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T])}return E.sort(function(S,C){return S[0]-C[0]||r[S[1]]-r[C[1]]}),n[E.pop()[1]]||44}function s(g,v){var _=v||{},T="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var C=0,k=0,A=0,b=0,D=0,B=T.charCodeAt(0),G=!1,F=0,W=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var U=_.dateNF!=null?wO(_.dateNF):null;function ae(){var z=g.slice(b,D),ee={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)ee.t="z";else if(_.raw)ee.t="s",ee.v=z;else if(z.trim().length===0)ee.t="s",ee.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(ee.t="s",ee.v=z.slice(2,-1).replace(/""/g,'"')):KB(z)?(ee.t="n",ee.f=z.slice(1)):(ee.t="s",ee.v=z);else if(z=="TRUE")ee.t="b",ee.v=!0;else if(z=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(A=ra(z)))ee.t="n",_.cellText!==!1&&(ee.w=z),ee.v=A;else if(!isNaN(tl(z).getDate())||U&&z.match(U)){ee.z=_.dateNF||st[14];var Ee=0;U&&z.match(U)&&(z=TO(z,_.dateNF,z.match(U)||[]),Ee=1),_.cellDates?(ee.t="d",ee.v=Nn(z,Ee)):(ee.t="n",ee.v=nr(Nn(z,Ee))),_.cellText!==!1&&(ee.w=jr(ee.z,ee.v instanceof Date?nr(ee.v):ee.v)),_.cellNF||delete ee.z}else ee.t="s",ee.v=z;if(ee.t=="z"||(_.dense?(E[C]||(E[C]=[]),E[C][k]=ee):E[at({c:k,r:C})]=ee),b=D+1,W=g.charCodeAt(b),S.e.c<k&&(S.e.c=k),S.e.r<C&&(S.e.r=C),F==B)++k;else if(k=0,++C,_.sheetRows&&_.sheetRows<=C)return!0}e:for(;D<g.length;++D)switch(F=g.charCodeAt(D)){case 34:W===34&&(G=!G);break;case B:case 10:case 13:if(!G&&ae())break e;break}return D-b>0&&ae(),E["!ref"]=_t(S),E}function l(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?s(g,v):dl(e(g,v),v)}function c(g,v){var _="",T=v.type=="string"?[0,0,0,0]:zp(g,v);switch(v.type){case"base64":_=Sr(g);break;case"binary":_=g;break;case"buffer":v.codepage==65001?_=g.toString("utf8"):v.codepage&&typeof $c<"u"||(_=gt&&Buffer.isBuffer(g)?g.toString("binary"):Ps(g));break;case"array":_=ks(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+v.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=Vt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=Vt(_):v.type=="binary"&&typeof $c<"u",_.slice(0,19)=="socialcalc:version:"?u9.to_sheet(v.type=="string"?_:Vt(_),v):l(_,v)}function d(g,v){return Vi(c(g,v),v)}function f(g){for(var v=[],_=Qt(g["!ref"]),T,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var C=[],k=_.s.c;k<=_.e.c;++k){var A=at({r:S,c:k});if(T=E?(g[S]||[])[k]:g[A],!T||T.v==null){C.push("          ");continue}for(var b=(T.w||(Xa(T),T.w)||"").slice(0,10);b.length<10;)b+=" ";C.push(b+(k===0?" ":""))}v.push(C.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}();function f9(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=l9.to_workbook(t,n);return n.WTF=r,a}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return Yc.to_workbook(t,e)}}var Dc=function(){function t(I,X,K){if(I){In(I,I.l||0);for(var P=K.Enum||M;I.l<I.length;){var te=I.read_shift(2),me=P[te]||P[65535],ve=I.read_shift(2),ye=I.l+ve,_e=me.f&&me.f(I,ve,K);if(I.l=ye,X(_e,me,te))return}}}function e(I,X){switch(X.type){case"base64":return n(ea(Sr(I)),X);case"binary":return n(ea(I),X);case"buffer":case"array":return n(I,X)}throw"Unsupported type "+X.type}function n(I,X){if(!I)return I;var K=X||{},P=K.dense?[]:{},te="Sheet1",me="",ve=0,ye={},_e=[],$e=[],Z={s:{r:0,c:0},e:{r:0,c:0}},ct=K.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)K.Enum=M,t(I,function(Me,Ft,pn){switch(pn){case 0:K.vers=Me,Me>=4096&&(K.qpro=!0);break;case 6:Z=Me;break;case 204:Me&&(me=Me);break;case 222:me=Me;break;case 15:case 51:K.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:pn==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=K.dateNF||st[14],K.cellDates&&(Me[1].t="d",Me[1].v=bd(Me[1].v))),K.qpro&&Me[3]>ve&&(P["!ref"]=_t(Z),ye[te]=P,_e.push(te),P=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ve=Me[3],te=me||"Sheet"+(ve+1),me="");var sn=K.dense?(P[Me[0].r]||[])[Me[0].c]:P[at(Me[0])];if(sn){sn.t=Me[1].t,sn.v=Me[1].v,Me[1].z!=null&&(sn.z=Me[1].z),Me[1].f!=null&&(sn.f=Me[1].f);break}K.dense?(P[Me[0].r]||(P[Me[0].r]=[]),P[Me[0].r][Me[0].c]=Me[1]):P[at(Me[0])]=Me[1];break}},K);else if(I[2]==26||I[2]==14)K.Enum=Q,I[2]==14&&(K.qpro=!0,I.l=0),t(I,function(Me,Ft,pn){switch(pn){case 204:te=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>ve&&(P["!ref"]=_t(Z),ye[te]=P,_e.push(te),P=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ve=Me[3],te="Sheet"+(ve+1)),ct>0&&Me[0].r>=ct)break;K.dense?(P[Me[0].r]||(P[Me[0].r]=[]),P[Me[0].r][Me[0].c]=Me[1]):P[at(Me[0])]=Me[1],Z.e.c<Me[0].c&&(Z.e.c=Me[0].c),Z.e.r<Me[0].r&&(Z.e.r=Me[0].r);break;case 27:Me[14e3]&&($e[Me[14e3][0]]=Me[14e3][1]);break;case 1537:$e[Me[0]]=Me[1],Me[0]==ve&&(te=Me[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(P["!ref"]=_t(Z),ye[me||te]=P,_e.push(me||te),!$e.length)return{SheetNames:_e,Sheets:ye};for(var qe={},dt=[],tt=0;tt<$e.length;++tt)ye[_e[tt]]?(dt.push($e[tt]||_e[tt]),qe[$e[tt]]=ye[$e[tt]]||ye[_e[tt]]):(dt.push($e[tt]),qe[$e[tt]]={"!ref":"A1"});return{SheetNames:dt,Sheets:qe}}function r(I,X){var K=X||{};if(+K.codepage>=0&&ta(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var P=jm(),te=Qt(I["!ref"]),me=Array.isArray(I),ve=[];Xr(P,0,s(1030)),Xr(P,6,d(te));for(var ye=Math.min(te.e.r,8191),_e=te.s.r;_e<=ye;++_e)for(var $e=Ln(_e),Z=te.s.c;Z<=te.e.c;++Z){_e===te.s.r&&(ve[Z]=wn(Z));var ct=ve[Z]+$e,qe=me?(I[_e]||[])[Z]:I[ct];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?Xr(P,13,T(_e,Z,qe.v)):Xr(P,14,S(_e,Z,qe.v));else{var dt=Xa(qe);Xr(P,15,v(_e,Z,dt.slice(0,239)))}}return Xr(P,1),P.end()}function a(I,X){var K=X||{};if(+K.codepage>=0&&ta(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var P=jm();Xr(P,0,l(I));for(var te=0,me=0;te<I.SheetNames.length;++te)(I.Sheets[I.SheetNames[te]]||{})["!ref"]&&Xr(P,27,J(I.SheetNames[te],me++));var ve=0;for(te=0;te<I.SheetNames.length;++te){var ye=I.Sheets[I.SheetNames[te]];if(!(!ye||!ye["!ref"])){for(var _e=Qt(ye["!ref"]),$e=Array.isArray(ye),Z=[],ct=Math.min(_e.e.r,8191),qe=_e.s.r;qe<=ct;++qe)for(var dt=Ln(qe),tt=_e.s.c;tt<=_e.e.c;++tt){qe===_e.s.r&&(Z[tt]=wn(tt));var Me=Z[tt]+dt,Ft=$e?(ye[qe]||[])[tt]:ye[Me];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")Xr(P,23,ae(qe,tt,ve,Ft.v));else{var pn=Xa(Ft);Xr(P,22,F(qe,tt,ve,pn.slice(0,239)))}}++ve}}return Xr(P,1),P.end()}function s(I){var X=yn(2);return X.write_shift(2,I),X}function l(I){var X=yn(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var K=0,P=0,te=0,me=0;me<I.SheetNames.length;++me){var ve=I.SheetNames[me],ye=I.Sheets[ve];if(!(!ye||!ye["!ref"])){++te;var _e=fl(ye["!ref"]);K<_e.e.r&&(K=_e.e.r),P<_e.e.c&&(P=_e.e.c)}}return K>8191&&(K=8191),X.write_shift(2,K),X.write_shift(1,te),X.write_shift(1,P),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function c(I,X,K){var P={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&K.qpro?(P.s.c=I.read_shift(1),I.l++,P.s.r=I.read_shift(2),P.e.c=I.read_shift(1),I.l++,P.e.r=I.read_shift(2),P):(P.s.c=I.read_shift(2),P.s.r=I.read_shift(2),X==12&&K.qpro&&(I.l+=2),P.e.c=I.read_shift(2),P.e.r=I.read_shift(2),X==12&&K.qpro&&(I.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function d(I){var X=yn(8);return X.write_shift(2,I.s.c),X.write_shift(2,I.s.r),X.write_shift(2,I.e.c),X.write_shift(2,I.e.r),X}function f(I,X,K){var P=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(P[0].c=I.read_shift(1),P[3]=I.read_shift(1),P[0].r=I.read_shift(2),I.l+=2):(P[2]=I.read_shift(1),P[0].c=I.read_shift(2),P[0].r=I.read_shift(2)),P}function g(I,X,K){var P=I.l+X,te=f(I,X,K);if(te[1].t="s",K.vers==20768){I.l++;var me=I.read_shift(1);return te[1].v=I.read_shift(me,"utf8"),te}return K.qpro&&I.l++,te[1].v=I.read_shift(P-I.l,"cstr"),te}function v(I,X,K){var P=yn(7+K.length);P.write_shift(1,255),P.write_shift(2,X),P.write_shift(2,I),P.write_shift(1,39);for(var te=0;te<P.length;++te){var me=K.charCodeAt(te);P.write_shift(1,me>=128?95:me)}return P.write_shift(1,0),P}function _(I,X,K){var P=f(I,X,K);return P[1].v=I.read_shift(2,"i"),P}function T(I,X,K){var P=yn(7);return P.write_shift(1,255),P.write_shift(2,X),P.write_shift(2,I),P.write_shift(2,K,"i"),P}function E(I,X,K){var P=f(I,X,K);return P[1].v=I.read_shift(8,"f"),P}function S(I,X,K){var P=yn(13);return P.write_shift(1,255),P.write_shift(2,X),P.write_shift(2,I),P.write_shift(8,K,"f"),P}function C(I,X,K){var P=I.l+X,te=f(I,X,K);if(te[1].v=I.read_shift(8,"f"),K.qpro)I.l=P;else{var me=I.read_shift(2);D(I.slice(I.l,I.l+me),te),I.l+=me}return te}function k(I,X,K){var P=X&32768;return X&=-32769,X=(P?I:0)+(X>=8192?X-16384:X),(P?"":"$")+(K?wn(X):Ln(X))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(I,X){In(I,0);for(var K=[],P=0,te="",me="",ve="",ye="";I.l<I.length;){var _e=I[I.l++];switch(_e){case 0:K.push(I.read_shift(8,"f"));break;case 1:me=k(X[0].c,I.read_shift(2),!0),te=k(X[0].r,I.read_shift(2),!1),K.push(me+te);break;case 2:{var $e=k(X[0].c,I.read_shift(2),!0),Z=k(X[0].r,I.read_shift(2),!1);me=k(X[0].c,I.read_shift(2),!0),te=k(X[0].r,I.read_shift(2),!1),K.push($e+Z+":"+me+te)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(I.read_shift(2));break;case 6:{for(var ct="";_e=I[I.l++];)ct+=String.fromCharCode(_e);K.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:ye=K.pop(),ve=K.pop(),K.push(["AND","OR"][_e-20]+"("+ve+","+ye+")");break;default:if(_e<32&&b[_e])ye=K.pop(),ve=K.pop(),K.push(ve+b[_e]+ye);else if(A[_e]){if(P=A[_e][1],P==69&&(P=I[I.l++]),P>K.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+K.join("|")+"|");return}var qe=K.slice(-P);K.length-=P,K.push(A[_e][0]+"("+qe.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}K.length==1?X[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function B(I){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=I.read_shift(2),X[3]=I[I.l++],X[0].c=I[I.l++],X}function G(I,X){var K=B(I);return K[1].t="s",K[1].v=I.read_shift(X-4,"cstr"),K}function F(I,X,K,P){var te=yn(6+P.length);te.write_shift(2,I),te.write_shift(1,K),te.write_shift(1,X),te.write_shift(1,39);for(var me=0;me<P.length;++me){var ve=P.charCodeAt(me);te.write_shift(1,ve>=128?95:ve)}return te.write_shift(1,0),te}function W(I,X){var K=B(I);K[1].v=I.read_shift(2);var P=K[1].v>>1;if(K[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return K[1].v=P,K}function U(I,X){var K=B(I),P=I.read_shift(4),te=I.read_shift(4),me=I.read_shift(2);if(me==65535)return P===0&&te===3221225472?(K[1].t="e",K[1].v=15):P===0&&te===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var ve=me&32768;return me=(me&32767)-16446,K[1].v=(1-ve*2)*(te*Math.pow(2,me+32)+P*Math.pow(2,me)),K}function ae(I,X,K,P){var te=yn(14);if(te.write_shift(2,I),te.write_shift(1,K),te.write_shift(1,X),P==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var me=0,ve=0,ye=0,_e=0;return P<0&&(me=1,P=-P),ve=Math.log2(P)|0,P/=Math.pow(2,ve-31),_e=P>>>0,(_e&2147483648)==0&&(P/=2,++ve,_e=P>>>0),P-=_e,_e|=2147483648,_e>>>=0,P*=Math.pow(2,32),ye=P>>>0,te.write_shift(4,ye),te.write_shift(4,_e),ve+=16383+(me?32768:0),te.write_shift(2,ve),te}function z(I,X){var K=U(I);return I.l+=X-14,K}function ee(I,X){var K=B(I),P=I.read_shift(4);return K[1].v=P>>6,K}function Ee(I,X){var K=B(I),P=I.read_shift(8,"f");return K[1].v=P,K}function Ae(I,X){var K=Ee(I);return I.l+=X-10,K}function we(I,X){return I[I.l+X-1]==0?I.read_shift(X,"cstr"):""}function ie(I,X){var K=I[I.l++];K>X-1&&(K=X-1);for(var P="";P.length<K;)P+=String.fromCharCode(I[I.l++]);return P}function de(I,X,K){if(!(!K.qpro||X<21)){var P=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var te=I.read_shift(X-21,"cstr");return[P,te]}}function re(I,X){for(var K={},P=I.l+X;I.l<P;){var te=I.read_shift(2);if(te==14e3){for(K[te]=[0,""],K[te][0]=I.read_shift(2);I[I.l];)K[te][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return K}function J(I,X){var K=yn(5+I.length);K.write_shift(2,14e3),K.write_shift(2,X);for(var P=0;P<I.length;++P){var te=I.charCodeAt(P);K[K.l++]=te>127?95:te}return K[K.l++]=0,K}var M={0:{n:"BOF",f:hn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:Ee},40:{n:"FORMULA28",f:Ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function d9(t){var e={},n=t.match(Wn),r=0,a=!1;if(n)for(;r!=n.length;++r){var s=Ke(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=wp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var h9=function(){var t=zc("t"),e=zc("rPr");function n(s){var l=s.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Tt(l[1])},d=s.match(e);return d&&(c.s=d9(d[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),m9=function(){var e=/(\r\n|\n)/g;function n(a,s,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(s.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var s=[[],a.v,[]];return a.v?(a.s&&n(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),p9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,g9=/<(?:\w+:)?r>/,x9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Up(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Tt(Vt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Vt(t),n&&(r.h=kp(r.t))):t.match(g9)&&(r.r=Vt(t),r.t=Tt(Vt((t.replace(x9,"").match(p9)||[]).join("").replace(Wn,""))),n&&(r.h=m9(h9(r.r)))),r):{t:""}}var v9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,y9=/<(?:\w+:)?(?:si|sstItem)>/g,_9=/<\/(?:\w+:)?(?:si|sstItem)>/;function w9(t,e){var n=[],r="";if(!t)return n;var a=t.match(v9);if(a){r=a[2].replace(y9,"").split(_9);for(var s=0;s!=r.length;++s){var l=Up(r[s].trim(),e);l!=null&&(n[n.length]=l)}a=Ke(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function T9(t){return[t.read_shift(4),t.read_shift(4)]}function E9(t,e){var n=[],r=!1;return ei(t,function(s,l,c){switch(c){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function YE(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function Ya(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function S9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function C9(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=s,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function b9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(C9(t));return e}function A9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function k9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ya(t,4),e.U=Ya(t,4),e.W=Ya(t,4),e}function N9(t){var e=k9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function WE(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function JE(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function R9(t){var e=Ya(t);switch(e.Minor){case 2:return[e.Minor,M9(t)];case 3:return[e.Minor,D9()];case 4:return[e.Minor,I9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function M9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=WE(t,n),a=JE(t,t.length-t.l);return{t:"Std",h:r,v:a}}function D9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function I9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(Wn,function(s){var l=Ke(s);switch(Ca(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function F9(t,e){var n={},r=n.EncryptionVersionInfo=Ya(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=WE(t,a),e-=a,n.EncryptionVerifier=JE(t,e),n}function L9(t){var e={},n=e.EncryptionVersionInfo=Ya(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function P9(t){var e=0,n,r=YE(t),a=r.length+1,s,l,c,d,f;for(n=Ui(a),n[0]=r.length,s=1;s!=a;++s)n[s]=r[s-1];for(s=a-1;s>=0;--s)l=n[s],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var KE=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},s=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var g=l[f],v=0;v!=7;++v)g&64&&(c^=n[d]),g*=2,--d;return c};return function(l){for(var c=YE(l),d=s(c),f=c.length,g=Ui(16),v=0;v!=16;++v)g[v]=0;var _,T,E;for((f&1)===1&&(_=d>>8,g[f]=a(t[0],_),--f,_=d&255,T=c[c.length-1],g[f]=a(T,_));f>0;)--f,_=d>>8,g[f]=a(c[f],_),--f,_=d&255,g[f]=a(c[f],_);for(f=15,E=15-c.length;E>0;)_=d>>8,g[f]=a(t[E],_),--f,--E,_=d&255,g[f]=a(c[f],_),--f,--E;return g}}(),O9=function(t,e,n,r,a){a||(a=e),r||(r=KE(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=r[n],l=(l>>5|l<<3)&255,a[s]=l,++n;return[a,n,r]},U9=function(t){var e=0,n=KE(t);return function(r){var a=O9("",r,e,n);return e=a[1],a[0]}};function B9(t,e,n,r){var a={key:hn(t),verificationBytes:hn(t)};return n.password&&(a.verifier=P9(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=U9(n.password)),a}function j9(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=L9(t):r.Data=F9(t,e),r}function V9(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?j9(t,e-2,r):B9(t,n.biff>=8?e:e-2,n,r),r}var H9=function(){function t(a,s){switch(s.type){case"base64":return e(Sr(a),s);case"binary":return e(a,s);case"buffer":return e(gt&&Buffer.isBuffer(a)?a.toString("binary"):Ps(a),s);case"array":return e(ks(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var l=s||{},c=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,v){Array.isArray(c)&&(c[v]=[]);for(var _=/\\\w+\b/g,T=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var C=g.slice(T,_.lastIndex-E[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var k={v:C,t:"s"};Array.isArray(c)?c[v][S]=k:c[at({r:v,c:S})]=k}break}T=_.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=_t(f),c}function n(a,s){return Vi(t(a,s),s)}function r(a){for(var s=["{\\rtf1\\ansi"],l=Qt(a["!ref"]),c,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)s.push("\\cellx"+(g+1));for(s.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var v=at({r:f,c:g});c=d?(a[f]||[])[g]:a[v],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Xa(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function $9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Wc(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function G9(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),s=Math.min(e,n,r),l=a-s;if(l===0)return[0,0,e];var c=0,d=0,f=a+s;switch(d=l/(f>1?2-f:f),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,d,f/2]}function z9(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),s=r-a/2,l=[s,s,s],c=6*e,d;if(n!==0)switch(c|0){case 0:case 6:d=a*c,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-c),l[0]+=d,l[1]+=a;break;case 2:d=a*(c-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-c),l[1]+=d,l[2]+=a;break;case 4:d=a*(c-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-c),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function ud(t,e){if(e===0)return t;var n=G9($9(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),Wc(z9(n))}var XE=6,q9=15,Y9=1,Zn=XE;function fd(t){return Math.floor((t+Math.round(128/Zn)/256)*Zn)}function dd(t){return Math.floor((t-5)/Zn*100+.5)/100}function Gm(t){return Math.round((t*Zn+5)/Zn*256)/256}function tm(t){return Gm(dd(fd(t)))}function Bp(t){var e=Math.abs(t-tm(t)),n=Zn;if(e>.005)for(Zn=Y9;Zn<q9;++Zn)Math.abs(t-tm(t))<=e&&(e=Math.abs(t-tm(t)),n=Zn);Zn=n}function nl(t){t.width?(t.wpx=fd(t.width),t.wch=dd(t.wpx),t.MDW=Zn):t.wpx?(t.wch=dd(t.wpx),t.width=Gm(t.wch),t.MDW=Zn):typeof t.wch=="number"&&(t.width=Gm(t.wch),t.wpx=fd(t.width),t.MDW=Zn),t.customWidth&&delete t.customWidth}var W9=96,ZE=W9;function QE(t){return t*96/ZE}function Jc(t){return t*ZE/96}var J9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function K9(t,e,n,r){e.Borders=[];var a={},s=!1;(t[0].match(Wn)||[]).forEach(function(l){var c=Ke(l);switch(Ca(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=zt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=zt(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function X9(t,e,n,r){e.Fills=[];var a={},s=!1;(t[0].match(Wn)||[]).forEach(function(l){var c=Ke(l);switch(Ca(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function Z9(t,e,n,r){e.Fonts=[];var a={},s=!1;(t[0].match(Wn)||[]).forEach(function(l){var c=Ke(l);switch(Ca(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Vt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?zt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?zt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?zt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?zt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?zt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?zt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?zt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=wp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=zt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=vs[a.color.index];a.color.index==81&&(d=vs[1]),d||(d=vs[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=ud(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Q9(t,e,n){e.NumberFmt=[];for(var r=wa(st),a=0;a<r.length;++a)e.NumberFmt[r[a]]=st[r[a]];var s=t[0].match(Wn);if(s)for(a=0;a<s.length;++a){var l=Ke(s[a]);switch(Ca(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Tt(Vt(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}xs(c,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Lf=["numFmtId","fillId","fontId","borderId","xfId"],Pf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function eB(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(Wn)||[]).forEach(function(s){var l=Ke(s),c=0;switch(Ca(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<Lf.length;++c)r[Lf[c]]&&(r[Lf[c]]=parseInt(r[Lf[c]],10));for(c=0;c<Pf.length;++c)r[Pf[c]]&&(r[Pf[c]]=zt(r[Pf[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=zt(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var tB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&Q9(v,g,f),(v=c.match(a))&&Z9(v,g,d,f),(v=c.match(r))&&X9(v,g,d,f),(v=c.match(s))&&K9(v,g,d,f),(v=c.match(n))&&eB(v,g,f),g}}();function nB(t,e){var n=t.read_shift(2),r=qn(t);return[n,r]}function rB(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=hU(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var s=t.read_shift(2);switch(s===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=dU(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=qn(t),r}var aB=Yn;function iB(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}var sB=Yn;function oB(t,e,n){var r={};r.NumberFmt=[];for(var a in st)r.NumberFmt[a]=st[a];r.CellXf=[],r.Fonts=[];var s=[],l=!1;return ei(t,function(d,f,g){switch(g){case 44:r.NumberFmt[d[0]]=d[1],xs(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=ud(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(g),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(g);else if(f.T<0)s.pop();else if(!l||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var lB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function cB(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(Wn)||[]).forEach(function(a){var s=Ke(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[lB.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function uB(){}function fB(){}var dB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,hB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function pB(t,e,n){e.themeElements={};var r;[["clrScheme",dB,cB],["fontScheme",hB,uB],["fmtScheme",mB,fB]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var gB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eS(t,e){(!t||t.length===0)&&(t=xB());var n,r={};if(!(n=t.match(gB)))throw new Error("themeElements not found in theme");return pB(n[0],r,e),r.raw=t,r}function xB(t,e){var n=[fE];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function vB(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var s=t.slice(t.l);t.l=r;var l;try{l=uE(s,{type:"array"})}catch{return}var c=Er(l,"theme/theme/theme1.xml",!0);if(c)return eS(c,n)}}function yB(t){return t.read_shift(4)}function _B(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=wB(t,4);break;case 2:e.xclrValue=jE(t);break;case 3:e.xclrValue=yB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function wB(t,e){return Yn(t,e)}function TB(t,e){return Yn(t,e)}function EB(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=_B(t);break;case 6:r[1]=TB(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function SB(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(EB(t,n-t.l));return{ixfe:r,ext:s}}function CB(t,e){e.forEach(function(n){n[0]})}function bB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:qn(t)}}function AB(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function kB(t){return t.l+=4,t.read_shift(4)!=0}function NB(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},s=[],l=!1,c=2;return ei(t,function(d,f,g){switch(g){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(v){c==1?r.Cell.push({type:r.Types[v[0]-1].name,index:v[1]}):c==0&&r.Value.push({type:r.Types[v[0]-1].name,index:v[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:s.push(g),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function RB(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,s=2,l;return t.replace(Wn,function(c){var d=Ke(c);switch(Ca(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):s==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),r}function MB(t){var e=[];if(!t)return e;var n=1;return(t.match(Wn)||[]).forEach(function(r){var a=Ke(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function DB(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=at(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function IB(t,e,n){var r=[];return ei(t,function(s,l,c){switch(c){case 63:r.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function FB(t,e,n,r){if(!t)return t;var a=r||{},s=!1;ei(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!d.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function LB(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}function qw(t,e,n,r){var a=Array.isArray(t),s;e.forEach(function(l){var c=Qn(l.ref);if(a?(t[c.r]||(t[c.r]=[]),s=t[c.r][c.c]):s=t[l.ref],!s){s={t:"z"},a?t[c.r][c.c]=s:t[l.ref]=s;var d=Qt(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=_t(d);f!==t["!ref"]&&(t["!ref"]=f)}s.c||(s.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var v=s.c.length-1;v>=0;--v){if(!n&&s.c[v].T)return;n&&!s.c[v].T&&s.c.splice(v,1)}if(n&&r){for(v=0;v<r.length;++v)if(g.a==r[v].id){g.a=r[v].name||g.a;break}}s.c.push(g)})}function PB(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=Ke(c[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=Qn(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Up(v[1])||{r:"",t:"",h:""};f.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),f.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=_.h),r.push(f)}}}}),r}function OB(t,e){var n=[],r=!1,a={},s=0;return t.replace(Wn,function(c,d){var f=Ke(c);switch(Ca(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":s=d+c.length;break;case"</text>":a.t=t.slice(s,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function UB(t,e){var n=[],r=!1;return t.replace(Wn,function(s){var l=Ke(s);switch(Ca(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),n}function BB(t){var e={};e.iauthor=t.read_shift(4);var n=Us(t);return e.rfx=n.s,e.ref=at(n.s),t.l+=16,e}var jB=qn;function VB(t,e){var n=[],r=[],a={},s=!1;return ei(t,function(c,d,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var HB="application/vnd.ms-office.vbaProject";function $B(t){var e=yt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(e,a,t.FileIndex[r].content)}}),yt.write(e)}function GB(){return{"!type":"dialog"}}function zB(){return{"!type":"dialog"}}function qB(){return{"!type":"macro"}}function YB(){return{"!type":"macro"}}var zo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,s,l){var c=!1,d=!1;s.length==0?d=!0:s.charAt(0)=="["&&(d=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,d?f+=e.r:--f,a+(c?"":"$")+wn(g)+(d?"":"$")+Ln(f)}return function(a,s){return e=s,a.replace(t,n)}}(),tS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,WB=function(){return function(e,n){return e.replace(tS,function(r,a,s,l,c,d){var f=Dp(l)-(s?0:n.c),g=Mp(d)-(c?0:n.r),v=g==0?"":c?g+1:"["+g+"]",_=f==0?"":s?f+1:"["+f+"]";return a+"R"+v+"C"+_})}}();function nS(t,e){return t.replace(tS,function(n,r,a,s,l,c){return r+(a=="$"?a+s:wn(Dp(s)+e.c))+(l=="$"?l+c:Ln(Mp(c)+e.r))})}function JB(t,e,n){var r=fl(e),a=r.s,s=Qn(n),l={r:s.r-a.r,c:s.c-a.c};return nS(t,l)}function KB(t){return t.length!=1}function Yw(t){return t.replace(/_xlfn\./g,"")}function fn(t){t.l+=1}function Bi(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function rS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return aS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),s=t.read_shift(r),l=Bi(t),c=Bi(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function aS(t){var e=Bi(t),n=Bi(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function XB(t,e,n){if(n.biff<8)return aS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),s=Bi(t),l=Bi(t);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function iS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return ZB(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Bi(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function ZB(t){var e=Bi(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function QB(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function ej(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return tj(t);var a=t.read_shift(r>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:c}}function tj(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function nj(t,e,n){var r=(t[t.l++]&96)>>5,a=rS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function rj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=rS(t,s,n);return[r,a,l]}function aj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function ij(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[r,a]}function sj(t,e,n){var r=(t[t.l++]&96)>>5,a=XB(t,e-1,n);return[r,a]}function oj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Ww(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function lj(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],s=0;s<=r;++s)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function cj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function uj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function fj(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function dj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function sS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function hj(t){return t.read_shift(2),sS(t)}function mj(t){return t.read_shift(2),sS(t)}function pj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=iS(t,0,n);return[r,a]}function gj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=ej(t,0,n);return[r,a]}function xj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var s=iS(t,0,n);return[r,a,s]}function vj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[yV[a],cS[a],r]}function yj(t,e,n){var r=t[t.l++],a=t.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:_j(t);return[a,(s[0]===0?cS:vV)[s[1]]]}function _j(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function wj(t,e,n){t.l+=n&&n.biff==2?3:4}function Tj(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Ej(t){return t.l++,Bs[t.read_shift(1)]}function Sj(t){return t.l++,t.read_shift(2)}function Cj(t){return t.l++,t.read_shift(1)!==0}function bj(t){return t.l++,$n(t)}function Aj(t,e,n){return t.l++,iu(t,e-1,n)}function kj(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=an(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=Bs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=$n(t);break;case 2:n[1]=js(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Nj(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],s=0;s!=r;++s)a.push((n.biff==12?Us:Ad)(t));return a}function Rj(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var s=0,l=[];s!=r&&(l[s]=[]);++s)for(var c=0;c!=a;++c)l[s][c]=kj(t,n.biff);return l}function Mj(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,s=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,s]}function Dj(t,e,n){if(n.biff==5)return Ij(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[r,a,s]}function Ij(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Fj(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Lj(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Pj(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function Oj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[r,a]}var Uj=Yn,Bj=Yn,jj=Yn;function ou(t,e,n){return t.l+=2,[QB(t)]}function jp(t){return t.l+=6,[]}var Vj=ou,Hj=jp,$j=jp,Gj=ou;function oS(t){return t.l+=2,[hn(t),t.read_shift(2)&1]}var zj=ou,qj=oS,Yj=jp,Wj=ou,Jj=ou,Kj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Xj(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),l=Kj[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:s}}function Zj(t){return t.l+=2,[t.read_shift(4)]}function Qj(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function eV(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function tV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function nV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function rV(t){return t.l+=4,[0,0]}var Jw={1:{n:"PtgExp",f:Tj},2:{n:"PtgTbl",f:jj},3:{n:"PtgAdd",f:fn},4:{n:"PtgSub",f:fn},5:{n:"PtgMul",f:fn},6:{n:"PtgDiv",f:fn},7:{n:"PtgPower",f:fn},8:{n:"PtgConcat",f:fn},9:{n:"PtgLt",f:fn},10:{n:"PtgLe",f:fn},11:{n:"PtgEq",f:fn},12:{n:"PtgGe",f:fn},13:{n:"PtgGt",f:fn},14:{n:"PtgNe",f:fn},15:{n:"PtgIsect",f:fn},16:{n:"PtgUnion",f:fn},17:{n:"PtgRange",f:fn},18:{n:"PtgUplus",f:fn},19:{n:"PtgUminus",f:fn},20:{n:"PtgPercent",f:fn},21:{n:"PtgParen",f:fn},22:{n:"PtgMissArg",f:fn},23:{n:"PtgStr",f:Aj},26:{n:"PtgSheet",f:Qj},27:{n:"PtgEndSheet",f:eV},28:{n:"PtgErr",f:Ej},29:{n:"PtgBool",f:Cj},30:{n:"PtgInt",f:Sj},31:{n:"PtgNum",f:bj},32:{n:"PtgArray",f:oj},33:{n:"PtgFunc",f:vj},34:{n:"PtgFuncVar",f:yj},35:{n:"PtgName",f:Mj},36:{n:"PtgRef",f:pj},37:{n:"PtgArea",f:nj},38:{n:"PtgMemArea",f:Fj},39:{n:"PtgMemErr",f:Uj},40:{n:"PtgMemNoMem",f:Bj},41:{n:"PtgMemFunc",f:Lj},42:{n:"PtgRefErr",f:Pj},43:{n:"PtgAreaErr",f:aj},44:{n:"PtgRefN",f:gj},45:{n:"PtgAreaN",f:sj},46:{n:"PtgMemAreaN",f:tV},47:{n:"PtgMemNoMemN",f:nV},57:{n:"PtgNameX",f:Dj},58:{n:"PtgRef3d",f:xj},59:{n:"PtgArea3d",f:rj},60:{n:"PtgRefErr3d",f:Oj},61:{n:"PtgAreaErr3d",f:ij},255:{}},aV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iV={1:{n:"PtgElfLel",f:oS},2:{n:"PtgElfRw",f:Wj},3:{n:"PtgElfCol",f:Vj},6:{n:"PtgElfRwV",f:Jj},7:{n:"PtgElfColV",f:Gj},10:{n:"PtgElfRadical",f:zj},11:{n:"PtgElfRadicalS",f:Yj},13:{n:"PtgElfColS",f:Hj},15:{n:"PtgElfColSV",f:$j},16:{n:"PtgElfRadicalLel",f:qj},25:{n:"PtgList",f:Xj},29:{n:"PtgSxName",f:Zj},255:{}},sV={0:{n:"PtgAttrNoop",f:rV},1:{n:"PtgAttrSemi",f:dj},2:{n:"PtgAttrIf",f:uj},4:{n:"PtgAttrChoose",f:lj},8:{n:"PtgAttrGoto",f:cj},16:{n:"PtgAttrSum",f:wj},32:{n:"PtgAttrBaxcel",f:Ww},33:{n:"PtgAttrBaxcel",f:Ww},64:{n:"PtgAttrSpace",f:hj},65:{n:"PtgAttrSpaceSemi",f:mj},128:{n:"PtgAttrIfError",f:fj},255:{}};function lu(t,e,n,r){if(r.biff<8)return Yn(t,e);for(var a=t.l+e,s=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=Rj(t,0,r),s.push(n[l][1]);break;case"PtgMemArea":n[l][2]=Nj(t,n[l][1],r),s.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),s.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&s.push(Yn(t,e)),s}function cu(t,e,n){for(var r=t.l+e,a,s,l=[];r!=t.l;)e=r-t.l,s=t[t.l],a=Jw[s]||Jw[aV[s]],(s===24||s===25)&&(a=(s===24?iV:sV)[t[t.l+1]]),!a||!a.f?Yn(t,e):l.push([a.n,a.f(t,e,n)]);return l}function oV(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],s=0;s<r.length;++s){var l=r[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var lV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function lS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Kw(t,e,n){var r=lS(t,e,n);return r=="#REF"?r:cV(r,n)}function Hn(t,e,n,r,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},c=[],d,f,g,v=0,_=0,T,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,C="",k=0,A=t[0].length;k<A;++k){var b=t[0][k];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:C=Zt(" ",t[0][S][1][1]);break;case 1:C=Zt("\r",t[0][S][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}f=f+C,S=-1}c.push(f+lV[b[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=kc(b[1][1],l,a),c.push(Nc(g,s));break;case"PtgRefN":g=n?kc(b[1][1],n,a):b[1][1],c.push(Nc(g,s));break;case"PtgRef3d":v=b[1][1],g=kc(b[1][2],l,a),E=Kw(r,v,a),c.push(E+"!"+Nc(g,s));break;case"PtgFunc":case"PtgFuncVar":var D=b[1][0],B=b[1][1];D||(D=0),D&=127;var G=D==0?[]:c.slice(-D);c.length-=D,B==="User"&&(B=G.shift()),c.push(B+"("+G.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":T=Rw(b[1][1],n?{s:n}:l,a),c.push(Qh(T,a));break;case"PtgArea":T=Rw(b[1][1],l,a),c.push(Qh(T,a));break;case"PtgArea3d":v=b[1][1],T=b[1][2],E=Kw(r,v,a),c.push(E+"!"+Qh(T,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],W=F?F.Name:"SH33TJSNAME"+String(_);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),c.push(W);break;case"PtgNameX":var U=b[1][1];_=b[1][2];var ae;if(a.biff<=5)U<0&&(U=-U),r[U]&&(ae=r[U][_]);else{var z="";if(((r[U]||[])[0]||[])[0]==14849||(((r[U]||[])[0]||[])[0]==1025?r[U][_]&&r[U][_].itab>0&&(z=r.SheetNames[r[U][_].itab-1]+"!"):z=r.SheetNames[_-1]+"!"),r[U]&&r[U][_])z+=r[U][_].Name;else if(r[0]&&r[0][_])z+=r[0][_].Name;else{var ee=(lS(r,U,a)||"").split(";;");ee[_-1]?z=ee[_-1]:z+="SH33TJSERRX"}c.push(z);break}ae||(ae={Name:"SH33TJSERRY"}),c.push(ae.Name);break;case"PtgParen":var Ee="(",Ae=")";if(S>=0){switch(C="",t[0][S][1][0]){case 2:Ee=Zt(" ",t[0][S][1][1])+Ee;break;case 3:Ee=Zt("\r",t[0][S][1][1])+Ee;break;case 4:Ae=Zt(" ",t[0][S][1][1])+Ae;break;case 5:Ae=Zt("\r",t[0][S][1][1])+Ae;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(Ee+c.pop()+Ae);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:b[1][1],r:b[1][0]};var we={c:n.c,r:n.r};if(r.sharedf[at(g)]){var ie=r.sharedf[at(g)];c.push(Hn(ie,l,we,r,a))}else{var de=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(Hn(f[1],l,we,r,a)),de=!0;break}de||c.push(b[1])}break;case"PtgArray":c.push("{"+oV(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&re.indexOf(t[0][k][0])==-1){b=t[0][S];var J=!0;switch(b[1][0]){case 4:J=!1;case 0:C=Zt(" ",b[1][1]);break;case 5:J=!1;case 1:C=Zt("\r",b[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((J?C:"")+c.pop()+(J?"":C)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function uV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],Yn(t,e-2)];var c=cu(t,l,n);return e!==l+a&&(s=lu(t,e-l-a,c,n)),t.l=r,[c,s]}function fV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],Yn(t,e-2)];var c=cu(t,l,n);return e!==l+a&&(s=lu(t,e-l-a,c,n)),t.l=r,[c,s]}function dV(t,e,n,r){var a=t.l+e,s=cu(t,r,n),l;return a!==t.l&&(l=lu(t,a-t.l,s,n)),[s,l]}function hV(t,e,n){var r=t.l+e,a,s=t.read_shift(2),l=cu(t,s,n);return s==65535?[[],Yn(t,e-2)]:(e!==s+2&&(a=lu(t,r-s-2,l,n)),[l,a])}function mV(t){var e;if(Ga(t,t.l+6)!==65535)return[$n(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function nm(t,e,n){var r=t.l+e,a=ba(t);n.biff==2&&++t.l;var s=mV(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=fV(t,r-t.l,n);return{cell:a,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function kd(t,e,n){var r=t.read_shift(4),a=cu(t,r,n),s=t.read_shift(4),l=s>0?lu(t,s,a,n):null;return[a,l]}var pV=kd,Nd=kd,gV=kd,xV=kd,vV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},yV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Xw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function rm(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ic={},qo={};function Fc(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function uS(t,e,n,r,a,s){try{r.cellNF&&(t.z=st[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Nn(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(st[e]==null&&xs(_O[e]||"General",e),t.t==="e")t.w=t.w||Bs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v);else if(t.t==="d"){var l=nr(t.v);(l|0)===l?t.w=l.toString(10):t.w=Gc(l)}else{if(t.v===void 0)return"";t.w=As(t.v,qo)}else t.t==="d"?t.w=jr(e,nr(t.v),qo):t.w=jr(e,t.v,qo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=s.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ud(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ud(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&s.Fills)throw c}}}function _V(t,e){var n=Qt(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=_t(n))}var wV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,EV=/<(?:\w:)?hyperlink [^>]*>/mg,SV=/"(\w*:\w*)"/,CV=/<(?:\w:)?col\b[^>]*[\/]?>/g,bV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,AV=/<(?:\w:)?pageMargins[^>]*\/>/g,fS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,NV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function RV(t,e,n,r,a,s,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",g="",v=t.match(TV);v?(f=t.slice(0,v.index),g=t.slice(v.index+v[0].length)):f=g=t;var _=f.match(fS);_?Vp(_[0],c,a,n):(_=f.match(kV))&&MV(_[0],_[1]||"",c,a,n);var T=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var E=f.slice(T,T+50).match(SV);E&&_V(c,E[1])}var S=f.match(NV);S&&S[1]&&OV(S[1],a);var C=[];if(e.cellStyles){var k=f.match(CV);k&&FV(C,k)}v&&UV(v[1],c,e,d,s,l);var A=g.match(bV);A&&(c["!autofilter"]=LV(A[0]));var b=[],D=g.match(wV);if(D)for(T=0;T!=D.length;++T)b[T]=Qt(D[T].slice(D[T].indexOf('"')+1));var B=g.match(EV);B&&DV(c,B,r);var G=g.match(AV);if(G&&(c["!margins"]=IV(Ke(G[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=_t(d)),e.sheetRows>0&&c["!ref"]){var F=Qt(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>d.e.r&&(F.e.r=d.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>d.e.c&&(F.e.c=d.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_t(F))}return C.length>0&&(c["!cols"]=C),b.length>0&&(c["!merges"]=b),c}function Vp(t,e,n,r){var a=Ke(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Tt(Vt(a.codeName)))}function MV(t,e,n,r,a){Vp(t.slice(0,t.indexOf(">")),n,r,a)}function DV(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var s=Ke(Vt(e[a]),!0);if(!s.ref)return;var l=((n||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Tt(s.location))):(s.Target="#"+Tt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Qt(s.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var g=at({c:f,r:d});r?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=s):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=s)}}}function IV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function FV(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=Ke(e[r],!0);a.hidden&&(a.hidden=zt(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,Bp(a.width)),nl(a);s<=l;)t[s++]=Fn(a)}}function LV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var PV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function OV(t,e){e.Views||(e.Views=[{}]),(t.match(PV)||[]).forEach(function(n,r){var a=Ke(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),zt(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var UV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=zc("v"),l=zc("f");return function(d,f,g,v,_,T){for(var E=0,S="",C=[],k=[],A=0,b=0,D=0,B="",G,F,W=0,U=0,ae,z,ee=0,Ee=0,Ae=Array.isArray(T.CellXf),we,ie=[],de=[],re=Array.isArray(f),J=[],M={},Q=!1,I=!!g.sheetStubs,X=d.split(e),K=0,P=X.length;K!=P;++K){S=X[K].trim();var te=S.length;if(te!==0){var me=0;e:for(E=0;E<te;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(F=Ke(S.slice(me,E),!0),W=F.r!=null?parseInt(F.r,10):W+1,U=-1,g.sheetRows&&g.sheetRows<W)continue;M={},Q=!1,F.ht&&(Q=!0,M.hpt=parseFloat(F.ht),M.hpx=Jc(M.hpt)),F.hidden=="1"&&(Q=!0,M.hidden=!0),F.outlineLevel!=null&&(Q=!0,M.level=+F.outlineLevel),Q&&(J[W-1]=M)}break;case"<":me=E;break}if(me>=E)break;if(F=Ke(S.slice(me,E),!0),W=F.r!=null?parseInt(F.r,10):W+1,U=-1,!(g.sheetRows&&g.sheetRows<W)){v.s.r>W-1&&(v.s.r=W-1),v.e.r<W-1&&(v.e.r=W-1),g&&g.cellStyles&&(M={},Q=!1,F.ht&&(Q=!0,M.hpt=parseFloat(F.ht),M.hpx=Jc(M.hpt)),F.hidden=="1"&&(Q=!0,M.hidden=!0),F.outlineLevel!=null&&(Q=!0,M.level=+F.outlineLevel),Q&&(J[W-1]=M)),C=S.slice(E).split(t);for(var ve=0;ve!=C.length&&C[ve].trim().charAt(0)=="<";++ve);for(C=C.slice(ve),E=0;E!=C.length;++E)if(S=C[E].trim(),S.length!==0){if(k=S.match(n),A=E,b=0,D=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(A=0,B=k[1],b=0;b!=B.length&&!((D=B.charCodeAt(b)-64)<1||D>26);++b)A=26*A+D;--A,U=A}else++U;for(b=0;b!=S.length&&S.charCodeAt(b)!==62;++b);if(++b,F=Ke(S.slice(0,b),!0),F.r||(F.r=at({r:W-1,c:U})),B=S.slice(b),G={t:""},(k=B.match(s))!=null&&k[1]!==""&&(G.v=Tt(k[1])),g.cellFormula){if((k=B.match(l))!=null&&k[1]!==""){if(G.f=Tt(Vt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(G.f=Yw(G.f)),k[0].indexOf('t="array"')>-1)G.F=(B.match(a)||[])[1],G.F.indexOf(":")>-1&&ie.push([Qt(G.F),G.F]);else if(k[0].indexOf('t="shared"')>-1){z=Ke(k[0]);var ye=Tt(Vt(k[1]));g.xlfn||(ye=Yw(ye)),de[parseInt(z.si,10)]=[z,ye,F.r]}}else(k=B.match(/<f[^>]*\/>/))&&(z=Ke(k[0]),de[z.si]&&(G.f=JB(de[z.si][1],de[z.si][2],F.r)));var _e=Qn(F.r);for(b=0;b<ie.length;++b)_e.r>=ie[b][0].s.r&&_e.r<=ie[b][0].e.r&&_e.c>=ie[b][0].s.c&&_e.c<=ie[b][0].e.c&&(G.F=ie[b][1])}if(F.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(I)G.t="z";else continue;else G.t=F.t||"n";switch(v.s.c>U&&(v.s.c=U),v.e.c<U&&(v.e.c=U),G.t){case"n":if(G.v==""||G.v==null){if(!I)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!I)continue;G.t="z"}else ae=Ic[parseInt(G.v,10)],G.v=ae.t,G.r=ae.r,g.cellHTML&&(G.h=ae.h);break;case"str":G.t="s",G.v=G.v!=null?Vt(G.v):"",g.cellHTML&&(G.h=kp(G.v));break;case"inlineStr":k=B.match(r),G.t="s",k!=null&&(ae=Up(k[1]))?(G.v=ae.t,g.cellHTML&&(G.h=ae.h)):G.v="";break;case"b":G.v=zt(G.v);break;case"d":g.cellDates?G.v=Nn(G.v,1):(G.v=nr(Nn(G.v,1)),G.t="n");break;case"e":(!g||g.cellText!==!1)&&(G.w=G.v),G.v=DE[G.v];break}if(ee=Ee=0,we=null,Ae&&F.s!==void 0&&(we=T.CellXf[F.s],we!=null&&(we.numFmtId!=null&&(ee=we.numFmtId),g.cellStyles&&we.fillId!=null&&(Ee=we.fillId))),uS(G,ee,Ee,g,_,T),g.cellDates&&Ae&&G.t=="n"&&ul(st[ee])&&(G.t="d",G.v=bd(G.v)),F.cm&&g.xlmeta){var $e=(g.xlmeta.Cell||[])[+F.cm-1];$e&&$e.type=="XLDAPR"&&(G.D=!0)}if(re){var Z=Qn(F.r);f[Z.r]||(f[Z.r]=[]),f[Z.r][Z.c]=G}else f[F.r]=G}}}}J.length>0&&(f["!rows"]=J)}}();function BV(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=a/20),n}var jV=Us;function VV(){}function HV(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=uU(t),n}function $V(t){var e=Hr(t);return[e]}function GV(t){var e=Os(t);return[e]}function zV(t){var e=Hr(t),n=t.read_shift(1);return[e,n,"b"]}function qV(t){var e=Os(t),n=t.read_shift(1);return[e,n,"b"]}function YV(t){var e=Hr(t),n=t.read_shift(1);return[e,n,"e"]}function WV(t){var e=Os(t),n=t.read_shift(1);return[e,n,"e"]}function JV(t){var e=Hr(t),n=t.read_shift(4);return[e,n,"s"]}function KV(t){var e=Os(t),n=t.read_shift(4);return[e,n,"s"]}function XV(t){var e=Hr(t),n=$n(t);return[e,n,"n"]}function dS(t){var e=Os(t),n=$n(t);return[e,n,"n"]}function ZV(t){var e=Hr(t),n=Lp(t);return[e,n,"n"]}function QV(t){var e=Os(t),n=Lp(t);return[e,n,"n"]}function eH(t){var e=Hr(t),n=Ip(t);return[e,n,"is"]}function tH(t){var e=Hr(t),n=qn(t);return[e,n,"str"]}function nH(t){var e=Os(t),n=qn(t);return[e,n,"str"]}function rH(t,e,n){var r=t.l+e,a=Hr(t);a.r=n["!row"];var s=t.read_shift(1),l=[a,s,"b"];if(n.cellFormula){t.l+=2;var c=Nd(t,r-t.l,n);l[3]=Hn(c,null,a,n.supbooks,n)}else t.l=r;return l}function aH(t,e,n){var r=t.l+e,a=Hr(t);a.r=n["!row"];var s=t.read_shift(1),l=[a,s,"e"];if(n.cellFormula){t.l+=2;var c=Nd(t,r-t.l,n);l[3]=Hn(c,null,a,n.supbooks,n)}else t.l=r;return l}function iH(t,e,n){var r=t.l+e,a=Hr(t);a.r=n["!row"];var s=$n(t),l=[a,s,"n"];if(n.cellFormula){t.l+=2;var c=Nd(t,r-t.l,n);l[3]=Hn(c,null,a,n.supbooks,n)}else t.l=r;return l}function sH(t,e,n){var r=t.l+e,a=Hr(t);a.r=n["!row"];var s=qn(t),l=[a,s,"str"];if(n.cellFormula){t.l+=2;var c=Nd(t,r-t.l,n);l[3]=Hn(c,null,a,n.supbooks,n)}else t.l=r;return l}var oH=Us;function lH(t,e){var n=t.l+e,r=Us(t),a=Fp(t),s=qn(t),l=qn(t),c=qn(t);t.l=n;var d={rfx:r,relId:a,loc:s,display:c};return l&&(d.Tooltip=l),d}function cH(){}function uH(t,e,n){var r=t.l+e,a=NE(t),s=t.read_shift(1),l=[a];if(l[2]=s,n.cellFormula){var c=pV(t,r-t.l,n);l[1]=c}else t.l=r;return l}function fH(t,e,n){var r=t.l+e,a=Us(t),s=[a];if(n.cellFormula){var l=xV(t,r-t.l,n);s[1]=l,t.l=r}else t.l=r;return s}var dH=["left","right","top","bottom","header","footer"];function hH(t){var e={};return dH.forEach(function(n){e[n]=$n(t)}),e}function mH(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function pH(){}function gH(){}function xH(t,e,n,r,a,s,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var d=c.dense?[]:{},f,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,T,E,S,C,k,A,b,D,B,G=[];c.biff=12,c["!row"]=0;var F=0,W=!1,U=[],ae={},z=c.supbooks||a.supbooks||[[]];if(z.sharedf=ae,z.arrayf=U,z.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!c.supbooks&&(c.supbooks=z,a.Names))for(var ee=0;ee<a.Names.length;++ee)z[0][ee+1]=a.Names[ee];var Ee=[],Ae=[],we=!1;hd[16]={n:"BrtShortReal",f:dS};var ie;if(ei(t,function(J,M,Q){if(!_)switch(Q){case 148:f=J;break;case 0:T=J,c.sheetRows&&c.sheetRows<=T.r&&(_=!0),D=Ln(C=T.r),c["!row"]=T.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=Jc(J.hpt)),Ae[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:J[2]},J[2]){case"n":E.v=J[1];break;case"s":b=Ic[J[1]],E.v=b.t,E.r=b.r;break;case"b":E.v=!!J[1];break;case"e":E.v=J[1],c.cellText!==!1&&(E.w=Bs[E.v]);break;case"str":E.t="s",E.v=J[1];break;case"is":E.t="s",E.v=J[1].t;break}if((S=l.CellXf[J[0].iStyleRef])&&uS(E,S.numFmtId,null,c,s,l),k=J[0].c==-1?k+1:J[0].c,c.dense?(d[C]||(d[C]=[]),d[C][k]=E):d[wn(k)+D]=E,c.cellFormula){for(W=!1,F=0;F<U.length;++F){var I=U[F];T.r>=I[0].s.r&&T.r<=I[0].e.r&&k>=I[0].s.c&&k<=I[0].e.c&&(E.F=_t(I[0]),W=!0)}!W&&J.length>3&&(E.f=J[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),c.cellDates&&S&&E.t=="n"&&ul(st[S.numFmtId])){var X=ps(E.v);X&&(E.t="d",E.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;E={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,c.dense?(d[C]||(d[C]=[]),d[C][k]=E):d[wn(k)+D]=E,g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 176:G.push(J);break;case 49:ie=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var K=r["!id"][J.relId];for(K?(J.Target=K.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=K):J.relId==""&&(J.Target="#"+J.loc),C=J.rfx.s.r;C<=J.rfx.e.r;++C)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)c.dense?(d[C]||(d[C]=[]),d[C][k]||(d[C][k]={t:"z",v:void 0}),d[C][k].l=J):(A=at({c:k,r:C}),d[A]||(d[A]={t:"z",v:void 0}),d[A].l=J);break;case 426:if(!c.cellFormula)break;U.push(J),B=c.dense?d[C][k]:d[wn(k)+D],B.f=Hn(J[1],g,{r:T.r,c:k},z,c),B.F=_t(J[0]);break;case 427:if(!c.cellFormula)break;ae[at(J[0].s)]=J[1],B=c.dense?d[C][k]:d[wn(k)+D],B.f=Hn(J[1],g,{r:T.r,c:k},z,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)Ee[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},we||(we=!0,Bp(J.w/256)),nl(Ee[J.e+1]);break;case 161:d["!autofilter"]={ref:_t(J)};break;case 476:d["!margins"]=J;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),J.name&&(a.Sheets[n].CodeName=J.name),(J.above||J.left)&&(d["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!M.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(g.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=_t(f||g)),c.sheetRows&&d["!ref"]){var de=Qt(d["!ref"]);c.sheetRows<=+de.e.r&&(de.e.r=c.sheetRows-1,de.e.r>g.e.r&&(de.e.r=g.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>g.e.c&&(de.e.c=g.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),d["!fullref"]=d["!ref"],d["!ref"]=_t(de))}return G.length>0&&(d["!merges"]=G),Ee.length>0&&(d["!cols"]=Ee),Ae.length>0&&(d["!rows"]=Ae),d}function vH(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=Tt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[e,a,r]}function yH(t,e,n,r,a,s){var l=s||{"!type":"chart"};if(!t)return s;var c=0,d=0,f="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=vH(v);g.s.r=g.s.c=0,g.e.c=c,f=wn(c),_[0].forEach(function(T,E){l[f+Ln(E)]={t:"n",v:T,z:_[1]},d=E}),g.e.r<d&&(g.e.r=d),++c}),c>0&&(l["!ref"]=_t(g)),l}function _H(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(fS);return c&&Vp(c[0],s,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function wH(t,e){t.l+=10;var n=qn(t);return{name:n}}function TH(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ei(t,function(d,f,g){switch(g){case 550:s["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var hS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SH=[],CH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Zw(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var s=e[a];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=zt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function Qw(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=zt(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function mS(t){Qw(t.WBProps,hS),Qw(t.CalcPr,CH),Zw(t.WBView,EH),Zw(t.Sheets,SH),qo.date1904=zt(t.WBProps.date1904)}var bH="][*?/\\".split("");function AH(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return bH.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var kH=/<\w+:workbook/;function NH(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},l=0;if(t.replace(Wn,function(d,f){var g=Ke(d);switch(Ca(g[0])){case"<?xml":break;case"<workbook":d.match(kH)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hS.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":n.WBProps[v[0]]=zt(g[v[0]]);break;case"int":n.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:n.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(n.WBProps.CodeName=Vt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Tt(Vt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Vt(g.name),g.comment&&(s.Comment=g.comment),g.localSheetId&&(s.Sheet=+g.localSheetId),zt(g.hidden||"0")&&(s.Hidden=!0),l=f+d.length;break;case"</definedName>":s.Ref=Tt(Vt(t.slice(l,f))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),YO.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return mS(n),n}function RH(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=Vm(t),n.name=qn(t),n}function MH(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?qn(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function DH(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function IH(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=fU(t),l=gV(t,0,n),c=Fp(t);t.l=r;var d={Name:s,Ptg:l};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function FH(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],hd[16]={n:"BrtFRTArchID$",f:DH},ei(t,function(d,f,g){switch(g){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=Hn(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,s.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),mS(n),n.Names=s,n.supbooks=l,n}function LH(t,e,n){return e.slice(-4)===".bin"?FH(t,n):NH(t,n)}function PH(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?xH(t,r,n,a,s,l,c):RV(t,r,n,a,s,l,c)}function OH(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?TH(t,r,n,a,s):_H(t,r,n,a,s)}function UH(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?qB():YB()}function BH(t,e,n,r,a,s,l,c){return e.slice(-4)===".bin"?GB():zB()}function jH(t,e,n,r){return e.slice(-4)===".bin"?oB(t,n,r):tB(t,n,r)}function VH(t,e,n){return eS(t,n)}function HH(t,e,n){return e.slice(-4)===".bin"?E9(t,n):w9(t,n)}function $H(t,e,n){return e.slice(-4)===".bin"?VB(t,n):PB(t,n)}function GH(t,e,n){return e.slice(-4)===".bin"?IB(t):MB(t)}function zH(t,e,n,r){return n.slice(-4)===".bin"?FB(t,e,n,r):void 0}function qH(t,e,n){return e.slice(-4)===".bin"?NB(t,e,n):RB(t,e,n)}var pS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Kr(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(pS),s,l,c,d;if(a)for(d=0;d!=a.length;++d)s=a[d].match(gS),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}function YH(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(pS),a,s,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(gS),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),n[l]=a[2].slice(1,a[2].length-1));return n}var Lc;function WH(t,e){var n=Lc[t]||Tt(t);return n==="General"?As(e):jr(n,e)}function JH(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=zt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Nn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[Tt(e)]=a}function KH(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Bs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v):t.w=As(t.v):t.w=WH(e||"General",t.v)}catch(s){if(n.WTF)throw s}try{var r=Lc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&ul(r)){var a=ps(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(n.WTF)throw s}}}function XH(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=J9[r.Pattern]||r.Pattern)}t[e.ID]=e}function ZH(t,e,n,r,a,s,l,c,d,f){var g="General",v=r.StyleID,_={};f=f||{};var T=[],E=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);s[v]!==void 0&&(s[v].nf&&(g=s[v].nf),s[v].Interior&&T.push(s[v].Interior),!!s[v].Parent);)v=s[v].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=zt(t);break;case"String":r.t="s",r.r=ww(Tt(t)),r.v=t.indexOf("<")>-1?Tt(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Nn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Tt(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=DE[t],f.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=ww(e||t));break}if(KH(r,g,f),f.cellFormula!==!1)if(r.Formula){var S=Tt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=zo(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=zo("RC:RC",a):r.ArrayRange&&(r.F=zo(r.ArrayRange,a),d.push([Qt(r.F),r.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(r.F=d[E][1]);f.cellStyles&&(T.forEach(function(C){!_.patternType&&C.patternType&&(_.patternType=C.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function QH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function am(t,e){var n=e||{};aE();var r=vc(Np(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Vt(r));var a=r.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Fn(n);return l.type="string",Yc.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){a.indexOf("<"+Ft)>=0&&(s=!0)}),s)return l$(r,n);Lc={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,g={},v=[],_=n.dense?[]:{},T="",E={},S={},C=Kr('<Data ss:Type="String">'),k=0,A=0,b=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},G={},F="",W=0,U=[],ae={},z={},ee=0,Ee=[],Ae=[],we={},ie=[],de,re=!1,J=[],M=[],Q={},I=0,X=0,K={Sheets:[],WBProps:{date1904:!1}},P={};qc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";c=qc.exec(r);)switch(c[3]=(te=c[3]).toLowerCase()){case"data":if(te=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?ZH(r.slice(k,c.index),F,C,d[d.length-1][0]=="comment"?we:E,{c:A,r:b},B,ie[A],S,J,n):(F="",C=Kr(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ae.length>0&&(E.c=Ae),(!n.sheetRows||n.sheetRows>b)&&E.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][A]=E):_[wn(A)+Ln(b)]=E),E.HRef&&(E.l={Target:Tt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(I=A+(parseInt(E.MergeAcross,10)|0),X=b+(parseInt(E.MergeDown,10)|0),U.push({s:{c:A,r:b},e:{c:I,r:X}})),!n.sheetStubs)E.MergeAcross?A=I+1:++A;else if(E.MergeAcross||E.MergeDown){for(var me=A;me<=I;++me)for(var ve=b;ve<=X;++ve)(me>A||ve>b)&&(n.dense?(_[ve]||(_[ve]=[]),_[ve][me]={t:"z"}):_[wn(me)+Ln(ve)]={t:"z"});A=I+1}else++A;else E=YH(c[0]),E.Index&&(A=+E.Index-1),A<D.s.c&&(D.s.c=A),A>D.e.c&&(D.e.c=A),c[0].slice(-2)==="/>"&&++A,Ae=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<D.s.r&&(D.s.r=b),b>D.e.r&&(D.e.r=b),c[0].slice(-2)==="/>"&&(S=Kr(c[0]),S.Index&&(b=+S.Index-1)),A=0,++b):(S=Kr(c[0]),S.Index&&(b=+S.Index-1),Q={},(S.AutoFitHeight=="0"||S.Height)&&(Q.hpx=parseInt(S.Height,10),Q.hpt=QE(Q.hpx),M[b]=Q),S.Hidden=="1"&&(Q.hidden=!0,M[b]=Q));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));v.push(T),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(_["!ref"]=_t(D),n.sheetRows&&n.sheetRows<=D.e.r&&(_["!fullref"]=_["!ref"],D.e.r=n.sheetRows-1,_["!ref"]=_t(D))),U.length&&(_["!merges"]=U),ie.length>0&&(_["!cols"]=ie),M.length>0&&(_["!rows"]=M),g[T]=_}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=A=0,d.push([c[3],!1]),f=Kr(c[0]),T=Tt(f.Name),_=n.dense?[]:{},U=[],J=[],M=[],P={name:T,Hidden:0},K.Sheets.push(P);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),ie=[],re=!1}break;case"style":c[1]==="/"?XH(B,G,n):G=Kr(c[0]);break;case"numberformat":G.nf=Tt(Kr(c[0]).Format||"General"),Lc[G.nf]&&(G.nf=Lc[G.nf]);for(var ye=0;ye!=392&&st[ye]!=G.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(st[ye]==null){xs(G.nf,ye);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(de=Kr(c[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!re&&de.wpx>10){re=!0,Zn=XE;for(var _e=0;_e<ie.length;++_e)ie[_e]&&nl(ie[_e])}re&&nl(de),ie[de.Index-1||ie.length]=de;for(var $e=0;$e<+de.Span;++$e)ie[ie.length]=Fn(de);break;case"namedrange":if(c[1]==="/")break;K.Names||(K.Names=[]);var Z=Ke(c[0]),ct={Name:Z.Name,Ref:zo(Z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(ct.Sheet=K.Sheets.length-1),K.Names.push(ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(W,c.index):W=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;G.Interior=Kr(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?PU(ae,te,r.slice(ee,c.index)):ee=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));QH(we),Ae.push(we)}else d.push([c[3],!1]),f=Kr(c[0]),we={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var qe=Kr(c[0]);_["!autofilter"]={ref:zo(qe.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return iT(r,n);var dt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(ee,c.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else ee=c.index+c[0].length;break;case"header":_["!margins"]||Fc(_["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(_["!margins"].header=+Ke(c[0]).Margin);break;case"footer":_["!margins"]||Fc(_["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(_["!margins"].footer=+Ke(c[0]).Margin);break;case"pagemargins":var tt=Ke(c[0]);_["!margins"]||Fc(_["!margins"]={},"xlml"),isNaN(+tt.Top)||(_["!margins"].top=+tt.Top),isNaN(+tt.Left)||(_["!margins"].left=+tt.Left),isNaN(+tt.Right)||(_["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(_["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?JH(z,te,Ee,r.slice(ee,c.index)):(Ee=c,ee=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Me={};return!n.bookSheets&&!n.bookProps&&(Me.Sheets=g),Me.SheetNames=v,Me.Workbook=K,Me.SSF=Fn(st),Me.Props=ae,Me.Custprops=z,Me}function zm(t,e){switch(Gp(e=e||{}),e.type||"base64"){case"base64":return am(Sr(t),e);case"binary":case"buffer":case"file":return am(t,e);case"array":return am(Ps(t),e)}}function e$(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=mU(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=pU(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var t$=[60,1084,2066,2165,2175];function n$(t,e,n,r,a){var s=r,l=[],c=n.slice(n.l,n.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=s;for(var d=Ga(n,n.l),f=qm[d],g=0;f!=null&&t$.indexOf(d)>-1;)s=Ga(n,n.l+2),g=n.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),c=n.slice(g,n.l+4+s),l.push(c),n.l+=4+s,f=qm[d=Ga(n,n.l)];var v=Ri(l);In(v,0);var _=0;v.lens=[];for(var T=0;T<l.length;++T)v.lens.push(_),_+=l[T].length;if(v.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+r;return e.f(v,v.length,a)}function ha(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=st[r])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Bs[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v):t.w=As(t.v):t.w=jr(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&r&&t.t=="n"&&ul(st[r]||String(r))){var a=ps(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Of(t,e,n){return{v:t,ixfe:e,t:n}}function r$(t,e){var n={opts:{}},r={},a=e.dense?[]:{},s={},l={},c=null,d=[],f="",g={},v,_="",T,E,S,C,k={},A=[],b,D,B=[],G=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},U=function(Qe){return Qe<8?vs[Qe]:Qe<64&&G[Qe-8]||vs[Qe]},ae=function(Qe,wt,tn){var Ne=wt.XF.data;if(!(!Ne||!Ne.patternType||!tn||!tn.cellStyles)){wt.s={},wt.s.patternType=Ne.patternType;var Ge;(Ge=Wc(U(Ne.icvFore)))&&(wt.s.fgColor={rgb:Ge}),(Ge=Wc(U(Ne.icvBack)))&&(wt.s.bgColor={rgb:Ge})}},z=function(Qe,wt,tn){if(!(Q>1)&&!(tn.sheetRows&&Qe.r>=tn.sheetRows)){if(tn.cellStyles&&wt.XF&&wt.XF.data&&ae(Qe,wt,tn),delete wt.ixfe,delete wt.XF,v=Qe,_=at(Qe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<l.s.r&&(l.s.r=Qe.r),Qe.c<l.s.c&&(l.s.c=Qe.c),Qe.r+1>l.e.r&&(l.e.r=Qe.r+1),Qe.c+1>l.e.c&&(l.e.c=Qe.c+1),tn.cellFormula&&wt.f){for(var Ne=0;Ne<A.length;++Ne)if(!(A[Ne][0].s.c>Qe.c||A[Ne][0].s.r>Qe.r)&&!(A[Ne][0].e.c<Qe.c||A[Ne][0].e.r<Qe.r)){wt.F=_t(A[Ne][0]),(A[Ne][0].s.c!=Qe.c||A[Ne][0].s.r!=Qe.r)&&delete wt.f,wt.f&&(wt.f=""+Hn(A[Ne][1],l,Qe,J,ee));break}}tn.dense?(a[Qe.r]||(a[Qe.r]=[]),a[Qe.r][Qe.c]=wt):a[_]=wt}},ee={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(ee.password=e.password);var Ee,Ae=[],we=[],ie=[],de=[],re=!1,J=[];J.SheetNames=ee.snames,J.sharedf=ee.sharedf,J.arrayf=ee.arrayf,J.names=[],J.XTI=[];var M=0,Q=0,I=0,X=[],K=[],P;ee.codepage=1200,ta(1200);for(var te=!1;t.l<t.length-1;){var me=t.l,ve=t.read_shift(2);if(ve===0&&M===10)break;var ye=t.l===t.length?0:t.read_shift(2),_e=qm[ve];if(_e&&_e.f){if(e.bookSheets&&M===133&&ve!==133)break;if(M=ve,_e.r===2||_e.r==12){var $e=t.read_shift(2);if(ye-=2,!ee.enc&&$e!==ve&&(($e&255)<<8|$e>>8)!==ve)throw new Error("rt mismatch: "+$e+"!="+ve);_e.r==12&&(t.l+=10,ye-=10)}var Z={};if(ve===10?Z=_e.f(t,ye,ee):Z=n$(ve,_e,t,ye,ee),Q==0&&[9,521,1033,2057].indexOf(M)===-1)continue;switch(ve){case 34:n.opts.Date1904=F.WBProps.date1904=Z;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ee.enc||(t.l=0),ee.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=Z;break;case 66:var ct=Number(Z);switch(ct){case 21010:ct=1200;break;case 32768:ct=1e4;break;case 32769:ct=1252;break}ta(ee.codepage=ct),te=!0;break;case 317:ee.rrtabid=Z;break;case 25:ee.winlocked=Z;break;case 439:n.opts.RefreshAll=Z;break;case 12:n.opts.CalcCount=Z;break;case 16:n.opts.CalcDelta=Z;break;case 17:n.opts.CalcIter=Z;break;case 13:n.opts.CalcMode=Z;break;case 14:n.opts.CalcPrecision=Z;break;case 95:n.opts.CalcSaveRecalc=Z;break;case 15:ee.CalcRefMode=Z;break;case 2211:n.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:B.push(Z);break;case 430:J.push([Z]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(Z);break;case 24:case 536:P={Name:Z.Name,Ref:Hn(Z.rgce,l,null,J,ee)},Z.itab>0&&(P.Sheet=Z.itab-1),J.names.push(P),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(K[Z.itab-1]={ref:_t(Z.rgce[0][0][1][2])});break;case 22:ee.ExternCount=Z;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(Z),J.XTI=J.XTI.concat(Z);break;case 2196:if(ee.biff<8)break;P!=null&&(P.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&ee.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,ee.snames.push(Z.name);break;case 10:{if(--Q)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=_t(l),e.sheetRows&&e.sheetRows<=l.e.r){var qe=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=_t(l),l.e.r=qe}l.e.r++,l.e.c++}Ae.length>0&&(a["!merges"]=Ae),we.length>0&&(a["!objects"]=we),ie.length>0&&(a["!cols"]=ie),de.length>0&&(a["!rows"]=de),F.Sheets.push(W)}f===""?g=a:r[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),ee.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(ee.biff=5,te=!0,ta(ee.codepage=28591)),ee.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(ee.biff=2),Q++)break;if(a=e.dense?[]:{},ee.biff<8&&!te&&(te=!0,ta(ee.codepage=e.codepage||1252)),ee.biff<5||Z.BIFFVer==0&&Z.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:t.l-ye,name:f};s[dt.pos]=dt,ee.snames.push(f)}else f=(s[me]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),Ae=[],we=[],ee.arrayf=A=[],ie=[],de=[],re=!1,W={Hidden:(s[me]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[at({c:Z.c,r:Z.r})])&&++Z.c,b={ixfe:Z.ixfe,XF:B[Z.ixfe]||{},v:Z.val,t:"n"},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e);break;case 5:case 517:b={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.val,t:Z.t},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e);break;case 638:b={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.rknum,t:"n"},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e);break;case 189:for(var tt=Z.c;tt<=Z.C;++tt){var Me=Z.rkrec[tt-Z.c][0];b={ixfe:Me,XF:B[Me],v:Z.rkrec[tt-Z.c][1],t:"n"},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:tt,r:Z.r},b,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){c=Z;break}if(b=Of(Z.val,Z.cell.ixfe,Z.tt),b.XF=B[b.ixfe],e.cellFormula){var Ft=Z.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var pn=Ft[0][0][1][0],sn=Ft[0][0][1][1],en=at({r:pn,c:sn});k[en]?b.f=""+Hn(Z.formula,l,Z.cell,J,ee):b.F=((e.dense?(a[pn]||[])[sn]:a[en])||{}).F}else b.f=""+Hn(Z.formula,l,Z.cell,J,ee)}I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z(Z.cell,b,e),c=Z}break;case 7:case 519:if(c)c.val=Z,b=Of(Z,c.cell.ixfe,"s"),b.XF=B[b.ixfe],e.cellFormula&&(b.f=""+Hn(c.formula,l,c.cell,J,ee)),I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z(c.cell,b,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(Z);var rr=at(Z[0].s);if(T=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[rr],e.cellFormula&&T){if(!c||!rr||!T)break;T.f=""+Hn(Z[1],l,Z[0],J,ee),T.F=_t(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!c)break;k[at(c.cell)]=Z[0],T=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[at(c.cell)],(T||{}).f=""+Hn(Z[0],l,v,J,ee)}}break;case 253:b=Of(d[Z.isst].t,Z.ixfe,"s"),d[Z.isst].h&&(b.h=d[Z.isst].h),b.XF=B[b.ixfe],I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:Z.ixfe,XF:B[Z.ixfe],t:"z"},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e));break;case 190:if(e.sheetStubs)for(var Pn=Z.c;Pn<=Z.C;++Pn){var Jt=Z.ixfe[Pn-Z.c];b={ixfe:Jt,XF:B[Jt],t:"z"},I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Pn,r:Z.r},b,e)}break;case 214:case 516:case 4:b=Of(Z.val,Z.ixfe,"s"),b.XF=B[b.ixfe],I>0&&(b.z=X[b.ixfe>>8&63]),ha(b,e,n.opts.Date1904),z({c:Z.c,r:Z.r},b,e);break;case 0:case 512:Q===1&&(l=Z);break;case 252:d=Z;break;case 1054:if(ee.biff==4){X[I++]=Z[1];for(var Jn=0;Jn<I+163&&st[Jn]!=Z[1];++Jn);Jn>=163&&xs(Z[1],I+163)}else xs(Z[1],Z[0]);break;case 30:{X[I++]=Z;for(var gn=0;gn<I+163&&st[gn]!=Z;++gn);gn>=163&&xs(Z,I+163)}break;case 229:Ae=Ae.concat(Z);break;case 93:we[Z.cmo[0]]=ee.lastobj=Z;break;case 438:ee.lastobj.TxO=Z;break;case 127:ee.lastobj.ImData=Z;break;case 440:for(C=Z[0].s.r;C<=Z[0].e.r;++C)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[C]||[])[S]:a[at({c:S,r:C})],T&&(T.l=Z[1]);break;case 2048:for(C=Z[0].s.r;C<=Z[0].e.r;++C)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[C]||[])[S]:a[at({c:S,r:C})],T&&T.l&&(T.l.Tooltip=Z[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;T=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[at(Z[0])];var qt=we[Z[2]];T||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),T=a[Z[0].r][Z[0].c]={t:"z"}):T=a[at(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),T.c||(T.c=[]),E={a:Z[1],t:qt.TxO.t},T.c.push(E)}break;case 2173:CB(B[Z.ixfe],Z.ext);break;case 125:{if(!ee.cellStyles)break;for(;Z.e>=Z.s;)ie[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},re||(re=!0,Bp(Z.w/256)),nl(ie[Z.e+1])}break;case 520:{var At={};Z.level!=null&&(de[Z.r]=At,At.level=Z.level),Z.hidden&&(de[Z.r]=At,At.hidden=!0),Z.hpt&&(de[Z.r]=At,At.hpt=Z.hpt,At.hpx=Jc(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=Z;break;case 161:a["!margins"]||Fc(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(F.Views[0].RTL=!0);break;case 146:G=Z;break;case 2198:Ee=Z;break;case 140:D=Z;break;case 442:f?W.CodeName=Z||W.name:F.WBProps.CodeName=Z||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=ye}return n.SheetNames=wa(s).sort(function(Nt,Qe){return Number(Nt)-Number(Qe)}).map(function(Nt){return s[Nt].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&K.forEach(function(Nt,Qe){n.Sheets[n.SheetNames[Qe]]["!autofilter"]=Nt}),n.Strings=d,n.SSF=Fn(st),ee.enc&&(n.Encryption=ee.enc),Ee&&(n.Themes=Ee),n.Metadata={},D!==void 0&&(n.Metadata.Country=D),J.names.length>0&&(F.Names=J.names),n.Workbook=F,n}var eT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function a$(t,e,n){var r=yt.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Ow(r,wU,eT.DSI);for(var s in a)e[s]=a[s]}catch(f){if(n.WTF)throw f}var l=yt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=Ow(l,TU,eT.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(n.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(FE(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function xS(t,e){e||(e={}),Gp(e),q2(),e.codepage&&Tp(e.codepage);var n,r;if(t.FullPaths){if(yt.find(t,"/encryption"))throw new Error("File is password-protected");n=yt.find(t,"!CompObj"),r=yt.find(t,"/Workbook")||yt.find(t,"/Book")}else{switch(e.type){case"base64":t=ea(Sr(t));break;case"binary":t=ea(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}In(t,0),r={content:t}}var a,s;if(n&&e$(n),e.bookProps&&!e.bookSheets)a={};else{var l=gt?"buffer":"array";if(r&&r.content)a=r$(r.content,e);else if((s=yt.find(t,"PerfectOffice_MAIN"))&&s.content)a=Dc.to_workbook(s.content,(e.type=l,e));else if((s=yt.find(t,"NativeContent_MAIN"))&&s.content)a=Dc.to_workbook(s.content,(e.type=l,e));else throw(s=yt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&yt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=$B(t))}var c={};return t.FullPaths&&a$(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}var hd={0:{f:BV},1:{f:$V},2:{f:ZV},3:{f:YV},4:{f:zV},5:{f:XV},6:{f:tH},7:{f:JV},8:{f:sH},9:{f:iH},10:{f:rH},11:{f:aH},12:{f:GV},13:{f:QV},14:{f:WV},15:{f:qV},16:{f:dS},17:{f:nH},18:{f:KV},19:{f:Ip},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IH},40:{},42:{},43:{f:rB},44:{f:nB},45:{f:aB},46:{f:sB},47:{f:iB},48:{},49:{f:oU},50:{},51:{f:AB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qE},62:{f:eH},63:{f:DB},64:{f:pH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:mH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:HV},148:{f:jV,p:16},151:{f:cH},152:{},153:{f:MH},154:{},155:{},156:{f:RH},157:{},158:{},159:{T:1,f:T9},160:{T:-1},161:{T:1,f:Us},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bB},336:{T:-1},337:{f:kB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:zE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:uH},427:{f:fH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:hH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:VV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:lH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jB},633:{T:1},634:{T:-1},635:{T:1,f:BB},636:{T:-1},637:{f:cU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:wH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},qm={6:{f:nm},10:{f:Ci},12:{f:hn},13:{f:hn},14:{f:an},15:{f:an},16:{f:$n},17:{f:an},18:{f:an},19:{f:hn},20:{f:Vw},21:{f:Vw},23:{f:zE},24:{f:$w},25:{f:an},26:{},27:{},28:{f:O7},29:{},34:{f:an},35:{f:Hw},38:{f:$n},39:{f:$n},40:{f:$n},41:{f:$n},42:{f:an},43:{f:an},47:{f:V9},49:{f:v7},51:{f:hn},60:{},61:{f:p7},64:{f:an},65:{f:x7},66:{f:hn},77:{},80:{},81:{},82:{},85:{f:hn},89:{},90:{},91:{},92:{f:o7},93:{f:B7},94:{},95:{f:an},96:{},97:{},99:{f:an},125:{f:qE},128:{f:k7},129:{f:l7},130:{f:hn},131:{f:an},132:{f:an},133:{f:c7},134:{},140:{f:z7},141:{f:hn},144:{},146:{f:Y7},151:{},152:{},153:{},154:{},155:{},156:{f:hn},157:{},158:{},160:{f:Z7},161:{f:J7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:S7},190:{f:C7},193:{f:Ci},197:{},198:{},199:{},200:{},201:{},202:{f:an},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hn},220:{},221:{f:an},222:{},224:{f:A7},225:{f:s7},226:{f:Ci},227:{},229:{f:U7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:u7},253:{f:y7},255:{f:f7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:BE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:an},353:{f:Ci},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:R7},431:{f:an},432:{},433:{},434:{},437:{},438:{f:H7},439:{f:an},440:{f:$7},441:{},442:{f:su},443:{},444:{f:hn},445:{},446:{},448:{f:Ci},449:{f:m7,r:2},450:{f:Ci},512:{f:Bw},513:{f:X7},515:{f:N7},516:{f:_7},517:{f:jw},519:{f:Q7},520:{f:d7},523:{},545:{f:Gw},549:{f:Uw},566:{},574:{f:g7},638:{f:E7},659:{},1048:{},1054:{f:w7},1084:{},1212:{f:F7},2048:{f:G7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ff},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ci},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:W7,r:12},2173:{f:SB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:an,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:I7,r:12},2197:{},2198:{f:vB,r:12},2199:{},2200:{},2201:{},2202:{f:L7,r:12},2203:{f:Ci},2204:{},2205:{},2206:{},2207:{},2211:{f:h7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:K7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:q7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Bw},1:{},2:{f:r9},3:{f:n9},4:{f:t9},5:{f:jw},7:{f:a9},8:{},9:{f:Ff},11:{},22:{f:hn},30:{f:T7},31:{},32:{},33:{f:Gw},36:{},37:{f:Uw},50:{f:i9},62:{},52:{},67:{},68:{f:hn},69:{},86:{},126:{},127:{f:e9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:s9},223:{},234:{},354:{},421:{},518:{f:nm},521:{f:Ff},536:{f:$w},547:{f:Hw},561:{},579:{},1030:{f:nm},1033:{f:Ff},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xr(t,e,n,r){var a=e;if(!isNaN(a)){var s=(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&bE(n)&&t.push(n)}}function tT(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=a.index,c=s&&s.index||t.length,d=NO(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,g=0,v=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}g=0;continue}if(!(C!="<td"&&C!="<th")){var k=S.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var A=k[c].trim();if(A.match(/<t[dh]/i)){for(var b=A,D=0;b.charAt(0)=="<"&&(D=b.indexOf(">"))>-1;)b=b.slice(D+1);for(var B=0;B<E.length;++B){var G=E[B];G.s.c==g&&G.s.r<f&&f<=G.e.r&&(g=G.e.c+1,B=-1)}var F=Ke(A.slice(0,A.indexOf(">")));_=F.colspan?+F.colspan:1,((v=+F.rowspan)>1||_>1)&&E.push({s:{r:f,c:g},e:{r:f+(v||1)-1,c:g+_-1}});var W=F.t||F["data-t"]||"";if(!b.length){g+=_;continue}if(b=hE(b),T.s.r>f&&(T.s.r=f),T.e.r<f&&(T.e.r=f),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!b.length){g+=_;continue}var U={t:"s",v:b};n.raw||!b.trim().length||W=="s"||(b==="TRUE"?U={t:"b",v:!0}:b==="FALSE"?U={t:"b",v:!1}:isNaN(ra(b))?isNaN(tl(b).getDate())||(U={t:"d",v:Nn(b)},n.cellDates||(U={t:"n",v:nr(U.v)}),U.z=n.dateNF||st[14]):U={t:"n",v:ra(b)}),n.dense?(r[f]||(r[f]=[]),r[f][g]=U):r[at({r:f,c:g})]=U,g+=_}}}}return r["!ref"]=_t(T),E.length&&(r["!merges"]=E),r}function i$(t,e,n,r){for(var a=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var g=at({r:n,c:l}),v=r.dense?(t[n]||[])[l]:t[g],_=v&&v.v!=null&&(v.h||kp(v.w||(Xa(v),v.w)||""))||"",T={};c>1&&(T.rowspan=c),d>1&&(T.colspan=d),r.editable?_='<span contenteditable="true">'+_+"</span>":v&&(T["data-t"]=v&&v.t||"z",v.v!=null&&(T["data-v"]=v.v),v.z!=null&&(T["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),T.id=(r.id||"sjs")+"-"+g,s.push(zO("td",_,T))}}var E="<tr>";return E+s.join("")+"</tr>"}var s$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',o$="</body></html>";function l$(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Vi(tT(n[0],e),e);var r=qp();return n.forEach(function(a,s){Yp(r,tT(a,e),"Sheet"+(s+1))}),r}function c$(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function u$(t,e){var n=e||{},r=n.header!=null?n.header:s$,a=n.footer!=null?n.footer:o$,s=[r],l=fl(t["!ref"]);n.dense=Array.isArray(t),s.push(c$(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)s.push(i$(t,l,c,n));return s.push("</table>"+a),s.join("")}function vS(t,e,n){var r=n||{},a=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?Qn(r.origin):r.origin;a=l.r,s=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var g=fl(t["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),a==-1&&(f.e.r=a=g.e.r+1)}var v=[],_=0,T=t["!rows"]||(t["!rows"]=[]),E=0,S=0,C=0,k=0,A=0,b=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<d;++E){var D=c[E];if(nT(D)){if(r.display)continue;T[S]={hidden:!0}}var B=D.children;for(C=k=0;C<B.length;++C){var G=B[C];if(!(r.display&&nT(G))){var F=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):hE(G.innerHTML),W=G.getAttribute("data-z")||G.getAttribute("z");for(_=0;_<v.length;++_){var U=v[_];U.s.c==k+s&&U.s.r<S+a&&S+a<=U.e.r&&(k=U.e.c+1-s,_=-1)}b=+G.getAttribute("colspan")||1,((A=+G.getAttribute("rowspan")||1)>1||b>1)&&v.push({s:{r:S+a,c:k+s},e:{r:S+a+(A||1)-1,c:k+s+(b||1)-1}});var ae={t:"s",v:F},z=G.getAttribute("data-t")||G.getAttribute("t")||"";F!=null&&(F.length==0?ae.t=z||"z":r.raw||F.trim().length==0||z=="s"||(F==="TRUE"?ae={t:"b",v:!0}:F==="FALSE"?ae={t:"b",v:!1}:isNaN(ra(F))?isNaN(tl(F).getDate())||(ae={t:"d",v:Nn(F)},r.cellDates||(ae={t:"n",v:nr(ae.v)}),ae.z=r.dateNF||st[14]):ae={t:"n",v:ra(F)})),ae.z===void 0&&W!=null&&(ae.z=W);var ee="",Ee=G.getElementsByTagName("A");if(Ee&&Ee.length)for(var Ae=0;Ae<Ee.length&&!(Ee[Ae].hasAttribute("href")&&(ee=Ee[Ae].getAttribute("href"),ee.charAt(0)!="#"));++Ae);ee&&ee.charAt(0)!="#"&&(ae.l={Target:ee}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][k+s]=ae):t[at({c:k+s,r:S+a})]=ae,f.e.c<k+s&&(f.e.c=k+s),k+=b}}++S}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,S-1+a),t["!ref"]=_t(f),S>=d&&(t["!fullref"]=_t((f.e.r=c.length-E+S-1+a,f))),t}function yS(t,e){var n=e||{},r=n.dense?[]:{};return vS(r,t,e)}function f$(t,e){return Vi(yS(t,e),e)}function nT(t){var e="",n=d$(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function d$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function h$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Tt(e.replace(/<[^>]*>/g,""));return[n]}var rT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _S(t,e){var n=e||{},r=Np(t),a=[],s,l,c={name:""},d="",f=0,g,v,_={},T=[],E=n.dense?[]:{},S,C,k={value:""},A="",b=0,D=[],B=-1,G=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,U={},ae=[],z={},ee=0,Ee=0,Ae=[],we=1,ie=1,de=[],re={Names:[]},J={},M=["",""],Q=[],I={},X="",K=0,P=!1,te=!1,me=0;for(qc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=qc.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?E["!ref"]=_t(F):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(E["!fullref"]=E["!ref"],F.e.r=n.sheetRows-1,E["!ref"]=_t(F)),ae.length&&(E["!merges"]=ae),Ae.length&&(E["!rows"]=Ae),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=E,te=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=Ke(S[0],!1),B=G=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,E=n.dense?[]:{},ae=[],Ae=[],te=!0);break;case"table-row-group":S[1]==="/"?--W:++W;break;case"table-row":case"":if(S[1]==="/"){B+=we,we=1;break}if(v=Ke(S[0],!1),v.?B=v.-1:B==-1&&(B=0),we=+v["number-rows-repeated"]||1,we<10)for(me=0;me<we;++me)W>0&&(Ae[B+me]={level:W});G=-1;break;case"covered-table-cell":S[1]!=="/"&&++G,n.sheetStubs&&(n.dense?(E[B]||(E[B]=[]),E[B][G]={t:"z"}):E[at({r:B,c:G})]={t:"z"}),A="",D=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++G,k=Ke(S[0],!1),ie=parseInt(k["number-columns-repeated"]||"1",10),C={t:"z",v:null},k.formula&&n.cellFormula!=!1&&(C.f=Xw(Tt(k.formula))),(k.||k["value-type"])=="string"&&(C.t="s",C.v=Tt(k["string-value"]||""),n.dense?(E[B]||(E[B]=[]),E[B][G]=C):E[at({r:B,c:G})]=C),G+=ie-1;else if(S[1]!=="/"){++G,A="",b=0,D=[],ie=1;var ve=we?B+we-1:B;if(G>F.e.c&&(F.e.c=G),G<F.s.c&&(F.s.c=G),B<F.s.r&&(F.s.r=B),ve>F.e.r&&(F.e.r=ve),k=Ke(S[0],!1),Q=[],I={},C={t:k.||k["value-type"],v:null},n.cellFormula)if(k.formula&&(k.formula=Tt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(ee=parseInt(k["number-matrix-rows-spanned"],10)||0,Ee=parseInt(k["number-matrix-columns-spanned"],10)||0,z={s:{r:B,c:G},e:{r:B+ee-1,c:G+Ee-1}},C.F=_t(z),de.push([z,C.F])),k.formula)C.f=Xw(k.formula);else for(me=0;me<de.length;++me)B>=de[me][0].s.r&&B<=de[me][0].e.r&&G>=de[me][0].s.c&&G<=de[me][0].e.c&&(C.F=de[me][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(ee=parseInt(k["number-rows-spanned"],10)||0,Ee=parseInt(k["number-columns-spanned"],10)||0,z={s:{r:B,c:G},e:{r:B+ee-1,c:G+Ee-1}},ae.push(z)),k["number-columns-repeated"]&&(ie=parseInt(k["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=zt(k["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(k.value);break;case"percentage":C.t="n",C.v=parseFloat(k.value);break;case"currency":C.t="n",C.v=parseFloat(k.value);break;case"date":C.t="d",C.v=Nn(k["date-value"]),n.cellDates||(C.t="n",C.v=nr(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=bO(k["time-value"])/86400,n.cellDates&&(C.t="d",C.v=bd(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(k.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",k["string-value"]!=null&&(A=Tt(k["string-value"]),D=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(P=!1,C.t==="s"&&(C.v=A||"",D.length&&(C.R=D),P=b==0),J.Target&&(C.l=J),Q.length>0&&(C.c=Q,Q=[]),A&&n.cellText!==!1&&(C.w=A),P&&(C.t="z",delete C.v),(!P||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var ye=0;ye<we;++ye){if(ie=parseInt(k["number-columns-repeated"]||"1",10),n.dense)for(E[B+ye]||(E[B+ye]=[]),E[B+ye][G]=ye==0?C:Fn(C);--ie>0;)E[B+ye][G+ie]=Fn(C);else for(E[at({r:B+ye,c:G})]=C;--ie>0;)E[at({r:B+ye,c:G+ie})]=Fn(C);F.e.c<=G&&(F.e.c=G)}ie=parseInt(k["number-columns-repeated"]||"1",10),G+=ie-1,ie=0,C={},A="",D=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s;I.t=A,D.length&&(I.R=D),I.a=X,Q.push(I)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);X="",K=0,A="",b=0,D=[];break;case"creator":S[1]==="/"?X=r.slice(K,S.index):K=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);A="",b=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(U[c.name]=d,(s=a.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&(d="",c=Ke(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Ke(S[0],!1),d+=rT[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Ke(S[0],!1),d+=rT[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=Ke(S[0],!1),M=rm(l["cell-range-address"]);var _e={Name:l.name,Ref:M[0]+"!"+M[1]};te&&(_e.Sheet=T.length),re.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!k||!k["string-value"])){var $e=h$(r.slice(b,S.index));A=(A.length>0?A+`
`:"")+$e[0]}else Ke(S[0],!1),b=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{M=rm(Ke(S[0])["target-range-address"]),_[M[0]]["!autofilter"]={ref:M[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(J=Ke(S[0],!1),!J.href)break;J.Target=Tt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(M=rm(J.Target.slice(1)),J.Target="#"+M[0]+"!"+M[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var Z={Sheets:_,SheetNames:T,Workbook:re};return n.bookSheets&&delete Z.Sheets,Z}function aT(t,e){e=e||{},Ur(t,"META-INF/manifest.xml")&&NU(dn(t,"META-INF/manifest.xml"),e);var n=Er(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=_S(Vt(n),e);return Ur(t,"meta.xml")&&(r.Props=IE(dn(t,"meta.xml"))),r}function iT(t,e){return _S(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hp(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ym(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Vt(Ps(t))}function Wm(t){var e=t.reduce(function(a,s){return a+s.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function sT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function m$(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function Kc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Tn(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function zn(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Kc(t,n),s=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(s){case 0:{for(var d=n[0];t[n[0]++]>=128;);c=t.slice(d,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Kc(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:s};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function $p(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function p$(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Kc(t,r),s=zn(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:Tn(s[1][0].data),messages:[]};s[2].forEach(function(c){var d=zn(c.data),f=Tn(d[3][0].data);l.messages.push({meta:d,data:t.slice(r[0],r[0]+f)}),r[0]+=f}),(e=s[3])!=null&&e[0]&&(l.merge=Tn(s[3][0].data)>>>0>0),n.push(l)}return n}function g$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Kc(e,n),a=[];n[0]<e.length;){var s=e[n[0]]&3;if(s==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(s==1?(f=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(f=(e[n[0]++]>>2)+1,s==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Wm(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var g=Wm(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function x$(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(g$(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Wm(e)}function v$(t,e,n,r){var a=Hp(t),s=a.getUint32(4,!0),l=(r>1?12:8)+sT(s&(r>1?3470:398))*4,c=-1,d=-1,f=NaN,g=new Date(2001,0,1);s&512&&(c=a.getUint32(l,!0),l+=4),l+=sT(s&(r>1?12288:4096))*4,s&16&&(d=a.getUint32(l,!0),l+=4),s&32&&(f=a.getFloat64(l,!0),l+=8),s&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[d]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:n[c]};else if(d>-1)v={t:"s",v:e[d]};else if(!isNaN(f))v={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function y$(t,e,n){var r=Hp(t),a=r.getUint32(8,!0),s=12,l=-1,c=-1,d=NaN,f=NaN,g=new Date(2001,0,1);a&1&&(d=m$(t,s),s+=16),a&2&&(f=r.getFloat64(s,!0),s+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=r.getUint32(s,!0),s+=4),a&16&&(l=r.getUint32(s,!0),s+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function _$(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return v$(t,e,n,t[0]);case 5:return y$(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Li(t){var e=zn(t);return Kc(e[1][0].data)}function oT(t,e){var n=zn(e.data),r=Tn(n[1][0].data),a=n[3],s=[];return(a||[]).forEach(function(l){var c=zn(l.data),d=Tn(c[1][0].data)>>>0;switch(r){case 1:s[d]=Ym(c[3][0].data);break;case 8:{var f=t[Li(c[9][0].data)][0],g=zn(f.data),v=t[Li(g[1][0].data)][0],_=Tn(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=zn(v.data);s[d]=T[3].map(function(E){return Ym(E.data)}).join("")}break}}),s}function w$(t,e){var n,r,a,s,l,c,d,f,g,v,_,T,E,S,C=zn(t),k=Tn(C[1][0].data)>>>0,A=Tn(C[2][0].data)>>>0,b=((r=(n=C[8])==null?void 0:n[0])==null?void 0:r.data)&&Tn(C[8][0].data)>0||!1,D,B;if((s=(a=C[7])==null?void 0:a[0])!=null&&s.data&&e!=0)D=(c=(l=C[7])==null?void 0:l[0])==null?void 0:c.data,B=(f=(d=C[6])==null?void 0:d[0])==null?void 0:f.data;else if((v=(g=C[4])==null?void 0:g[0])!=null&&v.data&&e!=1)D=(T=(_=C[4])==null?void 0:_[0])==null?void 0:T.data,B=(S=(E=C[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var G=b?4:1,F=Hp(D),W=[],U=0;U<D.length/2;++U){var ae=F.getUint16(U*2,!0);ae<65535&&W.push([U,ae])}if(W.length!=A)throw"Expected ".concat(A," cells, found ").concat(W.length);var z=[];for(U=0;U<W.length-1;++U)z[W[U][0]]=B.subarray(W[U][1]*G,W[U+1][1]*G);return W.length>=1&&(z[W[W.length-1][0]]=B.subarray(W[W.length-1][1]*G)),{R:k,cells:z}}function T$(t,e){var n,r=zn(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Tn(r[7][0].data)>>>0>0?1:0:-1,s=$p(r[5],function(l){return w$(l,a)});return{nrows:Tn(r[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function E$(t,e,n){var r,a=zn(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Tn(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Tn(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=_t(s);var l=zn(a[4][0].data),c=oT(t,t[Li(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?oT(t,t[Li(l[17][0].data)][0]):[],f=zn(l[3][0].data),g=0;f[1].forEach(function(v){var _=zn(v.data),T=t[Li(_[2][0].data)][0],E=Tn(T.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=T$(t,T);S.data.forEach(function(C,k){C.forEach(function(A,b){var D=at({r:g+k,c:b}),B=_$(A,c,d);B&&(n[D]=B)})}),g+=S.nrows})}function S$(t,e){var n=zn(e.data),r={"!ref":"A1"},a=t[Li(n[2][0].data)],s=Tn(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return E$(t,a[0],r),r}function C$(t,e){var n,r=zn(e.data),a={name:(n=r[1])!=null&&n[0]?Ym(r[1][0].data):"",sheets:[]},s=$p(r[2],Li);return s.forEach(function(l){t[l].forEach(function(c){var d=Tn(c.meta[1][0].data);d==6e3&&a.sheets.push(S$(t,c))})}),a}function b$(t,e){var n=qp(),r=zn(e.data),a=$p(r[1],Li);if(a.forEach(function(s){t[s].forEach(function(l){var c=Tn(l.meta[1][0].data);if(c==2){var d=C$(t,l);d.sheets.forEach(function(f,g){Yp(n,f,g==0?d.name:d.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function im(t){var e,n,r,a,s={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=x$(d.content)}catch(v){return console.log("?? "+d.content.length+" "+(v.message||v))}var g;try{g=p$(f)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){s[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Tn(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(d){s[d].forEach(function(f){var g=Tn(f.meta[1][0].data)>>>0;if(g==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return b$(s,c)}function A$(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function Gp(t){A$([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function k$(t){return Vo.WS.indexOf(t)>-1?"sheet":t==Vo.CS?"chart":t==Vo.DS?"dialog":t==Vo.MS?"macro":t&&t.length?t:"sheet"}function N$(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,k$(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function R$(t,e,n,r,a,s,l,c,d,f,g,v){try{s[r]=Rc(Er(t,n,!0),e);var _=dn(t,e),T;switch(c){case"sheet":T=PH(_,e,a,d,s[r],f,g,v);break;case"chart":if(T=OH(_,e,a,d,s[r],f,g,v),!T||!T["!drawel"])break;var E=_c(T["!drawel"].Target,e),S=Hm(E),C=LB(Er(t,E,!0),Rc(Er(t,S,!0),E)),k=_c(C,E),A=Hm(k);T=yH(Er(t,k,!0),k,d,Rc(Er(t,A,!0),k),f,T);break;case"macro":T=UH(_,e,a,d,s[r],f,g,v);break;case"dialog":T=BH(_,e,a,d,s[r],f,g,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=T;var b=[];s&&s[r]&&wa(s[r]).forEach(function(D){var B="";if(s[r][D].Type==Vo.CMNT){B=_c(s[r][D].Target,e);var G=$H(dn(t,B,!0),B,d);if(!G||!G.length)return;qw(T,G,!1)}s[r][D].Type==Vo.TCMNT&&(B=_c(s[r][D].Target,e),b=b.concat(OB(dn(t,B,!0),d)))}),b&&b.length&&qw(T,b,!0,d.people||[])}catch(D){if(d.WTF)throw D}}function Pr(t){return t.charAt(0)=="/"?t.slice(1):t}function M$(t,e){if(aE(),e=e||{},Gp(e),Ur(t,"META-INF/manifest.xml")||Ur(t,"objectdata.xml"))return aT(t,e);if(Ur(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof im<"u"){if(t.FileIndex)return im(t);var n=yt.utils.cfb_new();return yw(t).forEach(function(Ae){DO(n,Ae,MO(t,Ae))}),im(n)}throw new Error("Unsupported NUMBERS file")}if(!Ur(t,"[Content_Types].xml"))throw Ur(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ur(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=yw(t),a=AU(Er(t,"[Content_Types].xml")),s=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",dn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!dn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(Ic=[],a.sst)try{Ic=HH(dn(t,Pr(a.sst)),a.sst,e)}catch(Ae){if(e.WTF)throw Ae}e.cellStyles&&a.themes.length&&(d=VH(Er(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=jH(dn(t,Pr(a.style)),a.style,d,e))}a.links.map(function(Ae){try{var we=Rc(Er(t,Hm(Pr(Ae))),Ae);return zH(dn(t,Pr(Ae)),we,Ae,e)}catch{}});var g=LH(dn(t,Pr(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=dn(t,Pr(a.coreprops[0]),!0),_&&(v=IE(_)),a.extprops.length!==0&&(_=dn(t,Pr(a.extprops[0]),!0),_&&DU(_,v,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Er(t,Pr(a.custprops[0]),!0),_&&(T=FU(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(we){return we.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(E.Props=v,E.Custprops=T),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=GH(dn(t,Pr(a.calcchain)),a.calcchain));var C=0,k={},A,b;{var D=g.Sheets;v.Worksheets=D.length,v.SheetNames=[];for(var B=0;B!=D.length;++B)v.SheetNames[B]=D[B].name}var G=s?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),W=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Ur(t,W)||(W="xl/_rels/workbook."+G+".rels");var U=Rc(Er(t,W,!0),W.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=qH(dn(t,Pr(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=UB(dn(t,Pr(a.people[0])),e)),U&&(U=N$(U,g.Sheets));var ae=dn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=v.Worksheets;++C){var z="sheet";if(U&&U[C]?(A="xl/"+U[C][1].replace(/[\/]?xl\//,""),Ur(t,A)||(A=U[C][1]),Ur(t,A)||(A=W.replace(/_rels\/.*$/,"")+U[C][1]),z=U[C][2]):(A="xl/worksheets/sheet"+(C+1-ae)+"."+G,A=A.replace(/sheet0\./,"sheet.")),b=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(C!=e.sheets)continue e;break;case"string":if(v.SheetNames[C].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var ee=!1,Ee=0;Ee!=e.sheets.length;++Ee)typeof e.sheets[Ee]=="number"&&e.sheets[Ee]==C&&(ee=1),typeof e.sheets[Ee]=="string"&&e.sheets[Ee].toLowerCase()==v.SheetNames[C].toLowerCase()&&(ee=1);if(!ee)continue e}}R$(t,A,b,v.SheetNames[C],C,k,l,z,e,g,d,f)}return E={Directory:a,Workbook:g,Props:v,Custprops:T,Deps:S,Sheets:l,SheetNames:v.SheetNames,Strings:Ic,Styles:f,Themes:d,SSF:Fn(st)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ae,we){Ae=Ae.replace(/^Root Entry[\/]/,""),E.keys.push(Ae),E.files[Ae]=t.FileIndex[we]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=dn(t,Pr(a.vba[0]),!0):a.defaults&&a.defaults.bin===HB&&(E.vbaraw=dn(t,"xl/vbaProject.bin",!0))),E}function D$(t,e){var n=e||{},r="Workbook",a=yt.find(t,r);try{if(r="/!DataSpaces/Version",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(S9(a.content),r="/!DataSpaces/DataSpaceMap",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=b9(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=A9(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);N9(a.content)}catch{}if(r="/EncryptionInfo",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=R9(a.content);if(r="/EncryptedPackage",a=yt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function zp(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Sr(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function I$(t,e){return yt.find(t,"EncryptedPackage")?D$(t,e):xS(t,e)}function F$(t,e){var n,r=t,a=e||{};return a.type||(a.type=gt&&Buffer.isBuffer(t)?"buffer":"base64"),n=uE(r,a),M$(n,a)}function wS(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return zm(t.slice(n),e);default:break e}return Yc.to_workbook(t,e)}function L$(t,e){var n="",r=zp(t,e);switch(e.type){case"base64":n=Sr(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=ks(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Vt(n)),e.type="binary",wS(n,e)}function P$(t,e){var n=t;return e.type=="base64"&&(n=Sr(n)),n=$c.utils.decode(1200,n.slice(2),"str"),e.type="binary",wS(n,e)}function O$(t){return t.match(/[^\x00-\x7F]/)?wc(t):t}function sm(t,e,n,r){return r?(n.type="string",Yc.to_workbook(t,n)):Yc.to_workbook(e,n)}function Jm(t,e){q2();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Jm(new Uint8Array(t),(n=Fn(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),qo={},n.dateNF&&(qo.dateNF=n.dateNF),n.type||(n.type=gt&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=gt?"buffer":"binary",r=SO(t),typeof Uint8Array<"u"&&!gt&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,r=O$(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Fn(n),n.type="array",Jm(Ep(r),n)}switch((a=zp(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return I$(yt.read(r,n),n);break;case 9:if(a[1]<=8)return xS(r,n);break;case 60:return zm(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return f9(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return c9.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?F$(r,n):sm(t,r,n,s);case 239:return a[3]===60?zm(r,n):sm(t,r,n,s);case 255:if(a[1]===254)return P$(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Dc.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Dc.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return zw.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return H9.to_workbook(r,n);break;case 10:case 13:case 32:return L$(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return o9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?zw.to_workbook(r,n):sm(t,r,n,s)}function U$(t,e,n,r,a,s,l,c){var d=Ln(n),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!l||t[n])for(var T=e.s.c;T<=e.e.c;++T){var E=l?t[n][T]:t[r[T]+d];if(E===void 0||E.t===void 0){if(f===void 0)continue;s[T]!=null&&(_[s[T]]=f);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[T]!=null){if(S==null)if(E.t=="e"&&S===null)_[s[T]]=null;else if(f!==void 0)_[s[T]]=f;else if(g&&S===null)_[s[T]]=null;else continue;else _[s[T]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:Xa(E,S,c);S!=null&&(v=!1)}}return{row:_,isempty:v}}function Km(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,s=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof g){case"string":d=Qt(g);break;case"number":d=Qt(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var v=Ln(d.s.r),_=[],T=[],E=0,S=0,C=Array.isArray(t),k=d.s.r,A=0,b={};C&&!t[k]&&(t[k]=[]);var D=f.skipHidden&&t["!cols"]||[],B=f.skipHidden&&t["!rows"]||[];for(A=d.s.c;A<=d.e.c;++A)if(!(D[A]||{}).hidden)switch(_[A]=wn(A),n=C?t[k][A]:t[_[A]+v],r){case 1:s[A]=A-d.s.c;break;case 2:s[A]=_[A];break;case 3:s[A]=f.header[A-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=Xa(n,null,f),S=b[l]||0,!S)b[l]=1;else{do c=l+"_"+S++;while(b[c]);b[l]=S,b[c]=1}s[A]=c}for(k=d.s.r+a;k<=d.e.r;++k)if(!(B[k]||{}).hidden){var G=U$(t,d,k,_,r,s,C,f);(G.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(T[E++]=G.row)}return T.length=E,T}var lT=/"/g;function B$(t,e,n,r,a,s,l,c){for(var d=!0,f=[],g="",v=Ln(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var T=c.dense?(t[n]||[])[_]:t[r[_]+v];if(T==null)g="";else if(T.v!=null){d=!1,g=""+(c.rawNumbers&&T.t=="n"?T.v:Xa(T,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===s||S===34||c.forceQuotes){g='"'+g.replace(lT,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(d=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(lT,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&d?null:f.join(l)}function TS(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=Qt(t["!ref"]),s=r.FS!==void 0?r.FS:",",l=s.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),g="",v=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],T=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(v[E]=wn(E));for(var S=0,C=a.s.r;C<=a.e.r;++C)(T[C]||{}).hidden||(g=B$(t,a,C,v,l,d,s,r),g!=null&&(r.strip&&(g=g.replace(f,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function j$(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=TS(t,e);return n}function V$(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=Qt(t["!ref"]),s="",l=[],c,d=[],f=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=wn(c);for(var g=a.s.r;g<=a.e.r;++g)for(s=Ln(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+s,n=f?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function ES(t,e,n){var r=n||{},a=+!r.skipHeader,s=t||{},l=0,c=0;if(s&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?Qn(r.origin):r.origin;l=d.r,c=d.c}var f,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(s["!ref"]){var v=Qt(s["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),l==-1&&(l=v.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=r.header||[],T=0;e.forEach(function(S,C){wa(S).forEach(function(k){(T=_.indexOf(k))==-1&&(_[T=_.length]=k);var A=S[k],b="z",D="",B=at({c:c+T,r:l+C+a});f=Xc(s,B),A&&typeof A=="object"&&!(A instanceof Date)?s[B]=A:(typeof A=="number"?b="n":typeof A=="boolean"?b="b":typeof A=="string"?b="s":A instanceof Date?(b="d",r.cellDates||(b="n",A=nr(A)),D=r.dateNF||st[14]):A===null&&r.nullError&&(b="e",A=0),f?(f.t=b,f.v=A,delete f.w,delete f.R,D&&(f.z=D)):s[B]=f={t:b,v:A},D&&(f.z=D))})}),g.e.c=Math.max(g.e.c,c+_.length-1);var E=Ln(l);if(a)for(T=0;T<_.length;++T)s[wn(T+c)+E]={t:"s",v:_[T]};return s["!ref"]=_t(g),s}function H$(t,e){return ES(null,t,e)}function Xc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=Qn(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Xc(t,at(e)):Xc(t,at({r:e,c:n||0}))}function $$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function qp(){return{SheetNames:[],Sheets:{}}}function Yp(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(AH(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function G$(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=$$(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function z$(t,e){return t.z=e,t}function SS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function q$(t,e,n){return SS(t,"#"+e,n)}function Y$(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function W$(t,e,n,r){for(var a=typeof e!="string"?e:Qt(e),s=typeof e=="string"?e:_t(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var d=Xc(t,l,c);d.t="n",d.F=s,delete d.v,l==a.s.r&&c==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var J$={encode_col:wn,encode_row:Ln,encode_cell:at,encode_range:_t,decode_col:Dp,decode_row:Mp,split_cell:sU,decode_cell:Qn,decode_range:fl,format_cell:Xa,sheet_add_aoa:kE,sheet_add_json:ES,sheet_add_dom:vS,aoa_to_sheet:dl,json_to_sheet:H$,table_to_sheet:yS,table_to_book:f$,sheet_to_csv:TS,sheet_to_txt:j$,sheet_to_json:Km,sheet_to_html:u$,sheet_to_formulae:V$,sheet_to_row_object_array:Km,sheet_get_cell:Xc,book_new:qp,book_append_sheet:Yp,book_set_sheet_visibility:G$,cell_set_number_format:z$,cell_set_hyperlink:SS,cell_set_internal_link:q$,cell_add_comment:Y$,sheet_set_array_formula:W$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const K$=({matrixData:t,onUpdate:e})=>{const n=(d,f)=>e({...t,headers:t.headers.map((g,v)=>v===d?f:g)}),r=(d,f,g)=>e({...t,rows:t.rows.map((v,_)=>_===d?v.map((T,E)=>E===f?g:T):v)}),a=()=>e({...t,rows:[...t.rows,Array(t.headers.length).fill("")]}),s=d=>e({...t,rows:t.rows.filter((f,g)=>g!==d)}),l=()=>{const d=` ${t.headers.length+1}`;e({headers:[...t.headers,d],rows:t.rows.map(f=>[...f,""])})},c=d=>{t.headers.length<=1||e({headers:t.headers.filter((f,g)=>g!==d),rows:t.rows.map(f=>f.filter((g,v)=>v!==d))})};return x.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[x.jsxs("table",{className:"w-full text-xs border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-slate-200",children:[t.headers.map((d,f)=>x.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:x.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[x.jsx("input",{type:"text",value:d,onChange:g=>n(f,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),x.jsx("button",{onClick:()=>c(f),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:x.jsx(Ka,{className:"w-3 h-3"})})]})},f)),x.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),x.jsx("tbody",{children:t.rows.map((d,f)=>x.jsxs("tr",{children:[d.map((g,v)=>x.jsx("td",{className:"border border-slate-300 p-0",children:x.jsx("input",{type:"text",value:g,onChange:_=>r(f,v,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},v)),x.jsx("td",{className:"border border-slate-300 p-1 text-center",children:x.jsx("button",{onClick:()=>s(f),className:"text-red-500 hover:text-red-700",title:"",children:x.jsx(Ka,{className:"w-3 h-3"})})})]},f))})]}),x.jsxs("div",{className:"flex gap-2 mt-2",children:[x.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Ss,{className:"w-3 h-3"}),""]}),x.jsxs("button",{onClick:l,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Ss,{className:"w-3 h-3"}),""]})]})]})},cT=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},X$=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],s=t.map((l,c)=>{const d=l.value/n,[f,g]=cT(r);r+=d;const[v,_]=cT(r),T=d>.5?1:0;return{path:`M ${f} ${g} A 1 1 0 ${T} 1 ${v} ${_} L 0 0`,color:a[c%a.length],label:l.label,value:l.value}});return x.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"font-bold text-sm mb-2",children:e}),x.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:s.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:s.map((l,c)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:l.color}}),x.jsx("span",{children:l.label})]}),x.jsxs("span",{children:[l.value," (",(l.value/n*100).toFixed(1),"%)"]})]},c))})]})},Z$=({data:t,title:e})=>{if(t.length<2)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...t.map(r=>r.value),0);return x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>x.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:t.map((r,a)=>`${a/(t.length-1)*100},${50-r.value/n*45}`).join(" ")}),t.map((r,a)=>x.jsx("circle",{cx:`${a/(t.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},Q$=({data:t,title:e})=>{const n=Math.max(...t.map(r=>r.value),0);return n===0?x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsx("div",{className:"space-y-1",children:t.map(r=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),x.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:x.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:x.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},eG=({actionItem:t,onSave:e,onClose:n,generateUniqueId:r})=>{var k;const[a,s]=H.useState(t.report||{notes:"",attachments:[],matrixData:null}),[l,c]=H.useState("bar"),d=H.useRef(null),f=H.useRef(null),g=A=>{s(b=>({...b,...A}))},v=()=>{e({...t,report:a})},_=A=>{var F;const b=(F=A.target.files)==null?void 0:F[0];if(!b)return;const D=5,B=D*1024*1024;if(b.size>B){alert(`${D}MB`),A.target&&(A.target.value="");return}const G=new FileReader;G.onload=W=>{var U;if(typeof((U=W.target)==null?void 0:U.result)=="string"){const ae={id:r("attach"),name:b.name,type:b.type,dataUrl:W.target.result};g({attachments:[...a.attachments||[],ae]})}else alert("")},G.onerror=()=>{alert("")},G.readAsDataURL(b),A.target&&(A.target.value="")},T=A=>{var b;g({attachments:(b=a.attachments)==null?void 0:b.filter(D=>D.id!==A)})},E=A=>{var B;const b=(B=A.target.files)==null?void 0:B[0];if(!b)return;const D=new FileReader;D.onload=G=>{var F;try{const W=(F=G.target)==null?void 0:F.result,U=Jm(W,{type:"array"}),ae=U.SheetNames[0],z=U.Sheets[ae],ee=J$.sheet_to_json(z,{header:1});if(!Array.isArray(ee)||ee.length===0){alert("Excel"),A.target&&(A.target.value="");return}const Ee=ee[0];if(!Array.isArray(Ee)){alert("Excel"),A.target&&(A.target.value="");return}const Ae=Ee.map(String),we=ee.slice(1),ie=[];for(const de of we)if(Array.isArray(de)){const re=Array(Ae.length).fill("");for(let J=0;J<Ae.length;J++)re[J]=de[J]!==null&&de[J]!==void 0?String(de[J]):"";ie.push(re)}g({matrixData:{headers:Ae,rows:ie}})}catch(W){console.error("Error parsing Excel file:",W),alert(`Excel: ${W instanceof Error?W.message:"Unknown error"}`)}finally{A.target&&(A.target.value="")}},D.readAsArrayBuffer(b)},S=(((k=a.matrixData)==null?void 0:k.rows)||[]).map(A=>({label:A[0],value:parseFloat(A[1])||0})).filter(A=>A.label&&!isNaN(A.value)),C=()=>{if(!a.matrixData||S.length===0)return null;switch(l){case"line":return x.jsx(Z$,{data:S,title:""});case"pie":return x.jsx(X$,{data:S,title:""});case"bar":default:return x.jsx(Q$,{data:S,title:""})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500",children:t.text})]}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),x.jsx("textarea",{value:a.notes,onChange:A=>g({notes:A.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",x.jsx("button",{onClick:()=>{var A;return(A=d.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:x.jsx(jc,{className:"w-5 h-5"})}),x.jsx("input",{type:"file",ref:d,onChange:_,className:"hidden",multiple:!1})]}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(A=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[x.jsx("a",{href:A.dataUrl,download:A.name,className:"block w-full h-full","aria-label":`Download ${A.name}`,children:A.type.startsWith("image/")?x.jsx("img",{src:A.dataUrl,alt:A.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:x.jsx(jc,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:A.name,children:A.name})}),x.jsx("button",{onClick:()=>T(A.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(Ka,{className:"w-3 h-3"})})]},A.id))})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{var A;return(A=f.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:x.jsx(N2,{className:"w-5 h-5 text-green-600"})}),x.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[x.jsx("button",{onClick:()=>c("bar"),className:`px-2 py-0.5 rounded-full text-xs ${l==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),x.jsx("button",{onClick:()=>c("line"),className:`px-2 py-0.5 rounded-full text-xs ${l==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),x.jsx("button",{onClick:()=>c("pie"),className:`px-2 py-0.5 rounded-full text-xs ${l==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),x.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"":"",children:a.matrixData?x.jsx(Ka,{className:"w-5 h-5 text-red-500"}):x.jsx(vp,{className:"w-5 h-5"})})]})]}),a.matrixData?x.jsx(K$,{matrixData:a.matrixData,onUpdate:A=>g({matrixData:A})}):null,x.jsx("div",{className:"mt-4",children:C()})]})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsx("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},tG=({items:t,taskName:e,onClose:n})=>{var g;const[r,a]=H.useState(null),s=H.useMemo(()=>new Set(t.map(v=>v.subStep.id)).size<=1,[t]),l=H.useMemo(()=>{let v=[...t];return r!==null&&v.sort((_,T)=>{let E="",S="";switch(r.key){case"status":E=_.actionItem.completed,S=T.actionItem.completed;break;case"dueDate":E=_.actionItem.dueDate||"9999-12-31",S=T.actionItem.dueDate||"9999-12-31";break;case"completedDate":E=_.actionItem.completedDate||"9999-12-31",S=T.actionItem.completedDate||"9999-12-31";break;case"text":E=(_.actionItem.text||"").toLowerCase(),S=(T.actionItem.text||"").toLowerCase();break;case"subStep":E=(_.subStep.text||"").toLowerCase(),S=(T.subStep.text||"").toLowerCase();break;case"responsible":E=(_.actionItem.responsible||"").toLowerCase(),S=(T.actionItem.responsible||"").toLowerCase();break}return E<S?r.direction==="ascending"?-1:1:E>S?r.direction==="ascending"?1:-1:0}),v},[t,r]),c=v=>{let _="ascending";r&&r.key===v&&r.direction==="ascending"&&(_="descending"),a({key:v,direction:_})},d=v=>!r||r.key!==v?x.jsx(bs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):r.direction==="ascending"?x.jsx(Vc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(bs,{className:"w-3 h-3 ml-1 text-blue-600"}),f=({sortKey:v,label:_,className:T})=>x.jsx("th",{scope:"col",className:`p-0 ${T||""}`,children:x.jsxs("button",{onClick:()=>c(v),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:_}),d(v)]})});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500",children:s?`: ${e} / : ${((g=t[0])==null?void 0:g.subStep.text)||""}`:`: ${e}`})]}),x.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(f,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),x.jsx(f,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),!s&&x.jsx(f,{sortKey:"subStep",label:"",className:"w-1/5 border border-slate-300"}),x.jsx(f,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),x.jsxs("tbody",{className:"bg-white",children:[l.map(({actionItem:v,subStep:_})=>{var T;return x.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:v.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(gp,{className:"w-4 h-4 mr-1"}),""]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(xp,{className:"w-4 h-4 mr-1"}),""]})}),x.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[v.text,v.report&&Array.isArray(v.report.attachments)&&v.report.attachments.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:v.report.attachments.map(E=>x.jsxs("a",{href:E.dataUrl,target:"_blank",rel:"noopener noreferrer",download:E.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[x.jsx(jc,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:E.name})]},E.id))}),((T=v.report)==null?void 0:T.notes)&&x.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:v.report.notes})]}),!s&&x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.responsible||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.dueDate||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.completedDate||""})]},v.id)}),t.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:s?5:6,className:"text-center py-10 text-slate-500",children:""})})]})]})}),x.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},om=({value:t,onChange:e,placeholder:n})=>x.jsx("textarea",{value:t,onChange:r=>e(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),nG=({isOpen:t,onClose:e,onSave:n,task:r,generateUniqueId:a})=>{var F;const[s,l]=H.useState([]),[c,d]=H.useState(!1),[f,g]=H.useState(null),[v,_]=H.useState({key:"status",direction:"ascending"});H.useEffect(()=>{var W;t&&l(((W=r.extendedDetails)==null?void 0:W.decisions)||[])},[t,(F=r.extendedDetails)==null?void 0:F.decisions]);const T=H.useMemo(()=>{let W=[...s];return v!==null&&W.sort((U,ae)=>{let z="",ee="";switch(v.key){case"status":z=U.status==="undecided"?0:1,ee=ae.status==="undecided"?0:1;break;case"date":z=U.date||"9999-12-31",ee=ae.date||"9999-12-31";break;default:z=(U[v.key]||"").toLowerCase(),ee=(ae[v.key]||"").toLowerCase()}return z<ee?v.direction==="ascending"?-1:1:z>ee?v.direction==="ascending"?1:-1:0}),W},[s,v]),E=W=>{let U="ascending";v&&v.key===W&&v.direction==="ascending"&&(U="descending"),_({key:W,direction:U})},S=W=>!v||v.key!==W?x.jsx(bs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):v.direction==="ascending"?x.jsx(Vc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(bs,{className:"w-3 h-3 ml-1 text-blue-600"}),C=({sortKey:W,label:U,className:ae})=>x.jsx("th",{className:`p-0 border border-slate-300 ${ae||""}`,children:x.jsxs("button",{onClick:()=>E(W),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:U}),S(W)]})}),k=async()=>{d(!0),g(null);try{const U=(await fL(r,s)).map(ae=>ae.id==="NEW"?{...ae,id:a("dec_ai")}:ae);l(U)}catch(W){g(W instanceof Error?W.message:"")}finally{d(!1)}},A=(W,U)=>{l(ae=>ae.map(z=>z.id===W?{...z,...U}:z))},b=(W,U)=>{const ae=s.find(ee=>ee.id===W);if(!ae)return;const z={status:U};U==="decided"&&!ae.date?z.date=new Date().toISOString().split("T")[0]:U==="undecided"&&(z.date=void 0),A(W,z)},D=W=>{l(U=>U.filter(ae=>ae.id!==W))},B=()=>{const W={id:a("dec_manual"),question:"",status:"undecided"};l(U=>[W,...U])},G=()=>{n(s)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[x.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[c?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Oi,{className:"w-5 h-5"}),x.jsx("span",{children:"AI"})]}),x.jsxs("button",{onClick:B,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[x.jsx(R2,{className:"w-5 h-5"}),x.jsx("span",{children:""})]}),x.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]})]}),f&&x.jsx("div",{className:"p-4",children:x.jsx(Fs,{message:f})}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(C,{sortKey:"status",label:"",className:"w-32"}),x.jsx(C,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),x.jsx(C,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),x.jsx(C,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),x.jsx(C,{sortKey:"date",label:"",className:"w-36"}),x.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),x.jsxs("tbody",{children:[T.map(W=>x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsxs("select",{value:W.status,onChange:U=>b(W.id,U.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${W.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[x.jsx("option",{value:"undecided",children:""}),x.jsx("option",{value:"decided",children:""})]})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(om,{value:W.question||"",onChange:U=>A(W.id,{question:U}),placeholder:""})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(om,{value:W.decision||"",onChange:U=>A(W.id,{decision:U}),placeholder:"..."})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(om,{value:W.reasoning||"",onChange:U=>A(W.id,{reasoning:U}),placeholder:"..."})}),x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsx("input",{type:"date",value:W.date||"",onChange:U=>A(W.id,{date:U.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:W.status==="undecided"})}),x.jsx("td",{className:"border border-slate-300 text-center align-middle",children:x.jsx("button",{onClick:()=>D(W.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:x.jsx(Ka,{className:"w-5 h-5"})})})]},W.id)),s.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),x.jsx("button",{onClick:G,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},rG=({task:t,isOpen:e,onClose:n,onReportGenerated:r})=>{const[a,s]=H.useState(""),[l,c]=H.useState(new Set),[d,f]=H.useState(!1),[g,v]=H.useState(null),_=H.useMemo(()=>{var b,D,B,G;const A=[];return A.push({id:`task-data-${t.id}`,name:`: ${t.title}`,type:"Task Data",source:{name:`: ${t.title}`,type:"json",content:t}}),(D=(b=t.extendedDetails)==null?void 0:b.attachments)==null||D.forEach(F=>{A.push({id:F.id,name:`: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(G=(B=t.extendedDetails)==null?void 0:B.subSteps)==null||G.forEach(F=>{var W;(W=F.actionItems)==null||W.forEach(U=>{var ae,z,ee;(ae=U.report)!=null&&ae.matrixData&&A.push({id:`matrix-${U.id}`,name:`: ${U.text} (${F.text})`,type:"Data Matrix",source:{name:`: ${U.text}`,type:"json",content:U.report.matrixData}}),(ee=(z=U.report)==null?void 0:z.attachments)==null||ee.forEach(Ee=>{A.push({id:Ee.id,name:`: ${Ee.name} (${U.text})`,type:"Attachment",source:{name:Ee.name,type:Ee.type.startsWith("image/")?"image":"text",content:Ee.dataUrl}})})})}),A},[t]),T=H.useMemo(()=>_.find(A=>A.type==="Task Data"),[_]),E=H.useMemo(()=>_.filter(A=>A.type!=="Task Data"),[_]);H.useEffect(()=>{if(e){const A=new Set;T&&A.add(T.id),c(A)}},[e,T]);const S=A=>{const b=_.find(D=>D.id===A);(b==null?void 0:b.type)!=="Task Data"&&c(D=>{const B=new Set(D);return B.has(A)?B.delete(A):B.add(A),B})},C=async()=>{if(!a.trim()){v("");return}if(l.size===0){v("1");return}f(!0),v(null);try{const A=_.filter(D=>l.has(D.id)).map(D=>D.source),b=await A2(A,a);r(b)}catch(A){v(A instanceof Error?A.message:"")}finally{f(!1)}};if(!e)return null;const k=A=>{switch(A){case"Task Data":return x.jsx(Cs,{className:"w-5 h-5 text-blue-600"});case"Attachment":return x.jsx(jc,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(vp,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Cs,{className:"w-5 h-5 text-slate-500"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),x.jsxs("div",{className:"mb-4",children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),x.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[x.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),T&&k(T.type),x.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:T==null?void 0:T.name,children:T==null?void 0:T.name})]})]}),E.length>0&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:E.map(A=>x.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:l.has(A.id),onChange:()=>S(A.id),className:"w-4 h-4 accent-blue-600"}),k(A.type),x.jsx("span",{className:"text-sm text-slate-700 truncate",title:A.name,children:A.name})]},A.id))})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),x.jsx("textarea",{value:a,onChange:A=>s(A.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&x.jsx("div",{className:"mt-2",children:x.jsx(Fs,{message:g})})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsxs("button",{onClick:C,disabled:d,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[d?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Oi,{className:"w-5 h-5"}),x.jsx("span",{children:d?"...":""})]})]})]})})},aG=({task:t,onClose:e,onUpdateTask:n,generateUniqueId:r,projectGoal:a,targetDate:s,canEdit:l=!0})=>{const[c,d]=H.useState(()=>{var P,te,me,ve,ye,_e,$e,Z,ct,qe,dt;return{subSteps:((P=t.extendedDetails)==null?void 0:P.subSteps)||[],resources:((te=t.extendedDetails)==null?void 0:te.resources)||"",responsible:((me=t.extendedDetails)==null?void 0:me.responsible)||"",notes:((ve=t.extendedDetails)==null?void 0:ve.notes)||"",numericalTarget:(ye=t.extendedDetails)==null?void 0:ye.numericalTarget,dueDate:(_e=t.extendedDetails)==null?void 0:_e.dueDate,reportDeck:($e=t.extendedDetails)==null?void 0:$e.reportDeck,resourceMatrix:(Z=t.extendedDetails)==null?void 0:Z.resourceMatrix,attachments:((ct=t.extendedDetails)==null?void 0:ct.attachments)||[],decisions:((qe=t.extendedDetails)==null?void 0:qe.decisions)||[],subStepCanvasSize:((dt=t.extendedDetails)==null?void 0:dt.subStepCanvasSize)||{width:1200,height:800}}}),[f,g]=H.useState(!1),[v,_]=H.useState(null),[T,E]=H.useState(!1),[S,C]=H.useState([]),[k,A]=H.useState(null),[b,D]=H.useState(!1),[B,G]=H.useState(!1),[F,W]=H.useState(!1),[U,ae]=H.useState(!1),z=H.useRef(null),ee=H.useRef(null),Ee=H.useCallback(()=>{if(!l)return;const P=250,te=150,me=50,ve=c.subSteps.map((ye,_e)=>({...ye,position:{x:me+_e%3*P,y:me+Math.floor(_e/3)*te}}));d(ye=>({...ye,subSteps:ve}))},[c.subSteps,l]),Ae=H.useCallback(()=>{n(t.id,c),e()},[t.id,c,n,e]),we=async()=>{if(l){g(!0),_(null);try{const P=await uL(t);C(P),E(!0)}catch(P){_(P instanceof Error?P.message:"")}finally{g(!1)}}},ie=P=>{const te=P.newSubSteps.map(ve=>({id:r("substep"),text:ve.title,notes:ve.description,position:{x:50+c.subSteps.length*250,y:50},actionItems:[]})),me=[...c.subSteps,...te].map(ve=>{const ye=P.newActionItems.filter(_e=>_e.targetSubStepId===ve.id);if(ye.length>0){const _e=ye.map($e=>({id:r("action"),text:$e.title,completed:!1}));return{...ve,actionItems:[...ve.actionItems||[],..._e]}}return ve});d(ve=>({...ve,subSteps:me})),E(!1)},de=()=>{if(!l)return;const P={id:r("substep"),text:"",position:{x:50+c.subSteps.length*250,y:50},actionItems:[]};d(te=>({...te,subSteps:[...te.subSteps,P]}))},re=(P,te)=>{l&&d(me=>({...me,subSteps:me.subSteps.map(ve=>ve.id===P?{...ve,...te}:ve)}))},J=P=>{l&&d(te=>({...te,subSteps:te.subSteps.filter(me=>me.id!==P)}))},M=P=>{var me;if(!l)return;const te={id:r("action"),text:"",completed:!1};re(P,{actionItems:[...((me=c.subSteps.find(ve=>ve.id===P))==null?void 0:me.actionItems)||[],te]})},Q=(P,te,me)=>{if(!l)return;const ve=c.subSteps.find(_e=>_e.id===P);if(!ve)return;const ye=(ve.actionItems||[]).map(_e=>_e.id===te?{..._e,...me}:_e);re(P,{actionItems:ye})},I=(P,te)=>{if(!l)return;const me=c.subSteps.find(ye=>ye.id===P);if(!me)return;const ve=(me.actionItems||[]).filter(ye=>ye.id!==te);re(P,{actionItems:ve})},X=P=>{var ve;if(!l)return;const te=(ve=P.target.files)==null?void 0:ve[0];if(!te)return;const me=new FileReader;me.onload=ye=>{var _e;if(typeof((_e=ye.target)==null?void 0:_e.result)=="string"){const $e={id:r("attach"),name:te.name,type:te.type,dataUrl:ye.target.result};d(Z=>({...Z,attachments:[...Z.attachments||[],$e]}))}},me.readAsDataURL(te),P.target.value=""},K=c.subSteps.flatMap(P=>(P.actionItems||[]).map(te=>({actionItem:te,subStep:P})));return x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[50]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-7xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200 flex-shrink-0",children:[x.jsxs("div",{className:"flex-grow min-w-0 mr-4",children:[x.jsx("h3",{className:"text-2xl font-bold text-slate-800 truncate",children:t.title}),x.jsx("p",{className:"text-slate-600 mt-1 line-clamp-2",children:t.description})]}),x.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[l&&x.jsxs(x.Fragment,{children:[x.jsxs("button",{onClick:Ee,className:"flex items-center gap-2 px-3 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",title:"",children:[x.jsx(Sd,{className:"w-4 h-4"}),""]}),x.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-3 py-2 text-sm font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700",children:[x.jsx(F2,{className:"w-4 h-4"}),""]})]}),x.jsx("button",{onClick:()=>ae(!U),className:"p-2 text-slate-600 hover:text-slate-800 rounded-md hover:bg-slate-100",title:U?"":"",children:U?x.jsx(FL,{className:"w-5 h-5"}):x.jsx(IL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:e,className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[x.jsxs("div",{className:`${U?"w-full":"w-2/3"} flex flex-col border-r border-slate-200`,children:[x.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[x.jsxs("h4",{className:"font-semibold text-slate-800 flex items-center",children:[x.jsx(wL,{className:"w-5 h-5 mr-2"})," (",c.subSteps.length,")"]}),l&&x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsxs("button",{onClick:we,disabled:f,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[f?x.jsx(_n,{size:"sm",color:"border-white"}):x.jsx(Oi,{className:"w-4 h-4"}),"AI"]}),x.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700",children:[x.jsx(Ss,{className:"w-4 h-4"}),""]})]})]}),v&&x.jsx("div",{className:"p-4 border-b border-slate-200",children:x.jsx(Fs,{message:v})}),x.jsx("div",{ref:z,className:"flex-grow overflow-auto bg-slate-50 relative",style:{minHeight:"400px"},children:c.subSteps.length===0?x.jsx("div",{className:"flex items-center justify-center h-full",children:x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-slate-500 mb-4",children:""}),l&&x.jsx("button",{onClick:de,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:""})]})}):x.jsx("div",{className:"relative w-full h-full min-w-[800px] min-h-[600px]",children:c.subSteps.map(P=>x.jsx(iG,{subStep:P,onUpdate:te=>re(P.id,te),onRemove:()=>J(P.id),onAddActionItem:()=>M(P.id),onUpdateActionItem:(te,me)=>Q(P.id,te,me),onRemoveActionItem:te=>I(P.id,te),onOpenActionItemReport:te=>A({actionItem:te,subStepId:P.id}),canEdit:l},P.id))})})]}),!U&&x.jsxs("div",{className:"w-1/3 flex flex-col overflow-hidden",children:[x.jsx("div",{className:"p-4 border-b border-slate-200",children:x.jsx("h4",{className:"font-semibold text-slate-800",children:""})}),x.jsxs("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[x.jsx(AL,{className:"w-4 h-4 mr-1"}),""]}),x.jsx("input",{type:"text",value:c.responsible,onChange:P=>d(te=>({...te,responsible:P.target.value})),disabled:!l,className:"w-full px-3 py-2 border border-slate-300 rounded-md text-sm",placeholder:""})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[x.jsx(Td,{className:"w-4 h-4 mr-1"}),""]}),x.jsx("input",{type:"date",value:c.dueDate||"",onChange:P=>d(te=>({...te,dueDate:P.target.value})),disabled:!l,className:"w-full px-3 py-2 border border-slate-300 rounded-md text-sm"})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[x.jsx(bL,{className:"w-4 h-4 mr-1"}),""]}),x.jsx("textarea",{value:c.resources,onChange:P=>d(te=>({...te,resources:P.target.value})),disabled:!l,rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md text-sm",placeholder:""})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[x.jsx(CL,{className:"w-4 h-4 mr-1"}),""]}),x.jsx("textarea",{value:c.notes,onChange:P=>d(te=>({...te,notes:P.target.value})),disabled:!l,rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-md text-sm",placeholder:""})]})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("h5",{className:"font-medium text-slate-800",children:[" (",K.length,")"]}),x.jsx("button",{onClick:()=>D(!0),className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:""})]}),x.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[K.slice(0,5).map(({actionItem:P,subStep:te})=>x.jsxs("div",{className:"text-xs p-2 bg-slate-50 rounded border",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:P.completed?"line-through text-slate-500":"text-slate-800",children:P.text}),x.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] ${P.completed?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.completed?"":""})]}),x.jsxs("div",{className:"text-slate-500 mt-1",children:[": ",te.text]})]},P.id)),K.length>5&&x.jsxs("div",{className:"text-xs text-slate-500 text-center py-2",children:[" ",K.length-5," ..."]})]})]})]})]})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t flex justify-between items-center flex-shrink-0",children:[x.jsx("div",{className:"flex items-center gap-4",children:l&&x.jsxs(x.Fragment,{children:[x.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700",children:[x.jsx(Oi,{className:"w-4 h-4"}),""]}),x.jsx("input",{type:"file",ref:ee,onChange:X,className:"hidden",accept:"image/*,.pdf,.doc,.docx,.txt"}),x.jsx("button",{onClick:()=>{var P;return(P=ee.current)==null?void 0:P.click()},className:"px-3 py-2 text-sm text-slate-600 border border-slate-300 rounded-md hover:bg-slate-50",children:""})]})}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50",children:""}),l&&x.jsx("button",{onClick:Ae,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:""})]})]})]})}),T&&x.jsx(YP,{proposals:S,existingSubSteps:c.subSteps,onConfirm:ie,onClose:()=>E(!1)}),k&&x.jsx(eG,{actionItem:k.actionItem,onSave:P=>{Q(k.subStepId,P.id,P),A(null)},onClose:()=>A(null),generateUniqueId:r}),b&&x.jsx(tG,{items:K,taskName:t.title,onClose:()=>D(!1)}),B&&x.jsx(nG,{isOpen:B,onClose:()=>G(!1),onSave:P=>{d(te=>({...te,decisions:P})),G(!1)},task:t,generateUniqueId:r}),F&&x.jsx(rG,{task:t,isOpen:F,onClose:()=>W(!1),onReportGenerated:P=>{d(te=>({...te,reportDeck:P})),W(!1)}})]})},iG=({subStep:t,onUpdate:e,onRemove:n,onAddActionItem:r,onUpdateActionItem:a,onRemoveActionItem:s,onOpenActionItemReport:l,canEdit:c})=>{var C,k;const[d,f]=H.useState(!1),[g,v]=H.useState({x:0,y:0}),_=A=>{if(!c)return;f(!0);const b=A.currentTarget.getBoundingClientRect();v({x:A.clientX-b.left,y:A.clientY-b.top})},T=A=>{if(!d||!c)return;const b=document.querySelector(".relative.w-full.h-full");if(!b)return;const D=b.getBoundingClientRect(),B=A.clientX-D.left-g.x,G=A.clientY-D.top-g.y;e({position:{x:Math.max(0,Math.min(B,D.width-200)),y:Math.max(0,Math.min(G,D.height-120))}})},E=()=>{f(!1)};ys.useEffect(()=>{if(d)return document.addEventListener("mousemove",T),document.addEventListener("mouseup",E),()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",E)}},[d,g]);const S=A=>{switch(A){case Wo.COMPLETED:return"border-green-500 bg-green-50";case Wo.IN_PROGRESS:return"border-blue-500 bg-blue-50";default:return"border-slate-300 bg-white"}};return x.jsx("div",{className:`absolute w-48 bg-white border-2 rounded-lg shadow-md ${S(t.status)} ${d?"cursor-grabbing":"cursor-grab"}`,style:{left:((C=t.position)==null?void 0:C.x)||0,top:((k=t.position)==null?void 0:k.y)||0},onMouseDown:_,children:x.jsxs("div",{className:"p-3",children:[x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsx("input",{type:"text",value:t.text,onChange:A=>e({text:A.target.value}),disabled:!c,className:"font-medium text-sm bg-transparent border-none outline-none flex-grow",placeholder:""}),c&&x.jsx("button",{onClick:A=>{A.stopPropagation(),n()},className:"text-red-500 hover:text-red-700 ml-2",children:x.jsx(Ka,{className:"w-4 h-4"})})]}),x.jsxs("div",{className:"space-y-1 mb-3",children:[(t.actionItems||[]).slice(0,3).map(A=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("input",{type:"checkbox",checked:A.completed,onChange:b=>a(A.id,{completed:b.target.checked}),disabled:!c,className:"w-3 h-3 mr-2"}),x.jsx("span",{className:A.completed?"line-through text-slate-500":"text-slate-700",children:A.text})]},A.id)),(t.actionItems||[]).length>3&&x.jsxs("div",{className:"text-xs text-slate-500",children:["+",(t.actionItems||[]).length-3," more..."]})]}),c&&x.jsx("button",{onClick:A=>{A.stopPropagation(),r()},className:"w-full text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200",children:"+ "})]})})},sG=({onSetApiKey:t,error:e,isLoading:n})=>{const[r,a]=H.useState(""),s=l=>{l.preventDefault(),t(r)};return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsx(Oi,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),x.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),x.jsxs("form",{onSubmit:s,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Hc,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),x.jsx("input",{id:"apiKey",type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),e&&x.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:e}),x.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?x.jsx(_n,{size:"sm"}):""})]}),x.jsxs("div",{className:"text-center mt-6",children:[x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),x.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),x.jsx("footer",{className:"mt-8 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},CS=({isOpen:t,onClose:e,onSuccess:n})=>{const[r,a]=H.useState(!0),[s,l]=H.useState(""),[c,d]=H.useState(""),[f,g]=H.useState(!1),[v,_]=H.useState(null),T=async E=>{E.preventDefault(),g(!0),_(null);try{if(r){const{error:S}=await rt.auth.signInWithPassword({email:s,password:c});if(S)throw S}else{const{error:S}=await rt.auth.signUp({email:s,password:c});if(S)throw S}n()}catch(S){_(S instanceof Error?S.message:"")}finally{g(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[x.jsx(Hc,{className:"w-6 h-6 mr-2 text-blue-600"}),r?"":""]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-5 h-5"})})]}),x.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),x.jsx("input",{type:"email",id:"email",value:s,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),x.jsx("input",{type:"password",id:"password",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),v&&x.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:v}),x.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:f?x.jsx(_n,{size:"sm",color:"border-white"}):r?"":""}),x.jsx("div",{className:"text-center",children:x.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:underline",children:r?"":""})})]})]})}):null},oG=({isOpen:t,onClose:e,onSelectProject:n,onCreateNew:r})=>{const[a,s]=H.useState([]),[l,c]=H.useState(!1),[d,f]=H.useState(null),g=async()=>{c(!0),f(null);try{const T=await Vn.getProjects();s(T)}catch(T){f(T instanceof Error?T.message:"")}finally{c(!1)}};H.useEffect(()=>{t&&g()},[t]);const v=async(T,E)=>{if(E.stopPropagation(),!!confirm(""))try{await Vn.deleteProject(T),await g()}catch(S){f(S instanceof Error?S.message:"")}},_=T=>{const E={projectGoal:T.goal,targetDate:T.targetDate,tasks:T.tasks,ganttData:T.ganttData},S=JSON.stringify(E,null,2),C=new Blob([S],{type:"application/json"}),k=URL.createObjectURL(C),A=document.createElement("a");A.href=k,A.download=`${T.title}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[x.jsx(Ss,{className:"w-5 h-5"}),""]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(fr,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[d&&x.jsx(Fs,{message:d}),l?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(_n,{size:"lg",text:"..."})}):a.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("p",{className:"text-slate-500 text-lg mb-4",children:""}),x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[x.jsx(Ss,{className:"w-5 h-5"}),""]})]}):x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(T=>x.jsxs("div",{onClick:()=>n(T),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:T.title}),x.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x.jsx("button",{onClick:E=>{E.stopPropagation(),_(T)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSON",children:x.jsx(el,{className:"w-4 h-4"})}),x.jsx("button",{onClick:E=>v(T.id,E),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"",children:x.jsx(Ka,{className:"w-4 h-4"})})]})]}),x.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(pp,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsx("span",{className:"line-clamp-2",children:T.goal})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Td,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(T.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),x.jsxs("p",{className:"text-xs text-slate-500",children:[": ",T.tasks.length," | : ",new Date(T.updatedAt).toLocaleDateString("ja-JP")]})]})]},T.id))})]})]})}):null},lG={"process-design":{goal:"APQPAdvanced Product Quality Planning",tasks:[{id:"apqp-1",title:"Phase 1",description:""},{id:"apqp-2",title:"Phase 2",description:"DFMEA"},{id:"apqp-3",title:"Phase 3",description:"PFMEA"},{id:"apqp-4",title:"Phase 4",description:""},{id:"apqp-5",title:"Phase 5",description:""}]},"process-change":{goal:"ISO/IATF 16949",tasks:[{id:"change-1",title:"",description:""},{id:"change-2",title:"",description:""},{id:"change-3",title:"",description:""},{id:"change-4",title:"",description:""}]},"new-product-eval":{goal:"",tasks:[{id:"eval-1",title:"",description:""},{id:"eval-2",title:"",description:""},{id:"eval-3",title:"",description:""},{id:"eval-4",title:"",description:""}]},"improvement-project":{goal:"DMAIC",tasks:[{id:"dmaic-d",title:"Define",description:""},{id:"dmaic-m",title:"Measure",description:""},{id:"dmaic-a",title:"Analyze",description:""},{id:"dmaic-i",title:"Improve",description:""},{id:"dmaic-c",title:"Control",description:""}]},"equipment-modification":{goal:"",tasks:[{id:"equip-1",title:"",description:""},{id:"equip-2",title:"",description:""},{id:"equip-3",title:"",description:""},{id:"equip-4",title:"",description:""}]}},cG=t=>{const[e,n]=H.useState([t]),[r,a]=H.useState(0),s=H.useCallback(g=>{n(v=>{const _=v.slice(0,r+1);return _.push(g),_.slice(-50)}),a(v=>Math.min(v+1,49))},[r]),l=H.useCallback(()=>r>0?(a(g=>g-1),e[r-1]):null,[r,e]),c=H.useCallback(()=>r<e.length-1?(a(g=>g+1),e[r+1]):null,[r,e]),d=r>0,f=r<e.length-1;return{addToHistory:s,undo:l,redo:c,canUndo:d,canRedo:f}},uG=()=>{const[t,e]=H.useState(null),[n,r]=H.useState(!0),[a,s]=H.useState(!1),[l,c]=H.useState(null),[d,f]=H.useState([]),[g,v]=H.useState(!1),[_,T]=H.useState(!1),[E,S]=H.useState(ma.INPUT_FORM),[C,k]=H.useState(""),[A,b]=H.useState(""),[D,B]=H.useState([]),[G,F]=H.useState(null),[W,U]=H.useState(null),[ae,z]=H.useState(null),[ee,Ee]=H.useState(!1),[Ae,we]=H.useState(null),[ie,de]=H.useState(""),[re,J]=H.useState(!1),{addToHistory:M,undo:Q,redo:I,canUndo:X,canRedo:K}=cG({tasks:D,projectGoal:C,targetDate:A}),P=450,te=350;H.useEffect(()=>{if((async()=>{if(!rt){e(null),r(!1);return}const{data:{session:Ve}}=await rt.auth.getSession();e((Ve==null?void 0:Ve.user)??null),r(!1)})(),!rt)return;const{data:{subscription:Ge}}=rt.auth.onAuthStateChange((Ve,ze)=>{e((ze==null?void 0:ze.user)??null),Ve==="SIGNED_OUT"&&(c(null),f([]),B([]),k(""),b(""),S(ma.INPUT_FORM))});return()=>Ge.unsubscribe()},[]),H.useEffect(()=>{const Ne=sessionStorage.getItem("gemini_api_key");Ne&&(de(Ne),J(!0),Jh(Ne))},[]),H.useEffect(()=>l!=null&&l.id?Vn.subscribeToProjectChanges(l.id,Ge=>{if(Ge.eventType==="UPDATE"){const Ve=Ge.new;B(Ve.tasks_data||[]),k(Ve.goal),b(Ve.target_date),U(Ve.gantt_data)}},()=>{me()}):void 0,[l==null?void 0:l.id]);const me=H.useCallback(async()=>{if(l!=null&&l.id)try{const Ne=await Vn.getProjectWithMembers(l.id);f(Ne.members||[])}catch(Ne){console.error("Failed to load project members:",Ne)}},[l==null?void 0:l.id]);H.useEffect(()=>{me()},[me]);const ve=H.useCallback((Ne="item")=>`${Ne}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),ye=H.useCallback(Ne=>{B(Ge=>{const Ve=typeof Ne=="function"?Ne(Ge):Ne;return M({tasks:Ve,projectGoal:C,targetDate:A}),Ve})},[M,C,A]),_e=H.useCallback(Ne=>{de(Ne),J(!0),sessionStorage.setItem("gemini_api_key",Ne),Jh(Ne),we(null)},[]),$e=H.useCallback(()=>{de(""),J(!1),sessionStorage.removeItem("gemini_api_key"),Jh("")},[]),Z=H.useCallback(()=>{s(!1)},[]),ct=H.useCallback(async()=>{await rt.auth.signOut()},[]),qe=H.useCallback(async(Ne,Ge)=>{if(!re){we("API");return}Ee(!0),we(null);try{const ze=(await cL(Ne,Ge)).map((nt,dr)=>({...nt,position:{x:50+dr%3*P,y:50+Math.floor(dr/3)*te}}));k(Ne),b(Ge),ye(ze),S(ma.PROJECT_FLOW),M({tasks:ze,projectGoal:Ne,targetDate:Ge})}catch(Ve){we(Ve instanceof Error?Ve.message:"")}finally{Ee(!1)}},[re,ye,M,P,te]),dt=H.useCallback((Ne,Ge,Ve)=>{const nt=lG[Ne].tasks.map((dr,sa)=>({...dr,position:{x:50+sa%3*P,y:50+Math.floor(sa/3)*te}}));k(Ge),b(Ve),ye(nt),S(ma.PROJECT_FLOW),M({tasks:nt,projectGoal:Ge,targetDate:Ve})},[ye,M,P,te]),tt=H.useCallback(Ne=>{F(Ne)},[]),Me=H.useCallback(async(Ne,Ge)=>{const Ve=D.map(ze=>ze.id===Ne?{...ze,extendedDetails:Ge}:ze);if(ye(Ve),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await Vn.updateProject(l.id,{tasks:Ve})}catch(ze){console.error("Failed to auto-save project:",ze),console.warn("")}},[D,ye,l]),Ft=H.useCallback(async(Ne,Ge)=>{const Ve=D.map(ze=>ze.id===Ne?{...ze,position:Ge}:ze);if(ye(Ve),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await Vn.updateProject(l.id,{tasks:Ve})}catch(ze){console.error("Failed to auto-save project:",ze)}},[D,ye,l]),pn=H.useCallback(async(Ne,Ge)=>{const Ve=D.map(ze=>ze.id===Ne?{...ze,status:Ge}:ze);if(ye(Ve),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await Vn.updateProject(l.id,{tasks:Ve})}catch(ze){console.error("Failed to auto-save project:",ze)}},[D,ye,l]),sn=H.useCallback(async(Ne,Ge)=>{const Ve=D.map(ze=>ze.id===Ne?{...ze,nextTaskIds:Ge}:ze);if(ye(Ve),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await Vn.updateProject(l.id,{tasks:Ve})}catch(ze){console.error("Failed to auto-save project:",ze)}},[D,ye,l]),en=H.useCallback(()=>{c(null),f([]),B([]),k(""),b(""),U(null),z(null),S(ma.INPUT_FORM)},[]),rr=H.useCallback(()=>{const Ge=JSON.stringify({projectGoal:C,targetDate:A,tasks:D,ganttData:W},null,2),Ve=new Blob([Ge],{type:"application/json"}),ze=URL.createObjectURL(Ve),nt=document.createElement("a");nt.href=ze,nt.download=`project-${Date.now()}.json`,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(ze)},[C,A,D,W]),Pn=H.useCallback(Ne=>{const Ge=new FileReader;Ge.onload=Ve=>{var ze;try{const nt=JSON.parse((ze=Ve.target)==null?void 0:ze.result);nt.projectGoal&&nt.targetDate&&Array.isArray(nt.tasks)?(k(nt.projectGoal),b(nt.targetDate),ye(nt.tasks),U(nt.ganttData||null),S(ma.PROJECT_FLOW),M({tasks:nt.tasks,projectGoal:nt.projectGoal,targetDate:nt.targetDate})):we("")}catch{we("")}},Ge.readAsText(Ne)},[ye,M]),Jt=H.useCallback(()=>{const Ne={id:ve("task"),title:"",description:"",position:{x:50+D.length%3*P,y:50+Math.floor(D.length/3)*te}};ye([...D,Ne])},[D,ve,ye,P,te]),Jn=H.useCallback(Ne=>{if(confirm("")){const Ge=D.filter(Ve=>Ve.id!==Ne);ye(Ge)}},[D,ye]),gn=H.useCallback(Ne=>{const Ge=new FileReader;Ge.onload=Ve=>{var ze;try{const nt=JSON.parse((ze=Ve.target)==null?void 0:ze.result);if(nt.task&&nt.task.id&&nt.task.title){const dr={...nt.task,id:ve("imported_task"),position:{x:50+D.length%3*P,y:50+Math.floor(D.length/3)*te}};ye([...D,dr])}else we("")}catch{we("")}},Ge.readAsText(Ne)},[D,ve,ye,P,te]),qt=H.useCallback(()=>{const Ne=D.map((Ge,Ve)=>({...Ge,position:{x:50+Ve%3*P,y:50+Math.floor(Ve/3)*te}}));ye(Ne)},[D,ye,P,te]),At=H.useCallback(()=>{const Ne=Q();Ne&&(B(Ne.tasks),k(Ne.projectGoal),b(Ne.targetDate))},[Q]),Nt=H.useCallback(()=>{const Ne=I();Ne&&(B(Ne.tasks),k(Ne.projectGoal),b(Ne.targetDate))},[I]),Qe=H.useCallback(Ne=>{z(Ne)},[]),wt=H.useCallback(async Ne=>{v(!0);try{const Ge=await Vn.getProjectWithMembers(Ne.id);c(Ne),f(Ge.members||[]),k(Ne.goal),b(Ne.targetDate),B(Ne.tasks),U(Ne.ganttData||null),S(ma.PROJECT_FLOW),T(!1)}catch(Ge){we(Ge instanceof Error?Ge.message:"")}finally{v(!1)}},[]),tn=H.useCallback(async()=>{if(!t)throw new Error("");if(l!=null&&l.id){const Ne=await Vn.updateProject(l.id,{goal:C,targetDate:A,tasks:D,ganttData:W,expectedVersion:l.version});c(Ne)}else throw new Error("ProjectFlowDisplay")},[t,l,C,A,D,W]);return n?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700",children:x.jsx(_n,{size:"lg",text:"..."})}):t?re?g?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-100",children:x.jsx(_n,{size:"lg",text:"..."})}):x.jsxs(x.Fragment,{children:[E===ma.INPUT_FORM&&x.jsx(PL,{onSubmit:qe,isLoading:ee,onImportProject:Pn,onLoadTemplate:dt,initialGoal:C,initialDate:A,onOpenProjectList:()=>T(!0),onLogout:ct,user:t}),E===ma.PROJECT_FLOW&&x.jsx(qP,{tasks:D,projectGoal:C,targetDate:A,onSelectTask:tt,onUpdateTaskExtendedDetails:Me,onUpdateTaskPosition:Ft,onUpdateTaskStatus:pn,onStartNewProject:en,onExportProject:rr,onAddTask:Jt,onRemoveTask:Jn,onImportSingleTask:gn,onAutoLayout:qt,onUndo:At,canUndo:X,onRedo:Nt,canRedo:K,generateUniqueId:ve,onUpdateTaskConnections:sn,ganttData:W,setGanttData:U,onCustomReportGenerated:Qe,onClearApiKey:$e,onOpenProjectList:()=>T(!0),onLogout:ct,currentProjectId:(l==null?void 0:l.id)||null,onSaveProject:tn,projectMembers:d,userRole:(l==null?void 0:l.userRole)||"viewer",onMembersUpdate:me}),G&&x.jsx(aG,{task:G,onClose:()=>F(null),onUpdateTask:Me,generateUniqueId:ve,projectGoal:C,targetDate:A,canEdit:!l||l.userRole==="owner"||l.userRole==="editor"}),_&&x.jsx(oG,{isOpen:_,onClose:()=>T(!1),onSelectProject:wt,onCreateNew:en}),Ae&&x.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[x.jsx(Fs,{message:Ae}),x.jsx("button",{onClick:()=>we(null),className:"mt-2 text-sm text-blue-600 hover:underline",children:""})]})]}):x.jsx(sG,{onSetApiKey:_e,error:Ae,isLoading:ee}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-4",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>s(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:" / "})]})}),x.jsx(CS,{isOpen:a,onClose:()=>s(!1),onSuccess:Z})]})},fG=()=>{var _;const{token:t}=_A(),e=yT(),[n,r]=H.useState(null),[a,s]=H.useState(!1),[l,c]=H.useState(null),[d,f]=H.useState(!1);H.useEffect(()=>{rt.auth.getSession().then(({data:{session:E}})=>{r((E==null?void 0:E.user)??null),E!=null&&E.user&&t&&g()});const{data:{subscription:T}}=rt.auth.onAuthStateChange((E,S)=>{r((S==null?void 0:S.user)??null),S!=null&&S.user&&t&&!l&&g()});return()=>T.unsubscribe()},[t]);const g=async()=>{if(!t){c({success:!1,error:""});return}s(!0);try{const T=await Vn.joinProjectByInvitation(t);c(T),T.success&&T.project&&setTimeout(()=>{e("/")},3e3)}catch(T){c({success:!1,error:T instanceof Error?T.message:""})}finally{s(!1)}},v=()=>{f(!1)};return t?n?a?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(_n,{size:"lg"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mt-4 mb-2",children:"..."}),x.jsx("p",{className:"text-slate-600",children:""})]})}):l?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:l.success?x.jsxs(x.Fragment,{children:[x.jsx(Ed,{className:"w-16 h-16 mx-auto text-green-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsxs("p",{className:"text-slate-600 mb-2",children:["",(_=l.project)==null?void 0:_.title,""]}),x.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"3..."}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700",children:""})]}):x.jsxs(x.Fragment,{children:[x.jsx(gs,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:l.error}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:""})]})})}):null:x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(Oi,{className:"w-16 h-16 mx-auto text-blue-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>f(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:" / "})]})}),x.jsx(CS,{isOpen:d,onClose:()=>f(!1),onSuccess:v})]}):x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(gs,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:""})]})})},bS=document.getElementById("root");if(!bS)throw new Error("Could not find root element to mount to");const dG=$b.createRoot(bS);dG.render(x.jsx(ys.StrictMode,{children:x.jsx(ik,{children:x.jsxs(LA,{children:[x.jsx(cm,{path:"/",element:x.jsx(uG,{})}),x.jsx(cm,{path:"/invite/:token",element:x.jsx(fG,{})})]})})}));
